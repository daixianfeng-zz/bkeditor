/*! Bkeditor - v0.9.0 - 2013-07-30
* https://github.com/daixianfeng/bkeditor
* Copyright (c) 2013 daixianfeng;*/
(function(e){function t(t){var r=this;this.state="init",t.id=t.id?t.id:"bkeditor_"+(new Date).getTime(),this.Eid=t.id,n.editorList[this.Eid]=this,this.config=e.extend(!0,{},n.config,t),n.curEditor=this,n.curId=this.Eid,this.pasteToText=!1,this.pasteToWord=!1,this.revertList=[],this.redoList=[],this.cursorElements={},n.create(this,function(){var i=r.config;r.baseEvent=new n.EditorEvent(r),r.baseHistory=new n.EditorHistory(r),r.baseFilter=new n.EditorFilter(r),r.pluginEnable=n.configPlugin(i),r.toolbar=new n.Toolbar(r),r.fillPanel();var a=i.oriHtml,o=n.utils.filterInner(r,a);r.dom.body.innerHTML=o,e(r.dom.body).css(i.bodyStyle),r.baseFilter.excute("dom"),r.baseHistory.setFirstHistory(r.dom.body.innerHTML),r.state="ready",n.trigger("complete",{Eid:t.id}),e(i.textarea).closest("form").submit(function(){e(i.textarea).val(r.getContent())})})}var n={IE:window.VBArray?!0:!1,IE6:window.VBArray&&!window.XMLHttpRequest?!0:!1,state:"loading",editorList:{},curId:"",curEditor:{},curToolbar:jQuery(),log:{},error:{},pluginList:{},uiList:{},lang:{},listenEditarea:{},listenEditareaExt:{},addFilter:function(){},coreCommand:{},command:function(){},histroy:{},utils:{},load:{},toolbar:{},toolbarPanel:{},dialogHtml:{},dialog:{},themeList:{toolbar:{},editArea:{}},init:function(){},create:function(t,n){var r=this,i=t.config,a=null,o=+new Date,s='<div id="'+i.id+'" ref="editor" style="width:'+i.editWidth+';">';if(s+='<div class="bke-toolbarbox" ref="'+i.id+'"></div>',s+='<div class="bke-contentarea">',s+='<div class="bke-iframeholder" style="height:'+i.editHeight+';"></div>',s+='<div class="bke-bottombar">',s+='<span class="bke-elementpath">元素路径：<a>body</a></span>',s+='<span class="bke-wordcount">字数统计</span>',s+="</div>",s+="</div>",s+="</div>",i.position instanceof jQuery)i.position.before(s),i.position.hide(),a=i.position;else{i.position.content.before(s);var l=i.position.content.prev().find(".bke-toolbarbox");i.position.toolbar.append(l),i.position.content.hide(),a=i.position.content}i.textarea=a,0===e(document.body).find("#ui-dialog").length&&e(document.body).append('<div id="ui-dialog" style="display:none;"></div>');var d=document.createElement("iframe");e(d).height(i.editHeight).attr({frameBorder:0,tabIndex:"0",width:"100%",scrolling:i.editScroll}).addClass("show-content"),e("#"+i.id).find(".bke-iframeholder").append(d).append(a).append('<div class="bke-shortcutmenu"></div>').append('<a class="bke-selecttablebar"></a>');var c=d.contentWindow,u=c.document;u.open();var f='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" ';f+='"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">',f+="<html><head>",f+='<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />',f+='<link rel="stylesheet" type="text/css" href="'+i.cBase.skinDir+'skin-inner.css">',f+="<!--[if IE]>",f+='<script type="text/javascript" src="'+i.cBase.ieDir+"DOMRange.js?"+o+'"></script>',f+="<![endif]-->",f+='</head><body contentEditable="true" style="height:98%"></body></html>',u.write(f),u.close(),r.editWin=c,r.editDom=u,t.win=c,t.dom=u,r.themeList.toolbar[i.skin]||(r.loadCss(i.cBase.skinDir+i.skin+"/skin.css"),r.themeList.toolbar[i.skin]=!0);var m=setInterval(function(){if(r.editWin.getSelection!==void 0){var t="toolbar";i.toolbar&&"default"!==i.toolbar&&(t+="_"+i.toolbar);var a=i.cBase.skinDir+i.skin+"/"+t+".json";r[a]?(e('[ref="'+i.id+'"].bke-toolbarbox').html(r[a]),n&&n()):e.get(a,function(t){e('[ref="'+i.id+'"].bke-toolbarbox').html(t),n&&n(),r[a]=t}),clearInterval(m)}},50)},trigger:function(){},fillPanel:function(e,t){this.toolbar.fillPanel?this.toolbar.fillPanel(e,t):this.toolbarPanel[e]=t},getAttr:function(){},focus:function(){var e=this.curId;this.editorList[e]&&this.editorList[e].focus()},lock:function(){},unlock:function(){},destroy:function(e){this.editorList[e]&&this.editorList[deId].destroy()},ready:function(t){var n=this,r="",i="";"ready"!==n.state?(r=setInterval(function(){var t=n.error.ready&&n.log.ready&&n.load.ready&&n.utils.ready&&n.command.ready&&n.EditorEvent.ready&&n.EditorFilter.ready&&n.EditorHistory.ready&&n.addPlugin.ready&&n.addUi.ready&&n.dialog.ready;if(t===!0){n.state="ready";var i="";i+="<!--[if IE]>",i+='<script type="text/javascript" src="'+n.config.cBase.ieDir+'DOMRange.js?"></script>',i+="<![endif]-->",e("head").append(i),clearInterval(r)}},50),i=setInterval(function(){"ready"===n.state&&(t&&t(),clearInterval(i))},50)):t&&t()},getLang:function(t){var n=this.lang;t=(t||"").split(".");for(var r,i=0;(r=t[i++])&&(n=n[r],n););return void 0===n&&e.browser.mozilla&&console.log(t[t.length-1]),void 0===n?t[t.length-1]:n},errorMessage:function(e){this.curEditor.error(e)},message:function(e,t){this.curEditor.error(e,"green",t)},get:function(e){switch(e){case"editor":return n.curEditor;case"list":return n.editorList;case"window":return n.curEditor.win;case"document":return n.curEditor.dom;case"body":return n.curEditor.dom.body}},$:function(t){return e(t,this.curEditor.dom)},loadCss:function(t){var n=document.createElement("link");n.setAttribute("type","text/css"),n.setAttribute("rel","stylesheet"),n.setAttribute("href",t),e("head")[0].appendChild(n)}};n.init(),e.jQEditor=n;var r=function(e){return n.trigger("create",{Eid:e.id}),new t(e)};t.prototype={pluginEnable:{},ready:function(e){var t=this,n="";"ready"!==t.state?n=setInterval(function(){"ready"===t.state&&(e(),clearInterval(n))},50):e()},fillPanel:function(){try{for(var e in n.pluginList)n.pluginList[e].fill()}catch(t){n.error.writeError("fill panel error: "+t.message+(t.stack?t.stack:""),3,"plugin")}},changeTheme:function(e,t){"editArea"!==t&&typeof n.themeList.toolbar[e]===!1,"toolbar"!==t&&typeof n.themeList.editArea[e]===!1},getContent:function(){var e=this.dom.body.innerHTML;return n.utils.filterInner(this,e)},setContent:function(e){this.dom.body.innerHTML=e,this.baseFilter.excute("dom")},enable:function(){},disable:function(){},execCommand:function(){},queryCommandState:function(){},queryCommandValue:function(){},insert:function(e){n.command("insert",e)},error:function(t,n,r){n=n||"red","number"==typeof n&&(r=n,n="red"),r=r||3e3;var i=e("#"+this.Eid).find(".bke-message");i.stop().text(t).css({color:n}).fadeIn(200),clearTimeout(this.timer),this.timer=setTimeout(function(){i.fadeOut(100)},r)},selectAll:function(){return this.dom.execCommand("selectAll"),this.win.focus(),this},focus:function(){return this.win.focus(),this},getCursorElement:function(){var e=n.utils.getCurElement();return e.pop()},getRange:function(){return n.utils.getSelectionRange(this.win)},getSelectionText:function(){var e=n.utils.getSelectionRange(this.win);return""+e},insertNode:function(e){var t=n.utils.getSelectionRange(this.win);t.insertNode(e)},setCursor:function(e){n.utils.setCursor(this.win,e,!0)},selectNode:function(e){n.utils.selectNode(this.win,e)}},e.editor=r,n.ready(function(){e("textarea.bkeditor").each(function(t,n){var i=e(n),a=(new Date).getTime(),o=i.attr("id")?i.attr("id")+"_":"bkeditor_",s=r({id:o+a,toolbar:i.data("toolbar"),position:i,editWidth:i.css("width"),editHeight:i.css("height"),oriHtml:i.val()});i.data("editor",s)})})})(window.jQuery),function(e,t){var n="http://localhost/bkeditor/",r=!1,i=!1,a=!0,o={all:["codemirror","bold","italic","superscript","subscript","baikelink","strikethrough","underline","removeformat","formatmatch","tolowercase","touppercase","undo","redo","h2","h3","blockquote","fontsizemenu","fontfamilymenu","justifyleft","justifycenter","justifyright","pastetotext","pasteword","image","map","preview","cleardoc","reference","inserttime","insertdate","highlightcode","insertvideo","inserttablemenu","tableprops","combinecells","combinecolafter","combinerowafter","splittocols","splittorows","splittocells","insertcolbefore","insertcolafter","insertrowbefore","insertrowafter","deleterow","deletecol","deletetable","specharsmenu","link","anchor","backcolor","forecolor","linespacemenu","spacebottommenu","spacetopmenu","outdent","indent","insertunorderedlist","insertorderedlist","source","autoformat","search","about"],base:["bold","italic","underline","strikethrough","superscript","subscript","lowercase","uppercase","redo","undo","pastetotext","pasteword","specharsmenu","link","backcolor","forecolor","fontsizemenu","fontfamilymenu","insertunorderedlist","insertorderedlist","source","search"]},s=["bold","italic","superscript","subscript","baikelink","strikethrough","underline","formatmatch","h2","h3","blockquote","fontsizemenu","fontfamilymenu","pasteword","image","map","reference","highlightcode","insertvideo","inserttablemenu","specharsmenu","link","anchor","backcolor","forecolor","linespacemenu","spacebottommenu","spacetopmenu","outdent","indent","insertunorderedlist","insertorderedlist","forecolormenu"],l={a:s,table:["h2","h3"],hn:s,sub:s,sup:s,pre:s,img:s,selectedTable:[]},d={version:"0.9.0",rootDir:n,cBase:{libDir:n+"libs/",ieDir:n+"src/core/base/ie/",pluginDir:n+"src/core/plugin/",uiDir:n+"src/core/ui/",skinDir:n+"src/skin/",isLog:r,isError:i,lang:"zh-cn",plupload:{max_file_size:"10mb",url:"/plupload.php",pluploadswf:n+"libs/plupload/plupload.swf"},ajaxupload:{uploadUrl:"../upload.php?action=saveFromDrag"}},cEvent:{whiteList:[],blackList:[]},cPlugin:{whiteList:[],blackList:[]},cUi:{},cFilter:{whiteList:["block","combine","replace","space"],blackList:[]},cHistory:{onHistory:a,length:100},cError:{onError:i,errorSendAddr:"",length:1},cLog:{onLog:r,logSendAddr:"",length:10},cTools:o,cTagDisable:l,toolbar:"",skin:"default",cSkin:{},editWidth:"auto",editHeight:"auto",editScroll:"no",position:"",oriHtml:"<p><br /></p>",selectTableClass:"bke-table-selected",selectCellClass:"bke-cell-selected",selectImgClass:"bke-img-selected",autoHeight:1,height:200,fixedClassName:"bke-toolbar-fixed",bodyStyle:{"font-size":"14px","font-family":"SimSun"}};e.config=t.extend(!0,{},e.config,d)}(jQuery.jQEditor,jQuery),function(e,t){var n="./code/bke/0.9.0/",r=window.location.search;-1===r.search("debug=true")&&(n="./code/dist/0.9.0/");var i={rootDir:n,cBase:{libDir:n+"libs/",ieDir:n+"ie/",pluginDir:n+"plugin/",uiDir:n+"ui/",skinDir:n+"skin/"}};e.config=t.extend(!0,{},e.config,i)}(jQuery.jQEditor,jQuery),function(e,t){var n={cCommand:{textCommand:{bold:{cmd:"strong",param:"",icon:"browserChecked"},italic:{cmd:"em",param:"",icon:"browserChecked"},underline:{cmd:"text-decoration",param:"underline",icon:"browserChecked"},strikethrough:{cmd:"text-decoration",param:"line-through",icon:"browserChecked"},superscript:{cmd:"sup",param:"",icon:"customChecked"},subscript:{cmd:"sub",param:"",icon:"customChecked"},fontsize:{cmd:"font-size",param:"",icon:"customValue"},fontfamily:{cmd:"font-family",param:"",icon:"customValue"},forecolor:{cmd:"color",param:"",icon:"customValue"},backcolor:{cmd:"background-color",param:"",icon:"customValue"},tolowercase:{cmd:"wordcase",param:"lower",icon:""},touppercase:{cmd:"wordcase",param:"upper",icon:""}},paragraphCommand:{justifyleft:{cmd:"text-align",param:"left",icon:"customChecked"},justifycenter:{cmd:"text-align",param:"center",icon:"customChecked"},justifyright:{cmd:"text-align",param:"right",icon:"customChecked"},justifyfull:{cmd:"text-align",param:"justify",icon:"customChecked"},insertorderedlist:{cmd:"ol",param:"",icon:"customValue"},insertunorderedlist:{cmd:"ul",param:"",icon:"customValue"},spacetop:{cmd:"margin-top",param:"",icon:""},spacebottom:{cmd:"margin-bottom",param:"",icon:""},linespace:{cmd:"line-height",param:"",icon:""},outdent:{cmd:"padding-left",param:"-14px",icon:""},indent:{cmd:"padding-left",param:"14px",icon:""}},pluginCommand:{icon:{cmd:"icon",param:"",icon:""},element:{cmd:"element",param:"",icon:""},redo:{cmd:"redo",param:"",icon:""},undo:{cmd:"revert",param:"",icon:""},cut:{cmd:"paste",param:"cut",icon:""},copy:{cmd:"paste",param:"copy",icon:""},paste:{cmd:"paste",param:"",icon:""},pastetotext:{cmd:"paste",param:"toggleTextpaste",icon:""},removeformat:{cmd:"font",param:"clear",icon:""},formatmatch:{cmd:"font",param:"toggleBrush",icon:""},brush:{cmd:"font",param:"brush",icon:""},boldmenu:{cmd:"boldmenu",param:"",icon:""},forecolormenu:{cmd:"colormenu",param:"forecolor",icon:""},backcolormenu:{cmd:"colormenu",param:"backcolor",icon:""},fontsizemenu:{cmd:"fontsizemenu",param:"",icon:""},fontfamilymenu:{cmd:"fontfamilymenu",param:"",icon:""},spacebottommenu:{cmd:"spacemenu",param:"bottom",icon:""},spacetopmenu:{cmd:"spacemenu",param:"top",icon:""},linespacemenu:{cmd:"spacemenu",param:"line",icon:""},h2:{cmd:"hn",param:"h2",icon:"customChecked"},h3:{cmd:"hn",param:"h3",icon:"customChecked"},blockquote:{cmd:"blockquote",param:"h3",icon:"customChecked"},image:{cmd:"image",param:"",icon:""},imageFloat:{cmd:"image",param:"imgFloat",icon:""},link:{cmd:"link",param:"",icon:""},map:{cmd:"map",param:"",icon:""},insertvideo:{cmd:"video",param:"",icon:""},pasteword:{cmd:"pasteword",param:"",icon:""},specharsmenu:{cmd:"specharsmenu",param:"",icon:""},baikelink:{cmd:"baikelink",param:"",icon:""},inserttable:{cmd:"table",param:"",icon:"tableChecked"},inserttablemenu:{cmd:"tablemenu",param:"",icon:"tableChecked"},inserttime:{cmd:"inserttime",param:"",icon:""},datemenu:{cmd:"datemenu",param:"",icon:""},insertdate:{cmd:"datemenu",param:"",icon:""},multiimage:{cmd:"",param:"",icon:""},insertunorderedlistmenu:{cmd:"ulmenu",param:"",icon:""},insertorderedlistmenu:{cmd:"olmenu",param:"",icon:""},combinecells:{cmd:"table",param:"combineCell",icon:"tableChecked"},combinecolafter:{cmd:"table",param:"combineColAfter",icon:"tableChecked"},combinerowafter:{cmd:"table",param:"combineRowAfter",icon:"tableChecked"},splittocols:{cmd:"table",param:"splitToCols",icon:"tableChecked"},splittorows:{cmd:"table",param:"splitToRows",icon:"tableChecked"},splittocells:{cmd:"table",param:"splitCellWhole",icon:"tableChecked"},insertcolbefore:{cmd:"table",param:"insertCol",args:"forward",icon:"tableChecked"},insertcolafter:{cmd:"table",param:"insertCol",args:"backward",icon:"tableChecked"},insertrowbefore:{cmd:"table",param:"insertRow",args:"forward",icon:"tableChecked"},insertrowafter:{cmd:"table",param:"insertRow",args:"backward",icon:"tableChecked"},deleterow:{cmd:"table",param:"deleteCol",icon:"tableChecked"},deletecol:{cmd:"table",param:"deleteRow",icon:"tableChecked"},deletetable:{cmd:"table",param:"deleteTable",icon:"tableChecked"},tableprops:{cmd:"table",param:"tableAttrDialog",icon:"tableChecked"},cellcolor:{cmd:"table",param:"cellColor",icon:""},celljustify:{cmd:"table",param:"cellJustify",icon:""},tablefloat:{cmd:"table",param:"tableFloat",icon:""},tablehead:{cmd:"table",param:"toggleHead",icon:""},tabletitle:{cmd:"table",param:"toggleTitle",icon:""},reference:{cmd:"",param:"",icon:""},highlightcode:{cmd:"highlightcode",param:"",icon:""},cleardoc:{cmd:"cleardoc",param:"",icon:""},preview:{cmd:"",param:"",icon:""},source:{cmd:"source",param:"",icon:""},anchor:{cmd:"anchor",param:"",icon:""},autoformat:{cmd:"autoformat",param:"",icon:""},selectall:{cmd:"selectall",param:"",icon:""},insertparagraphbefore:{cmd:"insertparagraph",param:"before",icon:""},insertparagraphafter:{cmd:"insertparagraph",param:"after",icon:""},codemirror:{cmd:"codemirror",param:"",icon:""},about:{cmd:"about",param:"",icon:""},search:{cmd:"search",param:"",icon:""},shortcutmenu:{cmd:"shortcutmenu",param:"",icon:""},dragimage:{cmd:"dragimage",param:"",icon:""},ajaxupload:{cmd:"ajaxupload",param:"",icon:""},replace:{cmd:"search",param:"",icon:""},uploadremoteimage:{cmd:"uploadremoteimage",param:"",icon:""},insertcode:{cmd:"insertcode",param:"",icon:""},insertcodemenu:{cmd:"insertcodemenu",param:"",icon:""}},insertCommand:{insert:{cmd:"insert",param:"",icon:""},spechars:{cmd:"insert",param:"",icon:""}},uiCommand:{codedialog:{cmd:"codedialog",param:"",icon:""},imagedialog:{cmd:"imagedialog",param:"",icon:""},tabledialog:{cmd:"tabledialog",param:"",icon:""},videodialog:{cmd:"videodialog",param:"",icon:""},linkdialog:{cmd:"linkdialog",param:"",icon:""},mapdialog:{cmd:"mapdialog",param:"",icon:""},pasteworddialog:{cmd:"pasteworddialog",param:"",icon:""},sourcedialog:{cmd:"sourcedialog",param:"",icon:""},searchdialog:{cmd:"searchdialog",param:"",icon:""},aboutdialog:{cmd:"aboutdialog",param:"",icon:""},anchordialog:{cmd:"anchordialog",param:"",icon:""}}}};e.config=t.extend({},e.config,n)}(window.jQuery.jQEditor,window.jQuery);var DTD=function(){function e(e){for(var t in e)e[t.toUpperCase()]=e[t];return e}function t(e){for(var t=arguments,n=1;t.length>n;n++){var r=t[n];for(var i in r)e.hasOwnProperty(i)||(e[i]=r[i])}return e}var n=e({address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1,li:1,noscript:1}),r=e({area:1,base:1,br:1,col:1,hr:1,img:1,input:1,link:1,meta:1,param:1,embed:1}),i=e({iframe:1,sub:1,img:1,embed:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1,b:1,acronym:1,bdo:1,"var":1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1,ins:1,del:1,script:1,style:1,input:1,button:1,select:1,textarea:1,label:1,a:1}),a=e({strong:1,em:1,sub:1,sup:1,span:1,b:1,i:1,u:1,font:1,tt:1,big:1,small:1,q:1,code:1,cite:1,dfn:1,samp:1,kbd:1,abbr:1,acronym:1,bdo:1});return e({$block:t({},n),$inline:t(e({a:0}),i),$font:a,$body:t(e({script:1,style:1}),n),$cdata:e({script:1,style:1}),$empty:r,$nonChild:e({iframe:1,textarea:1}),$listItem:e({dd:1,dt:1,li:1}),$list:e({ul:1,ol:1,dl:1}),$isNotEmpty:e({table:1,ul:1,ol:1,dl:1,iframe:1,area:1,base:1,col:1,hr:1,img:1,embed:1,input:1,link:1,meta:1,param:1}),$emptyInline:e({hr:1,br:1,img:1,embed:1}),$removeEmpty:e({a:1,abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1}),$removeEmptyBlock:e({p:1,div:1,ol:1,ul:1,dl:1}),$tableContent:e({caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1,table:1}),$notTransContent:e({pre:1,script:1,style:1,textarea:1}),$paragraph:t(e({body:0,legend:1,caption:1,dl:0,ul:0,ol:0,dir:0,div:0,table:0}),n),html:e({body:1,script:1}),body:t(e({child:"p"}),n,i),ul:t(e({li:1,ol:2,dir:2,child:"li"}),n),ol:t(e({li:1,ul:2,dir:2,child:"li"}),n),li:t(e({li:0,parent:"ul"}),n,i),dir:e({li:1,ul:2,ol:2,child:"dd"}),dl:e({dt:1,dd:1,child:"dd"}),dt:t(e({dd:2,parent:"dl"}),i),dd:t(e({dt:2,parent:"dl"}),i,n),table:e({thead:1,tbody:1,tfoot:1,tr:1,colgroup:1,caption:1,col:1,child:"tbody"}),tbody:e({thead:2,tfoot:2,tr:1,parent:"table",child:"tr"}),tfoot:e({thead:2,tbody:2,tr:1,parent:"table",child:"tr"}),thead:e({tbody:2,tfoot:2,tr:1,parent:"table",child:"tr"}),caption:t(e({parent:"table"}),i),colgroup:e({col:1,parent:"table"}),col:{},tr:e({td:1,th:1,parent:"tbody",child:"td"}),td:t(e({th:2,parent:"tr"}),n,i),th:t(e({td:2,parent:"tr"}),n,i),center:t(n,i),p:i,h1:i,h2:i,h3:i,h4:i,h5:i,h6:i,div:t(e({child:"p"}),n,i),pre:t(e({img:0,object:0,big:0,small:0,sub:0,sup:0}),i),blockquote:n,noscript:t(n,i),address:i,fieldset:t(e({legend:1}),n,i),legend:i,form:t(e({form:0}),n,i),img:{},span:e({br:1}),i:e({span:1,em:3,cite:2}),cite:e({span:1,em:3,i:3}),b:e({span:1,em:1,strong:3}),em:e({span:1,i:2,cite:2}),u:e({span:1,i:1,cite:1}),strong:e({span:1,em:1,cite:1,i:1,b:2}),sub:e({span:1,em:1,cite:1,i:1,sup:2,strong:1}),sup:e({span:1,em:1,cite:1,i:1,sub:2,strong:1}),big:e({span:1,em:1,cite:1,i:1,sub:1,sup:1,strong:1,small:2}),small:e({span:1,em:1,cite:1,i:1,sub:1,sup:1,strong:1,big:2}),font:e({span:1,em:1,cite:1,i:1,sub:1,sup:1,strong:1,small:1,big:1}),code:e({span:1,em:1,cite:1,i:1,sub:1,sup:1,strong:1,small:1,big:1,font:1,samp:2}),samp:e({span:1,em:1,cite:1,i:1,sub:1,sup:1,strong:1,small:1,big:1,font:1,code:2}),tt:t(e({tt:0,kbd:2}),i),kbd:t(e({kbd:0,tt:2}),i),dfn:t(e({dfn:0}),i),abbr:t(e({abbr:0}),i),acronym:t(e({acronym:0}),i),q:t(e({q:0}),i),bdo:t(e({bdo:0}),i),label:t(e({label:0}),i),br:{},hr:{},input:{},textarea:{},iframe:{},a:t(e({a:0}),i),select:e({optgroup:1,option:1}),optgroup:e({option:1}),option:{},object:t(e({param:1}),n,i),param:{},map:t(e({area:1}),n),area:{},button:t(e({a:0,input:0,select:0,textarea:0,label:0,button:0,form:0,fieldset:0}),n,i)})}();(function(e,t){var n={enabled:!0,length:1,sendAddr:"",errorList:[],errorCache:{},initError:function(e){this.enabled=e.onError?!0:!1,this.sendAddr=e.sendAddr,this.length=e.length},writeError:function(t,n,r,i){var a=new Date;i=i||""+a;var o="level"+n+" error:"+r+' module "'+t+'" at '+i;this.errorList.push(o),this.enabled&&window.console&&window.console.error(o);for(var s=0;this.errorList.length>s;s++)this.errorList[s]!==o&&(this.sendError(),e.log.sendLog(),this.errorList.shift())},sendError:function(){var e=this;t.ajax({type:"POST",url:e.sendAddr,data:{errorList:e.errorList},success:function(){e.errorList=[]}})}};n.initError(e.config.cError),n.ready=!0,e.error=n})(window.jQuery.jQEditor,window.jQuery),function(e){var t=function(e){this.initHistory(e),this.redoList=[],this.revertList=[],this.lastRecordTime=+new Date};t.prototype={frameBody:{},enabled:!0,length:3,redoState:!1,revertState:!1,initHistory:function(e){this.enabled=e.config.cHistory.onHistory?!0:!1,this.length=e.config.cHistory.times,this.frameBody=e.dom.body,this.lastHistory={historyHtml:e.config.oriHtml,historySelect:""},this.win=e.win},getLastTime:function(){return this.lastRecordTime},setFirstHistory:function(e){this.redoList=[],this.revertList=[],this.lastHistory={historyHtml:e,historySelect:""}},emptyRedo:function(){this.redoList=[]},prepareHistory:function(){this.lastHistory.historySelect=e.utils.getSelectionOffset(this.win)},recordHistory:function(e){e=e?1:0;var t=this.lastHistory.historyHtml!==this.frameBody.innerHTML,n=this.lastHistory.historyHtml.length-this.frameBody.innerHTML.length;if(n>3||-3>n||t&&1===e){var r={};r.historyHtml=this.frameBody.innerHTML,this.lastHistory&&this.revertList.push(this.lastHistory),this.lastHistory=r,this.revertList.length>this.length&&this.revertList.unshift(),this.emptyRedo()}this.changeState(),this.lastRecordTime=+new Date},redo:function(){var t=this.redoList.pop();t&&(this.lastHistory&&this.revertList.push(this.lastHistory),this.lastHistory=t,this.frameBody.innerHTML=t.historyHtml,e.utils.setSelectionByOffset(this.win,t.historySelect),this.revertList.length>this.length&&this.revertList.unshift()),this.changeState()},revert:function(){var t=this.revertList.pop();t&&(this.lastHistory&&this.redoList.push(this.lastHistory),this.lastHistory=t,this.frameBody.innerHTML=t.historyHtml,e.utils.setSelectionByOffset(this.win,t.historySelect),this.redoList.length>this.length&&this.redoList.unshift()),this.changeState()},changeState:function(){this.redoState=this.redoList.length>0?!0:!1,this.revertState=this.revertList.length>0?!0:!1}},t.ready=!0,e.EditorHistory=t}(window.jQuery.jQEditor),function(e,t){var n={delayFile:[],initLoad:function(e){this.delayFile=e.delayFile},loadDelayFile:function(){setTimeout(function(){for(var n=self.delayFile.length,r=0;n>r;r++)t.getScript(e.config.cBase.pluginDir+self.delayFile[r])},100)},loadOneFile:function(n,r){t.getScript(n,function(){e.trigger("afterLoad"),r&&r()})},loadMultiFile:function(){}};n.initLoad(e.config.cBase),n.ready=!0,e.load=n}(window.jQuery.jQEditor,window.jQuery),function(e,t){var n={enabled:!0,length:1,sendAddr:"",logList:[],initLog:function(e){this.enabled=e.onLog?!0:!1,this.sendAddr=e.sendAddr,this.length=e.length},writeLog:function(e,t,n){var r=new Date;n=n||""+r;var i=t+' module "'+e+'" at '+n;this.logList.push(i),this.enabled&&window.console&&window.console.log(i),this.logList.length>this.length&&this.logList.shift()},sendLog:function(){var e=this;t.ajax({type:"POST",url:e.sendAddr,data:{logList:e.logList},success:function(){e.logList=[]}})}};n.initLog(e.config.cLog),n.ready=!0,e.log=n}(window.jQuery.jQEditor,window.jQuery),function(e,t){var n={spaceText:e.IE6?"﻿":"​",nodeIndex:function(e){for(var t=0;e=e.previousSibling;t++);return t},showTips:function(n){t("#"+e.curId+" .tips").html(n),t("#"+e.curId+" .tips").show()},getCurElement:function(){try{var t=[],n=e.curEditor.win.getSelection();if("None"===n.type){var r=e.curEditor.dom.createRange();r.selectNodeContents(e.curEditor.dom.body),r.collapse(!1),n.addRange(r)}var i=n.getRangeAt(0);if(null===i)e.log.writeLog("get no Element");else{for(var a=i.startContainer;a.nodeName&&"HTML"!==a.nodeName&&a!==e.curEditor.dom;)t.unshift(a),a=a.parentNode;var o;for(i.commonAncestorContainer,!i.collapsed&&i.startContainer===i.endContainer&&2>i.startOffset-i.endOffset&&i.startContainer.hasChildNodes()&&(o=i.startContainer.childNodes[i.startOffset]);o&&3==o.nodeType&&o.parentNode;)o=o.parentNode;o&&o!==t[t.length-1]&&t.push(o)}return t}catch(s){e.error.writeError("getElement error: "+s.message+(s.stack?s.stack:""),3,"utils")}},getSelectionOffset:function(t){try{var n={start:[],end:[]};t.focus();var r=t.getSelection();if("None"===r.type){var i=t.document.createRange();i.selectNodeContents(t.document.body),i.collapse(!1),r.addRange(i)}var a=r.getRangeAt(0),o=a.startContainer,s=a.endContainer;for(n.start.unshift(a.startOffset),n.end.unshift(a.endOffset);o.nodeName&&"BODY"!==o.nodeName&&o!==t.document;){var l=this.nodeIndex(o);n.start.unshift(l),o=o.parentNode}for(;s.nodeName&&"BODY"!==s.nodeName&&s!==t.document;){var d=this.nodeIndex(s);n.end.unshift(d),s=s.parentNode}return n}catch(c){e.error.writeError("getSelectionOffset error: "+c.message+(c.stack?c.stack:""),3,"utils")}},setSelectionByOffset:function(n,r){try{n.focus();var i=[];t.extend(!0,i,r);for(var a=n.document,o=i.start.shift(),s=i.end.shift(),l=a.body,d=a.body,c=0,u=0,f=a.body.childNodes[o],m=a.body.childNodes[s];;){if(!f){c=0;break}if(l=f,o=i.start.shift(),void 0===o)break;if(3===f.nodeType){c=f.nodeValue.length>o?o:f.nodeValue.length;break}f.childNodes.length>o?(f=f.childNodes[o],c=o):(c=f.childNodes.length,f=f.lastChild)}for(;;){if(!m){u=0;break}if(d=m,s=i.end.shift(),void 0===s)break;if(3===m.nodeType){u=m.nodeValue.length>s?s:m.nodeValue.length;break}m.childNodes.length>s?(m=m.childNodes[s],u=s):(u=m.childNodes.length,m=m.lastChild)}var p=n.getSelection();"None"!==p.type&&p.removeAllRanges();var h=a.createRange();h.setStart(l,c),h.setEnd(d,u),p.addRange(h)}catch(g){e.error.writeError("setSelectionByOffset error: "+g.message+(g.stack?g.stack:""),3,"utils")}},getNodeDom:function(e){return 9===e.nodeType&&(e=e.body),{dom:e.ownerDocument,node:e}},message:function(t,n){if(e.dialog.open({id:"error",content:t,title:"Error tips"}),n)throw e.lang.unexpectedEnd},execPlugin:function(t,n,r){function i(){var i=e.pluginList[t];return e.curEditor.pluginEnable[t]?"function"==typeof i[n]?i[n](r):i.click(n):(e.messageError("plugin "+t+" disabled!"),void 0)}return e.pluginList[t]?i():(e.loadPlugin(t,i),void 0)},execUi:function(t,n,r,i){var a="";e.uiList[t]?(a=e.uiList[t][n](r),a&&i&&i(a)):e.loadUi(t,function(){a=e.uiList[t][n](r),a&&i&&i(a)})},stringToNode:function(e,t){return t===void 0&&(t=document.createElement("div")),t.innerHTML=e,t},filterInner:function(t,n){try{var r=t.baseFilter.excute("html",n),i=this.stringToNode(r),a=t.baseFilter.excute("beforeInsert",i).innerHTML;return a}catch(o){e.error.writeError("filterInner error: "+o.message+(o.stack?o.stack:""),3,"utils")}},loadDialog:function(n,r,i){if(e.uiList[n+"dialog"]===void 0&&e.loadUi(n+"dialog",function(){}),r!==void 0){var a=r+n+".dialog.json",o="[ui="+n+"]";if(0===t(o).length)if(e.dialogHtml[n+"dialog"]===void 0)e.load.loadOneFile(a,function(){var r=e.dialogHtml[n+"dialog"];t("#ui-dialog").append(r),i&&i()});else{var s=e.dialogHtml[n+"dialog"];t("#ui-dialog").append(s),i&&i()}else i&&i()}},getSelectionText:function(){try{var t=e.curEditor.win.getSelection().getRangeAt(0);return""+t}catch(n){e.error.writeError("getText error: "+n.message+(n.stack?n.stack:""),3,"utils")}},removeSelection:function(t){try{t.getSelection().removeAllRanges()}catch(n){e.error.writeError("removeSelection error: "+n.message+(n.stack?n.stack:""),3,"utils")}},setCursor:function(t,n,r){try{r=r?!0:!1;var i={},a=t.getSelection();i=0===a.rangeCount?t.document.createRange():a.getRangeAt(0),i.selectNodeContents(n),i.collapse(r),a.removeAllRanges(),a.addRange(i)}catch(o){e.error.writeError("setCursor error: "+o.message+(o.stack?o.stack:""),3,"utils")}},getSelectionRange:function(t,n){try{var r=t.getSelection(),i={};if("None"!==r.type)i=r.getRangeAt(0);else{var a=t.document.createRange();a.selectNodeContents(t.document.body),a.collapse(!0),r.addRange(a),i=r.getRangeAt(0)}return"node"===n&&(i={startContainer:i.startContainer,startOffset:i.startOffset,endContainer:i.endContainer,endOffset:i.endOffset}),i}catch(o){e.error.writeError("getSelectionRange error: "+o.message+(o.stack?o.stack:""),3,"utils")}},setSelectionRange:function(t,n,r){try{var i={};"object"!=typeof n?(i=t.document.createRange(),i.selectNodeContents(t.document.body),i.collapse(!0)):"node"===r?(i=t.document.createRange(),i.setStart(n.startContainer,n.startOffset),i.setEnd(n.endContainer,n.endOffset)):i=n;var a=t.getSelection();a.removeAllRanges(),a.addRange(i)}catch(o){e.error.writeError("setSelectionRange error: "+o.message+(o.stack?o.stack:""),3,"utils")}},pasteHTML:function(t){e.coreCommand.editInsert(t)},getBoardContent:function(t,n){var r=t.win,i=t.dom,a=i.createElement("div");a.style.cssText="position:absolute;width:1px;height:1px;overflow:hidden;left:-1000px;white-space:nowrap;",a.innerHTML=this.spaceText;try{var o=r.getSelection().getRangeAt(0).cloneRange(),s=r.getSelection().getRangeAt(0);s.setStart(i.body,0),s.collapse(!0),s.surroundContents(a),s.selectNodeContents(a),s.collapse(!0),r.getSelection().removeAllRanges(),r.getSelection().addRange(s)}catch(l){e.error.writeError("getBoardContent error: "+l.message+(l.stack?l.stack:""),3,"utils")}setTimeout(function(){r.getSelection().removeAllRanges(),r.getSelection().addRange(o),n&&n(a),i.body.removeChild(a)},0)},replaceSelectedText:function(t,n){try{var r=t.getSelection(),i={};if("None"===r.type)return!1;if(i=r.getRangeAt(0),3!==i.startContainer.nodeType||i.startContainer!==i.endContainer)return!1;var a=i.startContainer.parentNode,o=i.extractContents();o.firstChild.nodeValue=n,i.insertNode(o),e.curEditor.baseFilter.excuteOne("combine",a)}catch(s){e.error.writeError("replaceSelectedText error: "+s.message+(s.stack?s.stack:""),3,"utils")}},selectNode:function(t,n){try{var r={},i="object"==typeof n?n.ownerDocument:doucment;if(i===t.document){r=i.createRange(),"object"!=typeof n?(r.selectNodeContents(i.body),r.collapse(!0)):r.selectNode(n);var a=t.getSelection();a.removeAllRanges(),a.addRange(r)}}catch(o){e.error.writeError("selectNode error: "+o.message+(o.stack?o.stack:""),3,"utils")}},newApi:function(e,t){alert(e+t)},escape:function(e){return e&&"string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/ /g,"&nbsp;"):e}};n.ready=!0,e.utils=n}(window.jQuery.jQEditor,window.jQuery),function(e){var t={labelMap:{anchor:"锚点",undo:"撤销",redo:"重做",bold:"加粗",indent:"增加缩进量",snapscreen:"截图",italic:"斜体",underline:"下划线",strikethrough:"删除线",subscript:"下标",superscript:"上标",formatmatch:"格式刷",codemirror:"源代码",source:"源代码",blockquote:"引用",pasteplain:"纯文本粘贴模式",selectall:"全选",print:"打印",preview:"预览",horizontal:"分隔线",removeformat:"清除格式",inserttime:"时间",insertdate:"日期",unlink:"取消链接",insertrowbefore:"前插入行",insertcolbefore:"前插入列",insertrowafter:"后插入行",insertcolafter:"后插入列",combinecolafter:"右合并单元格",combinerowafter:"下合并单元格",deleterow:"删除行",deletecol:"删除列",splittorows:"拆分成行",splittocols:"拆分成列",splittocells:"完全拆分单元格",combinecells:"合并多个单元格",deletetable:"删除表格",tableprops:"表格属性",insertparagraphbeforetable:"表格前插行",cleardoc:"清空文档",fontfamily:"字体",fontsize:"字号",paragraph:"段落格式",image:"图片",inserttablemenu:"表格",link:"超链接",emotion:"表情",specharsmenu:"特殊字符",searchreplace:"查询替换",search:"查找",replace:"替换",bmap:"Baidu地图",map:"Google地图",insertvideo:"视频",help:"帮助",justifyleft:"居左对齐",justifyright:"居右对齐",justifycenter:"居中对齐",justifyjustify:"两端对齐",forecolor:"字体颜色",backcolor:"背景色",insertorderedlist:"有序列表",insertunorderedlist:"无序列表",fullscreen:"全屏",directionalityltr:"从左向右输入",directionalityrtl:"从右向左输入",spacetopmenu:"段前距",spacebottommenu:"段后距",highlightcode:"插入代码",pagebreak:"分页",insertframe:"插入Iframe",imagenone:"默认",imageleft:"左浮动",imageright:"右浮动",attachment:"附件",imagecenter:"居中",wordimage:"图片转存",linespacemenu:"行间距",edittd:"单元格",customstyle:"自定义标题",autoformat:"自动排版",touppercase:"字母大写",tolowercase:"字母小写",background:"背景",template:"模板",scrawl:"涂鸦",music:"音乐",cut:"剪切",fontsizemenu:"字体",fontfamilymenu:"字号",pastetotext:"粘贴为纯文本",pasteword:"从 MS Word 粘帖",reference:"参考资料",insertdatemenu:"更多时间格式",multiimage:"多图上传",baikelink:"百科链接",outdent:"减少缩进量",insertunorderedlistmenu:"无序列表样式",insertorderedlistmenu:"有序列表样式",about:"关于",forecolormenu:"更多颜色",backcolormenu:"更多颜色",h2:"一级目录",h3:"二级目录"},insertorderedlist:{decimal:"1,2,3...","lower-alpha":"a,b,c...","lower-roman":"i,ii,iii...","upper-alpha":"A,B,C...","upper-roman":"I,II,III..."},insertunorderedlist:{circle:"○ 小圆圈",disc:"● 小圆点",square:"■ 小方块 "},paragraph:{p:"段落",h1:"标题 1",h2:"标题 2",h3:"标题 3",h4:"标题 4",h5:"标题 5",h6:"标题 6"},fontfamily:{songti:"宋体",kaiti:"楷体",heiti:"黑体",lishu:"隶书",yahei:"微软雅黑",andaleMono:"andale mono",arial:"arial",arialBlack:"arial black",comicSansMs:"comic sans ms",impact:"impact",timesNewRoman:"times new roman"},customstyle:{tc:"标题居中",tl:"标题居左",im:"强调",hi:"明显强调"},fontsize:"字号",fontfamily:"字体",createError:"编辑器创建失败",fillError:"填充panel错误",eventInitError:"事件模块初始化错误",eventRefreshError:"事件重置错误",filterInitError:"过滤器模块初始化错误",filterRefreshError:"过滤器重置错误",pluginInitError:"插件添加并初始化错误",pluginLoadError:"插件文件加载错误",pluginConfigError:"插件配置错误",uiInitError:"ui添加并初始化错误",uiLoadError:"ui文件加载错误",initError:"初始化失败",noCommand:"未检测到该命令，请在config中添加。"};
e.lang=t}(window.jQuery.jQEditor),function(e){var t={initCommand:function(t){this.Eid=t.id,this.win=e.curEditor.win,this.dom=e.curEditor.dom,this.startTime="",this.endTime=""},editText:function(){},editInsert:function(){},beforeCommand:function(t){this.startTime=+new Date,e.trigger("beforeCommand",{targetEditor:e.curEditor,commandName:t}),this.endTime=+new Date,e.log.writeLog("command "+t+" after excute "+(this.endTime-this.startTime)+"ms","command")},excuteCommand:function(t,n,r){var i=this;this.beforeCommand(t);var a="";try{for(var o in e.config.cCommand){var s=e.config.cCommand[o];if(s[t]){""!==s[t].param&&(n&&(r=n),n=s[t].param),s[t].args!==void 0&&(r=s[t].args),t=s[t].cmd,a=o;break}}}catch(l){e.error.writeError("command config error: "+l.message+(l.stack?l.stack:""),4,"command"),e.utils.message(e.lang.commandError,"finish")}try{if(""===t)throw"config cmd no defined";if("textCommand"===a)i.editText(t,n);else if("paragraphCommand"===a)i.editParagraph(t,n);else if("insertCommand"===a)i.editInsert(n);else if("pluginCommand"===a)n=n||"click",r=r||"",e.utils.execPlugin(t,n,r);else{if("uiCommand"!==a)throw e.lang.noCommand+t;n=n||"submit",r=r||"",e.utils.execUi(t,n,r,function(e){e!==!1&&e!==void 0&&i.editInsert(e)})}}catch(l){e.error.writeError(t+"-"+n+" running error: "+l.message+(l.stack?l.stack:""),4,"command")}this.endTime=+new Date,this.afterCommand(t)},afterCommand:function(t){e.trigger("afterCommand",{targetEditor:e.curEditor,commandName:t}),this.endTime=+new Date,e.log.writeLog("command "+t+" after excute "+(this.endTime-this.startTime)+"ms","command")}};e.coreCommand=t,e.command=function(e,n,r){t.excuteCommand(e,n,r)},e.command.ready=!0}(window.jQuery.jQEditor),function(e){function t(){n=e.curEditor.win,r=e.curEditor.dom}var n,r,i=function(i){var a=new t;return a.init(n,r),i=e.utils.filterInner(e.curEditor,i),a.insert(i),a};t.prototype={mainRange:{},mainSelection:{},document:{},win:{},tmpBoard:{},init:function(e,t){this.win=e,this.document=t,this.mainRange=t.createRange(),this.mainSelection=e.getSelection(),"None"===this.mainSelection.type?this.mainSelection.addRange(this.mainRange):this.mainRange=this.mainSelection.getRangeAt(0)},insert:function(t){var n=this._preDoHtml(t),r=this._copyToBoard(n);if(r!==!1)for(var i=0;r.length>i;i++)this._paste(r[i]);this.tmpBoard.nodeValue="",e.curEditor.baseFilter.excute("afterInsert")},_preDoHtml:function(e){return e},_copyToBoard:function(e){var t={},n=this.document.createRange();return n.selectNodeContents(this.document.body),this.tmpBoard=n.createContextualFragment(e),t=this._cutInsertNode(this.tmpBoard)},_paste:function(e){this.mainRange.collapsed||this.mainRange.deleteContents();var t=this.mainRange.cloneRange(),n=t.startContainer,r=!1,i=!1;if(t.startContainer.childNodes.length===t.startOffset&&(i=!0),0===t.startOffset&&(r=!0),"text"!==e.insertType){for(this._hasParentNode(e.insertType,n)||this._fillNode(e);"BODY"!==n.tagName&&(3===n.nodeType||3!==n.nodeType&&1!==DTD[n.tagName][e.insertType]);)t.setStartBefore(n),n=n.parentNode;var a=t.extractContents();t.insertNode(a),t.collapse(!1),t.insertNode(e.insertValue)}else if(3!==t.startContainer.nodeType){t.insertNode(e.insertValue);var o=t.startContainer.childNodes[t.startOffset-1];if(o&&3!==o.nodeType&&1===DTD.$block[o.nodeName]){var s=this.document.createElement("p");t.surroundContents(s)}}else t.insertNode(e.insertValue);t.selectNode(e.insertOri),t.collapse(!1),this.mainRange=t,this.mainSelection.removeAllRanges(),this.mainSelection.addRange(this.mainRange)},_cutInsertNode:function(e){for(var t=[],n=0;e.childNodes.length>n;n++){var r=Object({insetType:"",insertValue:{},insertOri:{}});3===e.childNodes[n].nodeType?(r.insertType="text",r.insertValue=e.childNodes[n],r.insertOri=e.childNodes[n]):(r.insertType=e.childNodes[n].tagName,r.insertValue=e.childNodes[n],r.insertOri=e.childNodes[n]),t[n]=r}return t},_hasParentNode:function(e,t){for(var n=!1;"HTML"!==t.tagName;){if(3!==t.nodeType&&1===DTD[t.tagName][e]){n=!0;break}t=t.parentNode}return n},_fillNode:function(e){var t=this.document.createRange();t.selectNode(e.insertValue);for(var n=e.insertType;DTD[n].parent;){var r=this.document.createElement(DTD[n].parent);t.surroundContents(r),n=DTD[n].parent,e.insertType=n,e.insertValue=r}}},e.coreCommand.editInsert=i}(window.jQuery.jQEditor),function(e,t){function n(){r=e.curEditor.win,i=e.curEditor.dom}var r,i,a=function(e,t){var a=!0,o=new n,s=o.init(r,i);o.mainRange=s.rangeSet[0];for(var l=0;s.len>l;l++)o.mainRange=s.rangeSet[l],a=o.changeParagraph(e,t);return a};n.prototype={mainRange:{},mainSelection:{},document:{},win:{},init:function(n,r){var i={len:0,rangeSet:[]};this.win=n,this.document=r;var a=r.createRange();this.mainSelection=n.getSelection();var o=t(e.curEditor.dom).find("."+e.curEditor.config.selectCellClass),s=t(e.curEditor.dom).find("."+e.curEditor.config.selectTableClass);if(0!==s.length){i.len=s.length;for(var l=0;s.length>l;l++)a.selectNodeContents(s[l]),i.rangeSet[l]=a.cloneRange()}else if(0!==o.length){i.len=o.length;for(var l=0;o.length>l;l++)a.selectNodeContents(o[l]),i.rangeSet[l]=a.cloneRange()}else"None"===this.mainSelection.type?i.len=0:(i.len=1,i.rangeSet[0]=this.mainSelection.getRangeAt(0));return i},changeParagraph:function(e,n){var r="";if(n){if("padding-left"===e){var i=n;n=function(e,t){var n=parseFloat(t)+parseFloat(i);return(n>0?n:0)+"px"}}}else"ul"===e&&(n="disc"),"ol"===e&&(n="decimal");var a=this.mainRange,o=a.commonAncestorContainer,s={ancestor:o,firstNode:a.startContainer,firstOffset:a.startOffset,lastNode:a.endContainer,lastOffset:a.endOffset,styleNode:t()},l=a.cloneRange();l.collapse(!0);var d=a.cloneRange();if(d.collapse(!1),"ul"===e||"ol"===e)return r=this.judgeValue(e,n),this._setParagraph(s,e,n,r),!0;var c={};c=0>=navigator.userAgent.indexOf("MSIE")?this.document.createNodeIterator(o,NodeFilter.SHOW_TEXT):this.document.createNodeIterator(o,3);for(var u={},f={},m={},p=c.nextNode(),h={},g=0,b=1;p;){if(h=c.nextNode(),0===g){var v=this.document.createRange();v.selectNode(p);var y=v.compareBoundaryPoints(v.START_TO_START,l)}if(1===b)if(h){var w=this.document.createRange();w.selectNode(h);var E=w.compareBoundaryPoints(w.START_TO_START,d)}else var E=-1;var k=y>-1&&0===g,C=E>-1&&1===g&&1===b;if(p===s.lastNode||C){u=this._setStyle(p,s,e,n),b=0;break}g&&b&&(m=this._setStyle(p,s,e,n)),g||p!==s.firstNode&&!k||(f=this._setStyle(p,s,e,n),g=1),p=h}},_setStyle:function(n,r,i,a){var o=this.document,s=t(n).closest(r.styleNode).length;if(!s){var l="td,th,dt,dd,li",d=[],c=[],u=[];for(var f in DTD.$paragraph)f=f.toLowerCase(),1===DTD.$paragraph[f]?d.push(f):0===DTD.$paragraph[f]&&c.push(f);d=d.join(","),c=c.join(",");var m=t(n).closest(l);if(m.length>0)t(m[0]).css(i,a),r.styleNode=m[0];else{var p=t(n).closest(c);if(p.length>0){var h=p[0].nodeName;if("body"===h.toLowerCase()||"div"===h.toLowerCase()){var g=t(n).closest(d);if(g.length>0)t(g[0]).css(i,a),r.styleNode=g[0];else for(var b=o.createElement(DTD[h].child),v=p[0].childNodes.length,y=0;v>y;y++)u=p[0].childNodes[y],(3===u.nodeType||1!==DTD[h][u.nodeName])&&(t(u).wrap(b),t(n).closest(u).length>0&&(t(u.parentNode).css(i,a),r.styleNode=b))}else for(var b=o.createElement(DTD[h].child),v=p[0].childNodes.length,y=0;v>y;y++)u=p[0].childNodes[y],(3===u.nodeType||1!==DTD[h][u.nodeName])&&(t(u).wrap(b),t(n).closest(u).length>0&&(t(u.parentNode).css(i,a),r.styleNode=b))}else e.utils.message("has no paragraph")}}},_setParagraph:function(n,r,i,a){var o=this.mainRange.startContainer,s=this.mainRange.endContainer,l={},d={},c=t(o).closest("ol,ul"),u=t(s).closest("ol,ul"),f=a.split("_"),m=[];for(var p in DTD.$block)p=p.toLowerCase(),1===DTD.$block[p]&&1!==DTD.$listItem[p]&&1!==DTD.$list[p]&&m.push(p);m=m.join(","),c.length>0?(l=t(o).closest("li")[0],c=c[0]):(l=t(o).closest(m)[0],c=""),u.length>0?(d=t(s).closest("li")[0],u=u[0]):(d=t(s).closest(m)[0],u="");var h=this.document.createRange(),g=h.cloneRange(),b=this.document.createRange();t(n.ancestor).closest(l).length>0&&(n.ancestor=l.parentNode),t(n.ancestor).closest(d).length>0&&(n.ancestor=d.parentNode),t(n.ancestor).closest(c).length>0&&(n.ancestor=c.parentNode),t(n.ancestor).closest(u).length>0&&(n.ancestor=u.parentNode),h.selectNodeContents(n.ancestor),h.setEndBefore(l),g.selectNodeContents(n.ancestor),g.setStartAfter(d);var v=g.extractContents();g.insertNode(v);var y=h.extractContents();h.insertNode(y),b.setEnd(g.startContainer,g.startOffset),b.setStart(h.endContainer,h.endOffset);for(var w=b.extractContents(),E=w.firstChild,k={};E;){k=E.nextSibling;var C="";C="UL"!==E.nodeName&&"OL"!==E.nodeName?t(E).find("ul,ol"):t(E),C.each(function(){var e=this;t(this).find("li").children().each(function(){e.parentNode.insertBefore(this,e)}),t(this).remove()}),E=k}if(b.insertNode(w),"on"===f[0]){var T=this.document.createElement(r);T.style["list-style-type"]=i;var x=this.document.createElement("li");b.surroundContents(T),t(T).children().each(function(){t(this).wrap(x.cloneNode())})}e.curEditor.baseFilter.excute("afterList"),this.mainRange.setStart(n.firstNode,n.firstOffset),this.mainRange.setEnd(n.lastNode,n.lastOffset),this.mainSelection.removeAllRanges(),this.mainSelection.addRange(this.mainRange)},judgeValue:function(e,n){var r=this.mainRange.startContainer,i=this.mainRange.endContainer,a=[];return a[0]=t(r).closest(e).length>0?t(r).closest(e).css("list-style-type")===n?"off":"on":"on",a[1]=t(i).closest(e).length>0?t(i).closest(e).css("list-style-type")===n?"off":"on":"on",a.join("_")}},e.coreCommand.editParagraph=a}(window.jQuery.jQEditor,window.jQuery),function(e,t){function n(){r=e.curEditor.win,i=e.curEditor.dom}var r,i,a=function(t,a){var o=new n,s=o.init(r,i);o.mainRange=s.rangeSet[0],a&&"text-decoration"!==t||(a=o.judgeValue(t,a));for(var l=0;s.len>l;l++){o.mainRange=s.rangeSet[l];var d=o.changeText(t,a)}return e.curEditor.baseFilter.excute("afterTextPre"),e.curEditor.baseFilter.excute("afterText"),d};n.prototype={mainRange:{},mainSelection:{},document:{},win:{},init:function(n,r){var i={len:0,rangeSet:[]};this.spaceText=e.IE6?"﻿":"​",this.win=n,this.document=r;var a=r.createRange();this.mainSelection=n.getSelection();var o=t(e.curEditor.dom).find("."+e.curEditor.config.selectCellClass),s=t(e.curEditor.dom).find("."+e.curEditor.config.selectTableClass);if(0!==s.length){i.len=s.length;for(var l=0;s.length>l;l++)a.selectNodeContents(s[l]),i.rangeSet[l]=a.cloneRange()}else if(0!==o.length){i.len=o.length;for(var l=0;o.length>l;l++)a.selectNodeContents(o[l]),i.rangeSet[l]=a.cloneRange()}else"None"===this.mainSelection.type?i.len=0:(i.len=1,i.rangeSet[0]=this.mainSelection.getRangeAt(0));return i},changeText:function(e,t){(!t||"text-decoration"===e&&"none"!==t)&&(t=this.judgeValue(e,t)),this.mainRange.collapsed?this.setChange(this.mainRange,e,t):this.excuteChange(this.mainRange,e,t)},setChange:function(e,t,n){"_on"!==n&&"_off"!==n?this._setSpan(e,t,n):"_on"===n?this._setTag(e,t):this._unsetTag(e,t),this.document.createElement("span")},excuteChange:function(e,t,n){var r="style";"wordcase"===t?r="wordcase":"_on"===n?r="tag_on":"_off"===n&&(r="tag_off");var i=e.cloneRange();i.collapse(!0);var a=e.cloneRange();a.collapse(!1);var o=e.commonAncestorContainer,s={ancestor:o,firstNode:e.startContainer,firstOffset:e.startOffset,lastNode:e.endContainer,lastOffset:e.endOffset},l="",d="",c="",u="";if(s.firstNode!==s.lastNode||3!==s.firstNode.nodeType){var f={};f=0>=navigator.userAgent.indexOf("MSIE")?this.document.createNodeIterator(o,NodeFilter.SHOW_TEXT):this.document.createNodeIterator(o,3);for(var m=f.nextNode(),p={},h=0,g=1,b=0;m;){if(p=f.nextNode(),0===h){var v=this.document.createRange();v.selectNode(m);var y=v.compareBoundaryPoints(v.START_TO_START,i)}if(1===g)if(p){var w=this.document.createRange();w.selectNode(p);var E=w.compareBoundaryPoints(w.START_TO_START,a)}else var E=-1;var k=y>-1&&0===h,C=E>-1&&1===h&&1===g;if(m===s.lastNode||C){d="style"===r?this._addSpan(m,s,t,n,"last"):"wordcase"===r?this._wordCase(m,s,t,n,"last"):"tag_on"===r?this._addTag(m,s,t,"last","on"):this._addTag(m,s,t,"last","off"),d?l||(l=d):d=c,g=0,this.mainRange.setStart(l.startContainer,l.startOffset),this.mainRange.setEnd(d.endContainer,d.endOffset),this.mainSelection.removeAllRanges(),this.mainSelection.addRange(this.mainRange);break}h&&g&&(u="style"===r?this._addSpan(m,s,t,n,"mid"):"wordcase"===r?this._wordCase(m,s,t,n,"mid"):"tag_on"===r?this._addTag(m,s,t,"mid","on"):this._addTag(m,s,t,"mid","off"),u&&(c=u,l||(l=u))),h||m!==s.firstNode&&!k||(l="style"===r?this._addSpan(m,s,t,n,"first"):"wordcase"===r?this._wordCase(m,s,t,n,"first"):"tag_on"===r?this._addTag(m,s,t,"first","on"):this._addTag(m,s,t,"first","off"),h=1,l&&3!==m.nodeType&&(b=1)),m=p}}else l="style"===r?this._addSpan(s.firstNode,s,t,n,"cut"):"wordcase"===r?this._wordCase(s.firstNode,s,t,n,"cut"):"tag_on"===r?this._addTag(s.firstNode,s,t,"cut","on"):this._addTag(s.firstNode,s,t,"cut","off"),this.mainRange=l,this.mainSelection.removeAllRanges(),this.mainSelection.addRange(this.mainRange)},_addSpan:function(e,t,n,r,i){var a=this.document.createElement("span");if(3===e.nodeType&&/\S/.test(e.nodeValue)){var o=this.document.createRange();o.selectNode(e);var s=o.cloneRange(),l=o.cloneRange();if(("last"===i||"cut"===i)&&(o.setEnd(e,t.lastOffset),s.setEndAfter(e.parentNode),s.setStart(e,t.lastOffset)),("first"===i||"cut"===i)&&(o.setStart(e,t.firstOffset),l.setStartBefore(e.parentNode),l.setEnd(e,t.firstOffset)),"SPAN"===e.parentNode.tagName){var d="",c="";if("cut"===i)d=s.extractContents(),s.insertNode(d),c=l.extractContents(),l.insertNode(c),this.setStyleType(n,r,e.parentNode),o.selectNodeContents(e);else{if("last"===i&&(d=s.extractContents(),s.insertNode(d)),"first"===i&&(c=l.extractContents(),l.insertNode(c)),e.parentNode.firstChild!==e.parentNode.lastChild){var u="",f="";"first"===i?(o.setStartBefore(e.parentNode),o.setEndAfter(e),f=o.extractContents(),e=f.firstChild.firstChild,o.insertNode(f)):"last"===i?(o.setEndAfter(e.parentNode),o.setStartBefore(e),u=o.extractContents(),e=u.firstChild.firstChild,o.insertNode(u)):"mid"===i&&(o.setStartBefore(e.parentNode),o.setEndAfter(e),f=o.extractContents(),o.insertNode(f),o.setStartBefore(e),u=o.extractContents(),e=u.firstChild.firstChild,o.insertNode(u))}this.setStyleType(n,r,e.parentNode),o.selectNodeContents(e)}}else this.setStyleType(n,r,a),o.surroundContents(a);return o}},_wordCase:function(e,t,n,r,i){if(3===e.nodeType&&/\S/.test(e.nodeValue)){var a=this.document.createRange();a.selectNode(e),("last"===i||"cut"===i)&&a.setEnd(e,t.lastOffset),("first"===i||"cut"===i)&&a.setStart(e,t.firstOffset);var o=a.extractContents(),s=o.firstChild.nodeValue,l="lower"===r?s.toLowerCase():s.toUpperCase();return o.firstChild.nodeValue=l,a.insertNode(o),a}},_addTag:function(e,t,n,r,i){var a=this.document.createElement(n);if(3===e.nodeType&&/\S/.test(e.nodeValue)){var o=this.document.createRange();o.selectNode(e);var s=o.cloneRange(),l=o.cloneRange();for(("first"===r||"cut"===r)&&(o.setStart(e,t.firstOffset),s.setStartBefore(e),s.setEnd(e,t.firstOffset)),("last"===r||"cut"===r)&&(o.setEnd(e,t.lastOffset),l.setEndAfter(e),l.setStart(e,t.lastOffset));1===DTD[n][e.parentNode.tagName]&&1!==DTD.$block[e.parentNode.tagName]&&e.parentNode.firstChild===e.parentNode.lastChild;)("first"===r||"mid"===r||"cut"===r)&&(o.setEndAfter(e.parentNode),s.setStartBefore(e.parentNode)),("last"===r||"mid"===r||"cut"===r)&&(o.setStartBefore(e.parentNode),l.setEndAfter(e.parentNode)),e=e.parentNode;if(e.parentNode.tagName===n.toUpperCase()){if("on"===i)return o;var d=!0}else if("off"===i)return o;var c="",u="";if(("cut"===r||"last"===r)&&(c=l.extractContents(),l.insertNode(c),o.setEnd(l.startContainer,l.startOffset)),("cut"===r||"first"===r)&&(u=s.extractContents(),s.insertNode(u),o.setStart(s.endContainer,s.endOffset)),2===DTD[n][e.parentNode.tagName]||d===!0){var f=e.parentNode,m=o.extractContents();("cut"===r||"last"===r)&&(l.setEndAfter(f),c=l.extractContents(),l.insertNode(c),l.collapse(!0),o=l),("cut"===r||"first"===r||"mid"===r)&&(s.setEnd(o.startContainer,o.startOffset),s.setStartBefore(f),u=s.extractContents(),s.insertNode(u),s.collapse(!1),o=s),o.insertNode(m),d!==!0&&o.surroundContents(a)}else"cut"===r&&(o.setStart(s.endContainer,s.endOffset),o.setEnd(l.startContainer,l.startOffset)),o.surroundContents(a);return o}},_setTag:function(e,t){var n=e.startContainer,r=this.document.createElement(t);if(3===n.nodeType&&/\S/.test(n.nodeValue)){var i=this.document.createTextNode(this.spaceText);e.insertNode(i),n=i;var a=e.cloneRange();a.setStartBefore(i),a.setEndAfter(i);var o=r.cloneNode(),s=this.document.createRange(o);s.selectNodeContents(o);var l=a.cloneRange(),d=a.cloneRange();for(l.setStartBefore(n),l.setEndBefore(i),d.setEndAfter(n),d.setStartAfter(i);1===DTD[t][n.parentNode.tagName]&&1!==DTD.$block[n.parentNode.tagName]&&n.parentNode.firstChild===n.parentNode.lastChild;)l.setStartBefore(n.parentNode),d.setEndAfter(n.parentNode),n=n.parentNode;if(n.parentNode.tagName===t.toUpperCase())return;var c=d.extractContents();d.insertNode(c);var u=l.extractContents();if(l.insertNode(u),2===DTD[t][n.parentNode.tagName]){var f=n.parentNode;a.setStart(l.endContainer,l.endOffset),a.setEnd(d.startContainer,d.startOffset);var m=a.extractContents();d.setEndAfter(f),c=d.extractContents(),d.insertNode(c),l.setStartBefore(f),u=l.extractContents(),l.insertNode(u),a.setStart(l.endContainer,l.endOffset),a.setEnd(d.startContainer,d.startOffset),a.deleteContents(),a.insertNode(m),a.surroundContents(r)}else a.setStart(l.endContainer,l.endOffset),a.setEnd(d.startContainer,d.startOffset),a.surroundContents(o);this.mainSelection.removeAllRanges(),this.mainRange.setStart(i,0),this.mainRange.setEnd(i,1),this.mainSelection.addRange(this.mainRange)}},_setSpan:function(e,t,n){var r=this.document.createElement("span"),i=e.startContainer;if(3===i.nodeType&&/\S/.test(i.nodeValue)){var a=e.cloneRange();if("SPAN"===i.parentNode.tagName){var o=t+": "+n,s=i.parentNode.style.cssText.search(o);if(-1!==s)return;a.setStartBefore(i.parentNode);var l=a.extractContents();a.insertNode(l),a.collapse(!1)}var d=this.document.createRange();d.selectNodeContents(r);var c=this.document.createTextNode(this.spaceText);d.insertNode(c),this.setStyleType(t,n,r),a.insertNode(r),this.mainSelection.removeAllRanges(),this.mainRange.setStart(c,1),this.mainSelection.addRange(this.mainRange)}},_unsetTag:function(e,t){var n=e.cloneRange(),r=e.cloneRange(),i=e.cloneRange();e.cloneRange();var a=this.document.createTextNode(this.spaceText);i.insertNode(a),n.setEndBefore(a),r.setStartAfter(a);for(var o=e.startContainer;o.parentNode&&t.toUpperCase()!==o.parentNode.tagName;)o=o.parentNode;if(t.toUpperCase()===o.parentNode.tagName){var s=o.parentNode,l="",d="";i.setStart(n.endContainer,n.endOffset),i.setEnd(r.startContainer,r.startOffset);var c=i.extractContents();r.setEndAfter(s),l=r.extractContents(),r.insertNode(l),n.setStartBefore(s),d=n.extractContents(),n.insertNode(d),i.setStart(n.endContainer,n.endOffset),i.setEnd(r.startContainer,r.startOffset),i.deleteContents(),i.insertNode(c)}this.mainSelection.removeAllRanges(),this.mainRange.setStart(a,0),this.mainRange.setEnd(a,1),this.mainSelection.addRange(this.mainRange)},setStyleType:function(e,t,n){n.style.cssText+=";"+e+": "+t+";"},judgeValue:function(t,n){var r="_on",i=this.mainRange.startContainer,a=3!==i.nodeType||i.nodeValue.length<=this.mainRange.startOffset;if(!this.mainRange.collapsed&&a){var o={},s=this.mainRange.commonAncestorContainer;o=0>=navigator.userAgent.indexOf("MSIE")?this.document.createNodeIterator(s,NodeFilter.SHOW_ALL):this.document.createNodeIterator(s);for(var l=this.document.createRange(),d=o.nextNode(),c=!1;d;){if((d===i||c===!0)&&(c=!0,3===d.nodeType&&d.nodeValue.length>0&&(l.selectNodeContents(d),1>this.mainRange.compareBoundaryPoints(l.START_TO_START,l)))){i=d;break}d=o.nextNode()}l.detach()}if("string"==typeof n)r=n,e.curEditor.dom.queryCommandState("underline")===!0&&"underline"===n&&(r="none"),e.curEditor.dom.queryCommandState("strikethrough")===!0&&"line-through"===n&&(r="none");else for(;i&&"BODY"!==i.nodeName;){if(3!==i.nodeType&&(3===DTD[i.nodeName][t]||t===i.nodeName.toLowerCase())){r="_off";break}i=i.parentNode}return r}},e.coreCommand.editText=a}(window.jQuery.jQEditor,window.jQuery),function(e){function t(e){this.name=e.name,this.type=e.type,this.area=e.area?e.area:"custom",this.fn=e.fn,this.isEnable=e.isEnable?e.isEnable:!0}function n(){this.editAreaEvents={},this.customEvents={},this.customEventList={},this.delegate()}function r(t){try{this.editWin=t.win,this.editDom=t.dom,this.Eid=t.config.id,this.curEditor=t,this.customEvents={},this.editAreaEvents={},this.blackList=t.config.cEvent.blackList,this.eventConfig={},e.listenEditarea(this.curEditor),e.listenEditareaExt(this.curEditor),this.refreshList()}catch(n){e.error.writeError("editor event init error: "+n.message+(n.stack?n.stack:""),5,"event"),e.utils.message(e.lang.initError,"finish")}}n.allList={},n.prototype={addEvent:function(e){var n={};n=this.customEventList[e.name]===void 0?new t(e):this.customEventList[e.name];for(var r=e.type.length,i=0;r>i;i++)this.customEvents[e.type[i]]===void 0&&(this.customEvents[e.type[i]]={}),this.customEvents[e.type[i]][n.name]=n;this.customEventList[n.name]=n},bindEvent:function(e){this.customEventList[e].isEnable=!0},unbindEvent:function(e){this.customEventList[e].isEnable=!0},triggerEvent:function(e,t){var n=this.customEvents[e];for(var r in n)n[r].isEnable!==!1&&n[r].fn(t)},delegate:function(){}};var i=new n(e.config);e.trigger=function(t,n){var r=!0,a=i.customEvents[t];if(a)for(var o in a)if(a[o]&&a[o].isEnable!==!1)try{if(n&&n.targetEditor&&n.targetEditor.baseEvent){var s=n.targetEditor.baseEvent.eventConfig;s[a[o]]!==!1&&!1===a[o].fn(n)&&(r=!1)}else!1===a[o].fn(n)&&(r=!1)}catch(l){e.error.writeError(t+"type-name"+o+" event error: "+l.message+(l.stack?l.stack:""),4,"event")}return r},r.prototype={add:function(e,t){var n={name:t,type:e};i.addEvent(n)},_findEvent:function(e,t){if(this.customEvents[e]!==void 0)for(var n=this.customEvents[e].length,r=0;n>r;r++)if(t===this.customEvents[e][r])return r;return!1},remove:function(t,n){try{if("*"===t)if("*"===n)for(var r in i.customEvents)i.customEvents[r]={};else for(var r in i.customEvents)i.customEvents[r][n]=void 0;else"*"===n?i.customEvents[t]={}:i.customEvents[t][n]=void 0}catch(a){e.error.writeError(t+" type - "+n+" remove error: "+a.message+(a.stack?a.stack:""),3,"event")}},disable:function(t,n){try{var r="";if("*"===t)if("*"===n)for(var i in this.customEvents)this.customEvents[i]=[];else for(var i in this.customEvents)r=this._findEvent(i,n),r!==!1&&this.customEvents[i].splice(r,1);else"*"===n?this.customEvents[t]=[]:(r=this._findEvent(t,n),r!==!1&&this.customEvents[t].splice(r,1))}catch(a){e.error.writeError(t+" type - "+n+" disable error："+a.message+(a.stack?a.stack:""),3,"event")}},enable:function(t,n){try{var r="";if("*"===t){if("*"===n)for(var a in i.customEvents)for(var o=i.customEvents[a].length,s=0;o>s;s++)r=this._findEvent(a,i.customEvents[a][s].name),r===!1&&this.customEvents[a].push(i.customEvents[a][s].name);else if(i.customEventList[n]!==void 0)for(var a in i.customEvents)r=this._findEvent(a,n),r===!1&&this.customEvents[a].push(n)}else if("*"===n)for(var o=i.customEvents[t].length,s=0;o>s;s++)r=this._findEvent(t,i.customEvents[t][s].name),r===!1&&this.customEvents[t].push(i.customEvents[t][s].name);else r=this._findEvent(t,n),r===!1&&i.customEventList[n]!==void 0&&this.customEvents[t].push(n)}catch(l){e.error.writeError(t+" type - "+n+" enabel error "+l.message+(l.stack?l.stack:""),3,"event")}},refreshList:function(){try{this.customEvents={},this.eventConfig={};for(var t in i.customEvents){var n=i.customEvents[t];this.customEvents[t]===void 0&&(this.customEvents[t]=[]);for(var r in n)this.customEvents[t].push(r),this.eventConfig[r]=!0}for(var a=this.blackList.length,o=0;a>o;o++){var s=this.blackList[o].split(".");this.disable(s[0],s[1])}}catch(l){e.error.writeError("event refresh error: "+l.message+(l.stack?l.stack:""),4,"event")}}},r.ready=!0,e.EditorEvent=r,e.addEvent=function(e){i.addEvent(e)},e.bind=function(e,t,n){"string"==typeof t&&(t=[t]),i.addEvent({name:e,type:t,fn:n})}}(window.jQuery.jQEditor),function(e){function t(e){this.name=e.name,this.order=e.order?e.order:"third",this.type=e.type?e.type:["dom"],this.replace=e.replace?e.replace:function(){}}function n(t){try{this.editWin=t.win,this.editDom=t.dom,this.Eid=t.Eid,this.curEditor=t,this.enableList=this.configFilter(t.config),this.exeList={},this.refreshList()}catch(n){e.error.writeError("editor filter init error: "+n.message+(n.stack?n.stack:""),5,"filter"),e.utils.message(e.lang.initError,"finish")}}t.exeList={dom:{dom:{first:[],second:[],third:[],fourth:[],fifth:[]},afterTextPre:{first:[],second:[],third:[],fourth:[],fifth:[]},afterText:{first:[],second:[],third:[],fourth:[],fifth:[]},afterList:{first:[],second:[],third:[],fourth:[],fifth:[]},beforeSubmit:{first:[],second:[],third:[],fourth:[],fifth:[]},beforeCmd:{first:[],second:[],third:[],fourth:[],fifth:[]},afterCmd:{first:[],second:[],third:[],fourth:[],fifth:[]},beforeInsert:{first:[],second:[],third:[],fourth:[],fifth:[]},afterInsert:{first:[],second:[],third:[],fourth:[],fifth:[]}},html:{html:{first:[],second:[],third:[],fourth:[],fifth:[]},beforePaste:{first:[],second:[],third:[],fourth:[],fifth:[]}}},t.list={},e.addFilter=function(n){try{for(var r=new t(n),i=r.type.length,a=0;i>a;a++)"dom"===r.type[a]?t.exeList.dom.dom[r.order].push(r):t.exeList.dom[r.type[a]]&&(t.exeList.dom[r.type[a]][r.order].push(r),t.exeList.dom.dom[r.order].push(r)),"html"===r.type[a]?t.exeList.html.html[r.order].push(r):t.exeList.html[r.type[a]]&&(t.exeList.html[r.type[a]][r.order].push(r),t.exeList.html.html[r.order].push(r));t.list[r.name]=r}catch(o){e.error.writeError(n.name+" filter add error: "+" "+o.message+(o.stack?o.stack:""),3,"filter")}},e.loadFilter=function(t){e.load.loadOneFile(t,function(){for(var t in e.editorList)e.editorList[t].baseFilter.refreshList()})},t.prototype={replace:function(){}},n.prototype={refreshList:function(){try{for(var n in t.exeList.dom){var r=[],i=t.exeList.dom[n].first,a=t.exeList.dom[n].second,o=t.exeList.dom[n].third,s=t.exeList.dom[n].fourth,l=t.exeList.dom[n].fifth;this.exeList[n]=r.concat(i,a,o,s,l)}for(var n in t.exeList.html){var r=[],i=t.exeList.html[n].first,a=t.exeList.html[n].second,o=t.exeList.html[n].third,s=t.exeList.html[n].fourth,l=t.exeList.html[n].fifth;this.exeList[n]=r.concat(i,a,o,s,l)}}catch(d){e.error.writeError("filter refresh error: "+d.message+(d.stack?d.stack:""),3,"filter")}},configFilter:function(e){for(var t={},n=e.cFilter.blackList,r=e.cFilter.whiteList,i=n.length,a=r.length,o=0;i>o;o++)t[n[o]]=!1;for(var o=0;a>o;o++)t[r[o]]=!0;return t},excute:function(t,n){var r=this.exeList[t].length;if("string"==typeof n){for(var i=void 0,a=n,o=0;r>o;o++){var s=this.exeList[t][o].name;if(this.enableList[s]!==!1)try{i=this.exeList[t][o].replace(this.editWin,a),i!==void 0&&(a=i)}catch(l){e.error.writeError(t+" type-"+s+" filter error "+l.message+(l.stack?l.stack:""),2,"filter")}}return a}n===void 0&&(n=this.editDom);for(var d=n,o=0;r>o;o++){var s=this.exeList[t][o].name;if(this.enableList[s]!==!1)try{this.exeList[t][o].replace(this.editWin,d)}catch(l){e.error.writeError(t+" type-"+s+" filter error "+l.message+(l.stack?l.stack:""),3,"filter")}}return d},excuteOne:function(n,r){if(t.list[n]&&this.enableList[n]!==!1){if("string"==typeof r){var i=void 0,a=r;try{i=t.list[n].replace(this.editWin,a),i!==void 0&&(a=i)}catch(o){e.error.writeError(n+" filter error "+o.message+(o.stack?o.stack:""),2,"filter")}return a}r===void 0&&(r=this.editDom);try{var s=r;t.list[n].replace(this.editWin,s)}catch(o){e.error.writeError(n+" filter error "+o.message+(o.stack?o.stack:""),3,"filter")}return s}},enable:function(e){this.enableList[e]=!0},disable:function(e){this.enableList[e]=!1}},n.ready=!0,e.EditorFilter=n}(window.jQuery.jQEditor),function(e){function t(n){if(this.ui="",n){for(var r in n)this[r]=n[r];var i=t.allList[this.id];i||alert("添加插件之后，还需要到command-conig.js进行注册喲"),i.title=e.getLang(this.id),i.isEnable=this.isEnable,this.htmlCmd=i.htmlCmd;for(var a in e.editorList)e.editorList[a].pluginEnable[this.id]===void 0&&(e.editorList[a].pluginEnable[this.id]=this.isEnable);this.fill()}}function n(n){function r(e){t.call(this,e)}try{if(n.id){var i=n.id;r.prototype=s,e.pluginList[i]=new r(n),e.pluginList[i].init(),e.trigger("afterPlugin")}}catch(a){e.error.writeError(n.id+" plugin add error: "+a.message+(a.stack?a.stack:""),3,"plugin")}}var r=e.config.cCommand,i={};for(var a in r.pluginCommand){var o=r.pluginCommand[a];i[o.cmd]={htmlCmd:a,isEnable:!0,scriptAddr:e.config.cBase.pluginDir+o.cmd+".plugin.js"}}e.loadPlugin=function(t,n){var r=i[t].scriptAddr;e.pluginList[t]===void 0?e.load.loadOneFile(r,function(){n&&n()}):n&&n()},t.allList=i,e.configPlugin=function(n){try{var r={};for(var i in t.allList)r[i]="undefined"===t.allList[i].isEnable?t.allList[i].isEnable:!0;for(var a=n.cPlugin.blackList,o=n.cPlugin.whiteList,s=a.length,l=o.length,d=0;s>d;d++)r[a[d]]=!1;for(var d=0;l>d;d++)r[o[d]]=!0;return r}catch(c){e.error.writeError("plugin config error: "+c.message+(c.stack?c.stack:""),3,"plugin")}},t.prototype={initPlugin:function(){},init:function(){var t=this.id+"dialog";"dialog"===this.type&&setTimeout(function(){e.loadUi(t)},0)},click:function(){"panel"===this.type?e.toolbar.togglePanel(this.htmlCmd):"dialog"===this.type&&this.showDialog&&this.showDialog(e.curEditor)},getData:function(){return{}},showDialog:function(t){var n=this;e.dialog.open({id:n.ui,editor:t.Eid,title:n.title,content:e.uiList[n.ui].getHtml(),ok:function(){return n.check()?(e.dialog.revertSelection(),e.command(n.ui),void 0):!1},cancel:function(){e.dialog.close(n.ui)}},n.getData(t))},check:function(){return!0},fill:function(){},enable:function(t){t||(t=e.curEditor),t.pluginEnable[this.id]=!0},disable:function(t){t||(t=e.curEditor),t.pluginEnable[this.id]=!1},getTitle:function(){return e.lang.pluginTitle[this.title]},writeLog:function(t){var n="The operate "+t+" !",r="plugin",i=new Date,a=i.toLocaleString();e.log.writeLog(n,r,a)},writeError:function(t,n){var r="The operate "+t+" error !",i="plugin",a=new Date,o=a.toLocaleString();e.error.writeError(r,n,i,o)},showTips:function(t){var n="";t||(t=this.tips),n=e.lang.pluginTips[t]?e.lang.pluginTips[t]:t,e.utils.showTips(n)},loadUiTpl:function(t){e.utils.loadDialog(this.id,e.config.cBase.uiDir+this.id+"/",t)},clicked:function(t,n){n=n||this.id;var r=e.curEditor.$toolbar;r.find("#icon-"+n).closest(".bke-btn")[t?"addClass":"removeClass"]("bke-clicked")}};var s=new t;s.initPlugin(),n.ready=!0,e.addPlugin=n,e.plugin=function(t){return e.pluginList[t]}}(window.jQuery.jQEditor),function(e,t){function n(e){if(this.html="",e)for(var t in e)this[t]=e[t]}function r(t){function r(e){n.call(this,e)}try{if(t.id){var i=t.id;r.prototype=d,e.uiList[i]=new r(t),e.uiList[i].initUi(),e.trigger("afterUi")}}catch(a){e.error.writeError(t.id+" ui add error: "+a.message+(a.stack?a.stack:""),3,"ui")}}var i=e.config.cCommand,a={};for(var o in i.uiCommand){var s=i.uiCommand[o],l=s.cmd.replace("dialog","");a[s.cmd]={isEnable:!0,scriptAddr:e.config.cBase.uiDir+l+"/"+l+".dialog.js"}}e.loadUi=function(t,n){if(a[t]){var r=a[t].scriptAddr;e.uiList[t]===void 0?e.load.loadOneFile(r,function(){n&&n()}):n&&n()}},n.prototype={initUi:function(){this.allList=a,0===t(document.body).find("#ui-dialog").length&&t(document.body).append('<div id="ui-dialog" style="display:none;"></div>')},check:function(){return!0},submit:function(){return!1},cancel:function(){return!1},getHtml:function(){return this.html},getValues:function(){var e={},n=t("#"+this.id+" :input");return n.each(function(){this.name&&(e[this.name]=t(this).val())}),e},setValues:function(e){var n=t("#"+this.id+" :input");n.each(function(){this.name&&"undefinded"!=typeof e[this.name]&&t(this).val(e[this.name])})},hide:function(){},enable:function(){this.isEnable=!0},disable:function(){this.isEnable=!1},error:function(t){e.dialog.error(t)
},success:function(t){e.dialog.success(t)},writeLog:function(t){var n="The operate "+t+" !",r="ui",i=new Date,a=i.toLocaleString();e.log.writeLog(n,r,a)},writeError:function(t,n){var r="The operate "+t+" error !",i="ui",a=new Date,o=a.toLocaleString();e.error.writeError(r,n,i,o)},showTips:function(t){var n="";t||(t=this.tips),n=e.lang.UiTips[t]?e.lang.UiTips[t]:t,e.utils.showTips(n)}};var d=new n;d.initUi(),r.ready=!0,e.addUi=r,e.ui=function(t){return e.uiList[t]}}(window.jQuery.jQEditor,window.jQuery),function(e,t){function n(){}var r,i="",a=null;n.prototype={init:function(e){var n=e.id,i=e.content instanceof jQuery?e.content[0].outerHTML:e.content,a=e.title,o=e.ok,s=e.cancel,l=e.init||e.initialize,d=e.button;return e.url,r=t.artDialog({id:n,content:i,title:a,fixed:!0,ok:o,cancel:s,button:d,okValue:" 确定 ",cancelValue:" 取消 ",initialize:l}),r.dom.dialog.addClass("bke-dialog").attr("id",e.id).find(".d-buttons").prepend('<div class="d-error"></div>'),r},open:function(n,o){i=e.utils.getSelectionRange(e.curEditor.win),t.artDialog.get(n.id)?t.artDialog.get(n.id).dom.dialog.attr("editor",n.editor):(r=this.init(n),r.dom.dialog.attr("editor",n.editor)),o!==void 0&&(a=n.ui?n.ui:n.id,e.utils.execUi(a,"setValues",o))},close:function(n){n=n||a,t.artDialog.get(n)&&t.artDialog.get(n).close(),this.revertSelection(),e.curEditor.win.focus()},submit:function(e){this.close(e)},revertSelection:function(){i&&e.utils.setSelectionRange(e.curEditor.win,i)},error:function(e,t){t=t||"red",r.dom.dialog.find(".d-error").css("color",t).html(e).show()},success:function(e){this.error(e,"green")},clear:function(){r.dom.dialog.find(".d-error").fadeOut()}};var o=new n;o.ready=!0,e.dialog=o,t(document).delegate(".d-content :input","click",function(){o.clear()})}(jQuery.jQEditor,jQuery),function(e,t){var n,r=0,i=0,a=0;setTimeout(function(){t("body").append('<div id="bke-contextmenu" class="bke-contextmenu" style="display:none;"></div>')},0),t(document).bind("click",function(){t("#bke-contextmenu").hide()});var o={create:function(e){for(var t='<div class="bke-menu"><div class="bke-shadow bke-default"></div><div class="bke-menu-body">',n=e.length,r=0;n>r;r++){var i="",a="";if(e[r].submenu&&(i="object"==typeof e[r].submenu?o.create(e[r].submenu):'<div class="bke-menu">'+e[r].submenu+"</div>",a='<div class="bke-menu-more"></div>'),"separator"===e[r].name||"-"===e[r].name)t+='<div class="bke-menu-separator"><div class="bke-menu-separator-inner"></div></div>';else{var s=e[r].icon||"",l="",d="";e[r].disabled&&(s+=" disabled"),e[r].styleName&&(d=e[r].styleName),e[r].cmd&&(l=' cmd="'+e[r].cmd+'"'),e[r].param&&(l+=' param="'+e[r].param+'"'),e[r].args&&(l+=' args="'+e[r].args+'"'),t+='<div class="bke-menu-item '+d+'"'+l+">"+'<div class="bke-menu-icon '+s+'"></div>'+'<div class="bke-menu-label"><a href="javascript:'+e[r].cmd+'" onclick="return false;">'+e[r].name+"</a></div>"+a+i+"</div>"}}return t+="</div></div>"},contextmenu:function(e,r){var i=this;n=t("#bke-contextmenu"),n.html(i.create(e)),i._show(n,r),i._setEvent(n)},_show:function(e,t){e.css({"z-index":10,top:-1e3,left:-1e3}).show();var n=this,r=n._setPosition(e,t);e.css(r)},_setEvent:function(n){this._setEvent=function(){};var r=this,i=e.curEditor.dom;t(i).bind("click.contextmenu",function(){n.hide()}),n.delegate(".bke-menu-item","mouseenter",function(e){var n=t(this).find(".bke-menu, .bke-submenu");if(clearTimeout(a),n.size()){a=setTimeout(function(){n.show()},200);var i=r._setSubPosition(n,e);n.css(i),n.css({"z-index":150})}}).delegate(".bke-menu-item","mouseleave",function(){t(this).find(".bke-menu").hide()}).delegate(".bke-menu-item","mousedown",function(){return e.curEditor.win.focus(),!1}).delegate(".bke-menu-item","click",function(r){var i=t(r.target).closest("[cmd]");if(i.length){var a=i.attr("cmd"),o=i.attr("param"),s=i.attr("args");e.command(a,o,s),n.hide()}return!1})},_setPosition:function(n,a){var o=t("#"+e.curId).find("iframe").offset(),s=o.left,l=o.top,d=t(document).scrollTop(),c=t(document).scrollLeft(),u=a.clientX+s+5,f=a.clientY+l+5-d,m=t(window).width()-u,p=t(window).height()-f;return r=n.outerWidth()>m?c+u-n.outerWidth():c+u,i=n.outerHeight()>p?f>n.outerHeight()?d+f-n.outerHeight():d+30:d+f,{top:i,left:r}},_setSubPosition:function(){return{top:0}}};e.Menu=o}(jQuery.jQEditor,jQuery),function(e,t){var n=/^http:\/\/(\w+\.){0,2}(?:hudong|baike|hoodong)\.com/i,r="function"==typeof g_filterExternal?g_filterExternal:function(){return 1};e.addFilter({name:"baike",type:["dom"],replace:function(e,i){if("object"!=typeof i||!i.body)return i;var a=t("a",i);a.each(function(){var e=t(this),i=e.attr("href"),a=e.text();if(!e.is(".innerlink,.baikelink")&&!/www\.(hudong|baike)\.com\/wiki\//i.test(i)||n.test(a)){if(i&&r()){i=i.toLowerCase();var o=i.indexOf(location.hostname);/^\w+:/i.test(i)&&!n.test(i)&&(!location.hostname||0>o||o>10)&&e.replaceWith(e.html())}}else e.attr("href","http://www.baike.com/wiki/"+encodeURI(a))}),t(".hdwiki_tmml",i).each(function(){var e=t(this),n=e.text();e.replaceWith("<h2>"+n+"</h2>")}),t(".hdwiki_tmmll",i).each(function(){var e=t(this),n=e.text();e.replaceWith("<h3>"+n+"</h3>")})}})}(jQuery.jQEditor,jQuery),function(e){var t=function(e,t,n){var r=!1,i=n.firstChild;if(null!==i){var a={},o=t.createRange();for(o.setStartBefore(i),o.collapse(!0);null!==i;){if(a=i.nextSibling,DTD.$inline[i.tagName]!==void 0||3===i.nodeType&&/\S/.test(i.nodeValue))o.setEndAfter(i),r=!0;else if(DTD.$block[i.tagName]!==void 0){if(r===!0){var s=t.createElement("p");o.surroundContents(s)}o.setStartAfter(i),o.collapse(!0),r=!1}if(i===n.lastChild&&r===!0){var s=t.createElement("p");o.surroundContents(s)}i=a}}},n=function(n,r){var i=e.utils.getNodeDom(r),a=i.dom;return r=i.node,t(n,a,r),r};e.addFilter({name:"block",type:["afterText","afterInsert"],replace:n})}(window.jQuery.jQEditor),function(e,t){function n(a){for(var o=[],s=a.childNodes,l=0;s.length>l;l++){var d=s[l];if(1===d.nodeType){var c=d.tagName.toLowerCase();if(r[c]){for(var u,f=e.IE?i:t.makeArray(d.attributes),m=r[c],p="",h=0,g=f.length;g>h;h++)u=e.IE?f[h]:f[h].name.toLowerCase(),-1===t.inArray(u,m)&&(d.removeAttribute(u),o[u]=d.getAttribute(u));if(p=e.IE?d.style.cssText:d.getAttribute("style")){p=p.replace(/; /g,";").toLowerCase();for(var b,v=p.split(";"),h=0,g=v.length;g>h;h++)b=v[h].split(":"),2===b.length&&-1===t.inArray("."+b[0],m)&&(p=p.replace(RegExp(b[0]+":"+b[1]+";?","i"),""));p=t.trim(p),p?e.IE?d.style.cssText=p:d.setAttribute("style",p):d.removeAttribute("style")}if("table"===c){var y=t(d),w=y.attr("bordercolor");y.hasClass("jqe-table")||y.addClass("jqe-table"),w||y.attr("bordercolor","#cccccc"),y.attr("border",1)}d.hasChildNodes()&&n(d)}else if(d.hasChildNodes()){for(var h=0;d.childNodes.length>h;h++)n(d.childNodes[h]),d.parentNode.insertBefore(d.childNodes[h].cloneNode(!0),d);d.parentNode.removeChild(d)}else d.parentNode.removeChild(d)}}return a.innerHTML}var r={font:[],span:["class","style",".font-weight",".font-size",".font-family",".font-style",".text-decoration"],div:["class","id","style",".width",".text-align"],a:["class","href","target","title","alt","name"],img:["class","id","src","alt","title","align","usemap","border","name","width","/"],hr:["/"],br:["/"],p:["class","align","style",".text-align",".padding-left",".margin-top",".margin-bottom",".line-height"],table:["class","style","width",".width","align","border","bordercolor","cellpadding",".margin",".margin-left",".margin-right"],tbody:[],tr:[],th:["class","align","colspan","rowspan","width"],td:["class","align","colspan","rowspan","width"],ol:["class","style",".text-align",".padding-left",".margin-top",".margin-bottom",".line-height"],ul:["class","style",".text-align",".padding-left",".margin-top",".margin-bottom",".line-height"],li:["class"],sub:["class"],sup:["class","name"],pre:["class","name"],blockquote:["style",".margin",".padding"],h2:[],h3:[],h4:[],h5:[],h6:[],em:[],strong:["style",".width"],b:[],i:[],u:[],strike:[],object:["classid","class","id","width","height","codebase"],embed:["style","src","type","loop","autostart","quality",".width",".height","flename","width","height","volume","pluginspage","console","controls","/"],param:["name","value"],map:["id","name"],area:["shape","coords","href","title","/"]},i=["onerror","onclick","onmouseout","onmouseover","onmousemove","align","color","font","height","vspace","hspace","id","class","style","left","right","name","rel","size","title","width","valign","bgcolor","dir"];e.addFilter({name:"cleanup",order:"first",type:["dom"],replace:function(e,t){n(t.body)}})}(jQuery.jQEditor,jQuery),function(e){var t=function(t,n){var r=e.utils.getNodeDom(n),i=r.dom;n=r.node;var a=t.getSelection(),o=0!==a.rangeCount?a.getRangeAt(0):" ",s=[];s=0>=navigator.userAgent.indexOf("MSIE")?i.createNodeIterator(n,NodeFilter.SHOW_ELEMENT):i.createNodeIterator(n,1);for(var l=s.nextNode();l;){var d=!1;e:for(;l.nextSibling&&l.tagName===l.nextSibling.tagName&&1===DTD.$font[l.tagName];){if("SPAN"===l.tagName){var c=l.style.cssText.split(";").length,u=l.nextSibling.style.cssText.split(";").length;if(c!==u)break e;for(var f=0;c>f;f++)if(l.nextSibling.style[l.style[f]]!==l.style[l.style[f]])break e}var m={},p={};if(o){m={container:o.startContainer,offset:o.startOffset},p={container:o.endContainer,offset:o.endOffset},o.startContainer.childNodes[o.startOffset]===l.nextSibling&&(o.setStartAfter(l),d=!0),o.endContainer.childNodes[o.endOffset]===l.nextSibling&&(o.setEndAfter(l),d=!0);var h=e.utils.nodeIndex(l.nextSibling);o.startContainer===l.parentNode&&o.startOffset>h&&(m.offset=h,d=!0),o.endContainer===l.parentNode&&o.endOffset>h&&(p.offset=h,d=!0)}var g=i.createRange(),b=i.createRange();g.selectNodeContents(l),g.collapse(!1),b.selectNodeContents(l.nextSibling);var v=b.extractContents();b.selectNode(l.nextSibling),b.deleteContents(),g.insertNode(v),o&&(o.setStart(m.container,m.offset),o.setEnd(p.container,p.offset),a.removeAllRanges(),a.addRange(o))}l=s.nextNode()}s=0>=navigator.userAgent.indexOf("MSIE")?i.createNodeIterator(n,NodeFilter.SHOW_TEXT):i.createNodeIterator(n,3);var y=!1;for(l=s.nextNode();l;){if(l.nextSibling&&3===l.nextSibling.nodeType)y=!0;else if(y===!0){for(var w=l.previousSibling;w&&3===w.nodeType;){var m={},p={},E="",d="";if(o){E=!1,d=!1,m={container:o.startContainer,offset:o.startOffset},p={container:o.endContainer,offset:o.endOffset};var h=e.utils.nodeIndex(w.nextSibling);if(o.startContainer===l.parentNode)o.startOffset>h&&(E="start",m.offset=o.startOffset-1,d=!0);else if(o.startContainer===w.nextSibling){var k=w.length;m.offset=k+o.startOffset,d=!0}else o.startContainer===w&&(m.container=w.nextSibling,d=!0);if(o.endContainer===l.parentNode)o.startOffset>h&&(E="end",p.offset=o.endOffset-1,d=!0);else if(o.endContainer===w.nextSibling){var k=w.length;p.offset=k+o.endOffset,d=!0}else o.endContainer===w&&(p.container=w.nextSibling,d=!0)}l.nodeValue=w.nodeValue+l.nodeValue;var C=w.previousSibling;w.parentNode.removeChild(w),w=C,o&&(o.setStart(m.container,m.offset),o.setEnd(p.container,p.offset),d===!0&&(a.removeAllRanges(),a.addRange(o)))}y=!1}l=s.nextNode()}};e.addFilter({name:"combine",type:["afterText","beforeInsert","afterInsert"],order:"second",replace:t})}(window.jQuery.jQEditor),function(e){function t(e){return e=e.replace(/<!--\[if gte mso [0-9]{1,2}\]>[\s\S]*?<!\[endif\]-->/gi,""),e=e.replace(/<style>[\s\S]*?mso[\s\S]*?<\/style>/gi,""),e=e.replace(/ lang=".+?"/gi,""),e=e.replace(/<o:p><\/o:p>/gi,""),e=e.replace(/ class="Mso.+?"/gi,""),e=e.replace(/ mso-spacerun: 'yes'/gi,"")}e.addFilter({name:"default",type:["html"],replace:function(e,n){return"string"==typeof n&&n?(n=n.replace(/^\s+/g,""),n=n.replace(/\s+$/g,""),n=n.replace(/>\s+</g,"><"),n=n.replace(/(<td[^>]*>)<\/td>/g,"$1&#8203;<br></td>"),n=n.replace(/<\/sup>(\s|&nbsp;)*/gi,"</sup> "),n=n.replace(/(\s|&nbsp;)*<sup/gi,"<sup"),n=n.replace(/<\/?textarea>/gi,""),n=n.replace(/<!--[\s\S]*?-->/gi,""),/http:\/\/www\.(hudong|baike)\.com\/editdocauth/i.test(location.href)&&(n=n.replace(/<\/?font[^>]*>/gi,"")),n=n.replace(/<(div|strong|span)[^>]*?>\s*<\/\1>/gi,""),n=n.replace(/<(span|font)>([^<]+)<\/\1>/gi,"$2"),n=n.replace(/<\??xml(:\w+)?(\s+[^>]*?)?>([\s\S]*?<\/xml>)?/gi,""),n=n.replace(/<\/?(html|head|body|meta|title|iframe|frame)(\s+[^>]*?)?>/gi,""),n=n.replace(/<link(\s+[^>]*?)?>/gi,""),n=n.replace(/<script(\s+[^>]*?)?>[\s\S]*?<\/script>/gi,""),n=n.replace(/(<\w+)(\s+[^>]*?)?\s+on(?:error|click|dblclick|mousedown|mouseup|mousemove|mouseover|mouseout|mouseenter|mouseleave|keydown|keypress|keyup|change|select|submit|reset|blur|focus|load|unload)\s*=\s*(["']?).*?\3((?:\s+[^>]*?)?\/?>)/gi,"$1$2$4"),n=n.replace(/<style(\s+[^>]*?)?>[\s\S]*?<\/style>/gi,""),n=n.replace(/<\/(strong|b|u|strike|em|i)>((?:\s|<br\/?>|&nbsp;)*?)<\1(\s+[^>]*?)?>/gi,"$2"),n=n.replace(/class=\"Apple-style-span\"/gi,""),n=n.replace(/ jquery\d+=\"?\d+\"?/gi," "),n=t(n)):n}})}(jQuery.jQEditor,jQuery),function(e,t){var n=function(e,n,r){t(r).find("ul,ol").each(function(){if(0===t(this).find("li").length)t(this).remove();else if(this.previousSibling&&this.previousSibling.nodeName===this.nodeName&&t(this.previousSibling).css("list-style-type")===t(this).css("list-style-type")){var e=this;t(this.previousSibling).find("li").each(function(){t(e).prepend(this)}),t(this.previousSibling).remove()}})},r=function(t,r){var i=e.utils.getNodeDom(r),a=i.dom;return r=i.node,n(t,a,r),r};e.addFilter({name:"list",type:["afterList"],replace:r})}(window.jQuery.jQEditor,window.jQuery),function(e){var t=function(e,t,n){n.style.cssText+=e+": "+t},n={B:{styleType:"STRONG",styleValue:void 0},I:{styleType:"EM",styleValue:void 0},U:{styleType:"text-decoration",styleValue:"underline"},DEL:{styleType:"text-decoration",styleValue:"line-through"}},r=function(e,n,r,i){var a=e.createElement("span");if(3===n.nodeType&&/\S/.test(n.nodeValue)){var o=e.createRange();o.selectNode(n),o.cloneRange(),"SPAN"===n.parentNode.tagName?t(r,i,n.parentNode):(t(r,i,a),o.surroundContents(a))}},i=function(t,i,a){if(3!==a.nodeType&&void 0!==n[a.tagName]){var o=n[a.tagName].styleType,s=n[a.tagName].styleValue;if(void 0===s){var l=i.createRange();l.selectNodeContents(a);var d=l.extractContents();l.selectNode(a),l.deleteContents(),l.insertNode(d);var c=i.createElement(o);l.surroundContents(c)}else{var u={};u=e.IE?i.createNodeIterator(a,3):i.createNodeIterator(a,NodeFilter.SHOW_TEXT);for(var f=u.nextNode(),m={};f;)m=u.nextNode(),r(i,f,o,s),f=m;var l=i.createRange();l.selectNodeContents(a);var d=l.extractContents();l.selectNode(a),l.deleteContents(),l.insertNode(d)}}},a=function(e,t,n){var r=n.firstChild;if(null!==r)for(var o={};null!==r;)o=r.nextSibling,a(e,t,r),i(e,t,r),r=o},o=function(t,n){var r=e.utils.getNodeDom(n),i=r.dom;n=r.node,a(t,i,n)};e.addFilter({name:"replace",type:["beforeInsert"],replace:o})}(window.jQuery.jQEditor),function(e){var t=function(t,n){var r=e.utils.getNodeDom(n),i=r.dom;n=r.node;var a=t.getSelection(),o=0!==a.rangeCount?a.getRangeAt(0):"",s="",l=!1,d=[];d=e.IE?i.createNodeIterator(n,3):i.createNodeIterator(n,NodeFilter.SHOW_TEXT);for(var c=d.nextNode(),u={};c;){u=d.nextNode();var f=/(^[ ]+$)/g,m=c.nodeValue.replace(f,"");if(f=/([\t\n\r])/g,m=c.nodeValue.replace(f,""),m!==c.nodeValue&&(c.nodeValue=m),!c.nodeValue)if(o&&o.startRange===c)s=c;else{var p=i.createRange();p.selectNode(c),p.deleteContents(),p.detach()}c=u}var h=[];h=e.IE?i.createNodeIterator(n,1):i.createNodeIterator(n,NodeFilter.SHOW_ELEMENT);var c=h.nextNode();for(l=!1;c;)if(u=h.nextNode(),1===DTD.$emptyInline[c.nodeName]||"A"===c.nodeName.toUpperCase()&&c.name)c=u;else{if(0==c.children.length&&0===c.innerText.length&&c!==s&&1!==DTD.$block[c.nodeName]&&"BODY"!==c.nodeName){var g=i.createRange();g.selectNode(c),o&&(c===o.startContainer&&(o.setStartBefore(c),l=!0),c===o.endContainer&&(o.setEndAfter(c),l=!0));for(var b=c.parentNode;b.firstChild===b.lastChild&&(1===DTD.$removeEmpty[b.tagName]||1===DTD.$removeEmptyBlock[b.tagName])&&"BODY"!==b.tagName;)g.selectNode(b),o&&(b===o.startContainer&&(o.setStartBefore(b),l=!0),b===o.endContainer&&(o.setEndAfter(b),l=!0)),b=b.parentNode;o&&l&&(a.removeAllRanges(),a.addRange(o)),g.deleteContents()}c=u}};e.addFilter({name:"space",type:["afterText","afterTextPre","beforeInsert","afterInsert"],order:"fourth",replace:t})}(window.jQuery.jQEditor),function(e,t){e.addFilter({name:"video",type:["dom"],replace:function(n,r){var i=e.curEditor.config.video_whiteList||["youku.com","tudou.com","iqiyi.com","qiyi.com","sohu.com","sina.com.cn","sina.com","qq.com","xunlei.com","ku6.com","56.com","cntv.cn","cctv.com","ifeng.com","baofeng.com","joy.cn","pps.tv","mtime.com","m1905.com","pptv.com","baidu.com","163.com"];if("object"==typeof r&&i instanceof Array){var a=i.slice(0),o=t("object,embed",r),s=null,l=!0,d="",c=null;a=a.join("|").toUpperCase().replace(/http:\/\//gi,"").replace(/\./g,"\\."),a="("+a+")$",s=RegExp(a,"i"),o.each(function(){c=t(this),d=c.attr("src"),d.length&&(d=d.replace("http://","").replace(/(\?|#)/g,"/").split("/"),d&&d.length>0&&s.test(d[0])&&(l=!1)),l&&c.remove(),l=!0})}}})}(jQuery.jQEditor,jQuery),function(e,t){var n=/^javascript:/i;e.addFilter({name:"xss",type:["dom"],replace:function(e,r){"object"==typeof r&&(t("a",r).each(function(){var e=t(this),r=e.attr("href");r&&(r=r.replace(/\s/g,""),n.test(r)&&e.replaceWith(e.html()))}),t("img",r).each(function(){var e=t(this),r=e.attr("src");r&&(r=r.replace(/\s/g,""),n.test(r)&&e.remove())}))}})}(jQuery.jQEditor,jQuery),function(e,t){function n(e){e&&(e.$toolbar=t("#"+e.Eid+" .bke-toolbar"),0===e.$toolbar.length&&(e.$toolbar=t("[ref="+e.Eid+"] .bke-toolbar")))}n.prototype={isShow:function(n){var r=t("#"+e.curId+" [cmd="+n+"]");return 0===r.length&&(r=t("[ref="+e.curId+"] .bke-toolbar  [cmd="+n+"]")),r.closest(".bke-btn").hasClass("bke-checked")},openPanel:function(n){var r=t("#"+e.curId+" [cmd="+n+"]");0===r.length&&(r=t("[ref="+e.curId+"] .bke-toolbar [cmd="+n+"]"));var i=r.closest(".bke-btn"),a=i.find(".bke-submenu");a.length&&i.addClass("bke-checked")},closePanel:function(n){var r=t("#"+e.curId+" [cmd="+n+"]");0===r.length&&(r=t("[ref="+e.curId+"] .bke-toolbar [cmd="+n+"]"));var i=r.closest(".bke-btn"),a=i.find(".bke-submenu");a.length&&i.removeClass("bke-checked")},fillPanel:function(e,n){var r=t("[cmd="+e+"]"),i=r.closest(".bke-btn"),a=i.find(".bke-submenu");a.length&&a.each(function(){var e=t(this);""===t.trim(e.html())&&e.html(n)})},clearPanel:function(e){var n=t("[cmd="+e+"]"),r=n.closest(".bke-btn"),i=r.find(".bke-submenu");i.length&&i.empty()},hidePanel:function(t){var n=e.curEditor.$toolbar.children(".bke-checked").has("div.bke-submenu");if(t){var r=e.curEditor.$toolbar.find("#icon-"+t),i=r.closest(".bke-btn");n=n.not(i)}n.removeClass("bke-checked")},togglePanel:function(e){this.isShow(e)?this.closePanel(e):this.openPanel(e)},disabledAll:function(n){n&&n instanceof Array||(n=[]);var r=[],i=e.curEditor.$toolbar;t.each(n,function(e,t){r.push("[cmd="+t+"]")}),i.children(".bke-btn").not(r.join(",")).addClass("bke-disabled")}};var r=new n;r.ready=!0,e.toolbar=r,e.Toolbar=n,e.IE6&&(t(document).delegate(".bke-btn","mouseover",function(){t(this).addClass("bke-clicked")}).delegate(".bke-btn","mouseleave",function(){t(this).removeClass("bke-clicked")}),t(document).delegate(".bke-menu-item","mouseover",function(){t(this).addClass("bke-menu-item-hover").children(".bke-menu-icon").addClass("bke-menu-icon-hover")}).delegate(".bke-menu-item","mouseleave",function(){t(this).removeClass("bke-menu-item-hover").children(".bke-menu-icon").removeClass("bke-menu-icon-hover")}))}(jQuery.jQEditor,jQuery),function(e){if(window.FileReader&&window.XMLHttpRequest){e.addUi({id:"ajaxuploaddialog",html:'<div class="bke-ajaxupload-progress"><div>文件上传中,请稍等...</div><span>10% ( 1.1MB / 2.0MB )</span><ol></ol></div>'}),e.addPlugin({id:"ajaxupload",title:"文件上传",ui:"ajaxuploaddialog",type:"dialog"}),/Chrome/i.test(navigator.userAgent)&&e.bind("ajaxupload-paste","paste",function(t){if(t){var n=t.event.originalEvent.clipboardData,r=n.items,i=r[0];if("file"==i.kind&&i.type.match(/^image\//i)){var a=i.getAsFile(),o=new FileReader;return o.onload=function(t){var n='<img src="'+t.target.result+'"/>';e.pasteHTML(n)},o.readAsDataURL(a),!1}}}),e.bind("ajaxupload-dragover","dragover",function(t){var n=e.curEditor.getSelectionText();if(!n){var r=e.plugin("dragimage");r&&r.mousedown||(t.event.stopPropagation(),t.event.preventDefault())}}),e.bind("ajaxupload-drop","drop",function(n){if(n.event.originalEvent.dataTransfer.files.length){var r=[],i=[],a=e.curEditor.config.cBase.ajaxupload,o=e.plugin("ajaxupload"),s={event:n.event,minsize:1048576,maxsize:10737418240,action:a.uploadUrl,inputName:"filedata",init:function(){o.click()},onprogress:function(e){var t=$("#ajaxuploaddialog").find(".bke-ajaxupload-progress span");t.text(e.totalPercent+"% ( "+e.completeCount+"/"+e.totalCount+" )")},callback:function(e,t){if("object"==typeof t)if(t.success)r.push({url:t.url,file:e});else{e.data=t,i.push(e);var n=t.msg||"未知错误";this.error(e,n)}},oncomplete:function(){var t=[];for(var n in r)r[n].file.type.match(/^image\//i)?t.push('<img src="'+r[n].url+'" style="max-width:600px;" />'):t.push('<a href="'+r[n].url+'" target="_blank">'+r[n].file.name+"</a>");e.curEditor.insert(t.join("")),i.length?setTimeout(function(){$("#ajaxuploaddialog").find(".bke-ajaxupload-progress div").html("")},500):setTimeout(function(){e.dialog.close()},1e3)},error:function(e,t){$("#ajaxuploaddialog").find(".bke-ajaxupload-progress ol").append("<li>"+e.name+" 上传失败，原因: "+t+"</li>")}};t.ondrop(s)}});var t={xhr:new XMLHttpRequest,Client:null,completeCount:0,totalCount:0,totalSize:0,completeSize:1,isUploading:!1,fileList:[],successFileList:[],failureFileList:[],init:function(e){if(!this.isUploading){var t=this;t.completeCount=1,t.fileList=e,t.successFileList=[],t.failureFileList=[],t.isUploading=!0,t.totalCount=e.length,t.start()}},ondrop:function(e){var t=this,n=e.event.originalEvent.dataTransfer,r=[],i=n.files;t.Client=e,e.event.stopPropagation(),e.event.preventDefault();for(var a=0,o=i.length;o>a;a++)i[a].size&&(r.push(i[a]),t.totalSize+=i[a].size);r.length&&(e.init(r),t.init(r))},start:function(){var e=this,t=e.fileList,n=t.shift();n?e.post(n):e.complete()},complete:function(){var e=this;e.Client.oncomplete(),e.isUploading=!1},callback:function(e,t){var n,r=this;r.completeCount+=1,r.completeSize+=e.size||e.fileSize;try{n=$.parseJSON(t)}catch(i){}r.Client.callback(e,n)},onprogress:function(e,t){var n=this;if(e&&e.loaded>=0){var r=t.size||t.fileSize,i=Math.round(100*e.loaded/r),a=Math.round(100*(e.loaded+n.completeSize)/n.totalSize),o={totalPercent:a,currentPercent:i,loaded:n.formatBytes(e.loaded),size:n.formatBytes(r),name:t.name||t.fileName,completeSize:n.formatBytes(e.loaded+n.completeSize),totalSize:n.formatBytes(n.totalSize),completeCount:n.completeCount,totalCount:n.totalCount};n.Client.onprogress(o)}},post:function(e){var t=this,n=t.xhr;n.onreadystatechange=function(){4===n.readyState&&(200==n.status?(t.successFileList.push(e),t.callback(e,n.responseText),t.start()):t.failureFileList.push(e))},n.upload?n.upload.onprogress=function(n){t.onprogress(n,e)}:t.onprogress(!1),n.open("POST",t.Client.action),n.setRequestHeader("Content-Type","application/octet-stream"),n.setRequestHeader("Content-Disposition",'attachment; name="'+t.Client.inputName+'"; filename="'+(e.name||e.fileName)+'"'),n.sendAsBinary?n.sendAsBinary(e.getAsBinary()):n.send(e)},formatBytes:function(e){var t=["Byte","KB","MB","GB","TB","PB"],n=Math.floor(Math.log(e)/Math.log(1024));return(e/Math.pow(1024,Math.floor(n))).toFixed(2)+t[n]}}}}(jQuery.jQEditor),function(e,t){function n(){function n(e){var n=e.config,r=t("#"+e.Eid).find(".bke-toolbar");0===r.length&&(r=t("[ref="+e.Eid+"] .bke-toolbar")),r.size()&&(n.toolbarTop=r.offset().top?r.offset().top:n.toolbarTop,r.parent().height(r.height()))}t.each(e.editorList,function(e,t){n(t)})}function r(e){var n=e.dom,r=0,i=n.createElement("DIV");i.style.clear="both",i.style.display="block",n.body.appendChild(i),r=Math.max(i.offsetTop+20,parseInt(e.config.editHeight,10)),n.body.removeChild(i);var a=t("#"+e.Eid);a.find("iframe").is(":visible")&&(a.find("iframe:visible").height(r),a.find(".bke-iframeholder").height(r)),a.find(".bke-iframeholder textarea").height(r)}function i(n){var r=t(window).scrollTop(),i=n.config,o=t("#"+n.Eid),s=o.find(".bke-toolbar"),l=0;0===s.length&&(s=t("[ref="+n.Eid+"] .bke-toolbar")),s.size()&&i.autoHeight&&(l=o.offset().top+o.height()-30,i.toolbarTop&&(i.toolbarTop>r||r>l)?(s.removeClass(i.fixedClassName),e.IE6&&(s[0].style.removeExpression("top"),s[0].style.position="static"),a=!1):(a||(s.width(s.width()).addClass(i.fixedClassName),e.IE6&&(s[0].style.setExpression("top",'eval(document.documentElement.scrollTop)+"px"'),s[0].style.position="absolute")),a=!0))}var a=!1;if(e.IE6&&"fixed"!==document.body.currentStyle.backgroundAttachment){var o=document.getElementsByTagName("html")[0];o.style.backgroundImage="url(about:blank)",o.style.backgroundAttachment="fixed"}e.addEvent({name:"autoHeight",type:["complete"],fn:function(){function n(i){return setTimeout(function(){t.each(e.editorList,function(e,t){t.config.autoHeight&&r(t)})},i),n}n(0)(300)(1e3)(2e3)(5e3)}}),e.addEvent({name:"autoHeight",type:["afterCommand","keyup"],fn:function(){e.curEditor.config.autoHeight&&r(e.curEditor)}}),t(window).scroll(function(){t.each(e.editorList,function(n,r){if(e.curEditor===r)i(r);else{var a=r.config,o=t("#"+r.Eid).find(".bke-toolbar");0===o.length&&(o=t("[ref="+r.Eid+"] .bke-toolbar")),o.removeClass(a.fixedClassName)}})}),e.addEvent({name:"setToolbarTop",type:["complete","active"],fn:function(){setTimeout(function(){n()},0)}});var s=0;t(window).resize(function(){clearTimeout(s),s=setTimeout(function(){n()},200)})}(jQuery.jQEditor,jQuery),function(e,t){function n(t,n){var r={name:"表格",icon:"bke-InsertTable",submenu:[{name:"删除表格",icon:"bke-RemoveTable",cmd:"deletetable"},{name:"-"},{name:"左插入列",icon:"bke-ColumnInsertBefore",cmd:"insertcolbefore"},{name:"右插入列",icon:"bke-ColumnInsertAfter",cmd:"insertcolafter"},{name:"上插入行",icon:"bke-RowInsertBefore",cmd:"insertrowbefore"},{name:"下插入行",icon:"bke-RowInsertAfter",cmd:"insertrowafter"},{name:"-"},{},{},{name:"-"},{name:"合并单元格",icon:"bke-CellCombine",cmd:"combinecells"},{name:"向下合并",icon:"bke-RowMergeAfter",cmd:"combinerowafter"},{name:"向右合并",icon:"bke-ColumnMergeAfter",cmd:"combinecolafter"},{name:"-"},{name:"表格属性",icon:"bke-TableProps",cmd:"tableprops"}]};r.submenu[7]=n.find("caption").length?{name:"删除表格名称",cmd:"tabletitle"}:{name:"插入表格名称",cmd:"tabletitle"},r.submenu[8]=n.find("th").length?{name:"删除表格标题行",cmd:"tablehead"}:{name:"插入表格标题行",cmd:"tablehead"},t.push(r),t.push({name:"单元格对齐方式",icon:"bke-JustifyFull",submenu:[{name:"居左",cmd:"celljustify",param:"4"},{name:"居中",cmd:"celljustify",param:"5"},{name:"居右",cmd:"celljustify",param:"6"},{name:"-"},{name:"居左（靠上）",cmd:"celljustify",param:"1"},{name:"居中（靠上）",cmd:"celljustify",param:"2"},{name:"居右（靠上）",cmd:"celljustify",param:"3"},{name:"-"},{name:"居左（靠下）",cmd:"celljustify",param:"7"},{name:"居中（靠下）",cmd:"celljustify",param:"8"},{name:"居右（靠下）",cmd:"celljustify",param:"9"}]},{name:"表格对齐方式",submenu:[{name:"左浮动",cmd:"tablefloat",param:"1"},{name:"居中",cmd:"tablefloat",param:"2"},{name:"右浮动",cmd:"tablefloat",param:"3"}]});var i={name:"单元格背景色",submenu:e.utils.execPlugin("colormenu","getCellcolorPicker")};return t.push(i),t}e.addEvent({name:"contextmenu",type:["contextmenu"],area:"editArea",fn:function(r){var i=e.plugin("shortcutmenu");if(!i||i.contextmenu()){var a=[];a.push({name:"全选",cmd:"selectall",icon:"bke-SelectAll"},{name:"清空文档",cmd:"cleardoc",icon:"bke-ClearDoc"},{name:"separator"});var o=t(r.target).closest("table");o.length?a=n(a,o):a.push({name:"段落格式",icon:"bke-JustifyFull",submenu:[{name:"左对齐",cmd:"justifyleft",icon:"bke-JustifyLeft"},{name:"右对齐",cmd:"justifyright",icon:"bke-JustifyRight"},{name:"居中对齐",cmd:"justifycenter",icon:"bke-JustifyCenter"},{name:"两端对齐",cmd:"justifyfull",icon:"bke-JustifyFull"}]},{name:"插入表格",icon:"bke-InsertTable",submenu:e.utils.execPlugin("tablemenu","getTablePanel")}),a.push({name:"separator"},{name:"段前插入段落",cmd:"insertparagraphbefore",param:""},{name:"段后插入段落",cmd:"insertparagraphafter",param:""},{name:"复制(Ctrl + c)",icon:"bke-Copy",cmd:"copy"},{name:"粘帖(Ctrl + v)",icon:"bke-Paste",cmd:"paste"},{name:"插入代码",icon:"bke-Code",cmd:"highlightcode"}),e.Menu.contextmenu(a,r),t(r.target).hasClass("selectCellClass")}}})}(jQuery.jQEditor,jQuery),function(e,t){e.addEvent({name:"cursorelements",type:["mousedown","keyup"],area:"editArea",fn:function(n){var r=n.target;if(t(r).is("body")){var i=e.utils.getCurElement();i.pop(),r=i.pop()}var a={},o=e.$(r),s=o.closest("h1,h2,h3,h4,h5,h6,h7"),l=o.closest("a"),d=o.closest("img"),c=o.closest("pre"),u=o.closest("sub"),f=o.closest("sup.refer"),m=o.closest("sup"),p=o.closest("td,th"),h=p.closest("tr"),g=h.closest("table"),b=o.closest("ol"),v=o.closest("ul"),y=o.closest("embed");s.length&&(a.hn=s[0]),l.length&&(a.a=l[0]),d.length&&(a.img=d[0]),c.length&&(a.pre=c[0]),u.length&&(a.sub=u[0]),f.length&&(a.refer=f[0]),m.length&&(a.sup=m[0]),p.length&&(a.cell=p[0]),h.length&&(a.row=h[0]),g.length&&(a.table=g[0]),b.length&&(a.ol=b[0]),v.length&&(a.ul=v[0]),y.length&&(a.embed=y[0]),e.curEditor.cursorElements=a}})}(jQuery.jQEditor,jQuery),function(e,t){function n(n){var r="html",i="",a=n.closest("[cmd]").attr("cmd"),o="";t.trim(n.text())?(i=n.text(),o=n.text()):o=e.getLang("labelMap."+a.toLowerCase())||n.text(),n.children().size()&&(r="prepend"),n[r]("<a href=\"javascript: void('"+a+'\')" title="'+o+'">'+i+"</a>")}e.addEvent({name:"commandHidePanel",type:["beforeCommand"],fn:function(t){var n=t.commandName;e.toolbar.hidePanel(n),e.curEditor.baseHistory&&"revert"!==n&&"redo"!==n&&"codemirror"!==n&&"source"!==n&&e.curEditor.baseHistory.prepareHistory()}}),e.addEvent({name:"recordHistory",type:["afterCommand"],fn:function(t){e.curEditor.baseHistory&&"revert"!==t.commandName&&"redo"!==t.commandName&&e.curEditor.baseHistory.recordHistory()}}),e.addEvent({name:"toolbarinit",type:["complete"],fn:function(r){e.editorList[r.Eid].config;var i=t('[ref="'+r.Eid+'"] .bke-toolbar');i.find(".bke-icon, .bke-caret").each(function(){n(t(this))}),i.find("div[cmd],span[cmd]").each(function(){var e=t(this),n=e.attr("cmd");e.attr("id","icon-"+n)}),i.find(".bke-text").each(function(){var e=t(this);e.find(".bke-caret").size()?e.find(".bke-caret").prev().each(function(){n(t(this))}):n(e)})}})}(jQuery.jQEditor,jQuery),function(e,t){t(".bke-dialog").live("click",function(n){var r=t(n.target),i=r.attr("cmd"),a=r.attr("param"),o=r.closest(".bke-dialog").attr("id");return r.attr("cmd")?(e.command(o,i,a),!1):void 0})}(window.jQuery.jQEditor,window.jQuery),function(e,t){function n(){var n=e.$("img");n.each(function(){var e=t(this);e.attr("id","img-"+a),e.closest("div.img").attr("id","wrap-img-"+a),a+=1})}function r(t){var n=t.closest("div.img"),r=t.attr("id");n.length||(e.$("#wrap-"+r).hide(),e.curEditor.baseHistory.prepareHistory(),setTimeout(function(){var t=e.$("#"+r),n=e.$("#wrap-"+r);t.parent().is("a")?(t.parent().after(n),n.prepend(t.parent())):(t.after(n),n.prepend(t)),n.show(),e.curEditor.baseHistory.recordHistory(1),e.trigger("mouseup")},0))}e.addPlugin({id:"dragimage",mousedown:!1});var i,a=0;e.addEvent({name:"dragimage-mousedown",type:["mousedown"],area:"editArea",fn:function(t){"img"===t.target.nodeName.toLowerCase()?(i=t.target,e.plugin("dragimage").mousedown=!0,/MSIE [678]\.0/i.test(navigator.userAgent)&&e.$(i).unbind("dragend").bind("dragend",function(){r(e.$(this))})):i=null}}),e.bind("dragimage-mouseup","mouseup",function(){e.plugin("dragimage").mousedown=!1}),e.addEvent({name:"dragimage-dragend",type:["dragend"],area:"editArea",fn:function(){i&&r(e.$(i))}}),e.addEvent({name:"dragimage-complete",type:["complete"],fn:function(){n()}})}(jQuery.jQEditor,jQuery),function(e,t){function n(t,n,r){e.IE&&/paste/i.test(n)&&(t=t.find("body")),t.bind(n,function(t){return e.trigger(n,{targetElement:t.target,target:t.target,event:t,targetEditor:r})})}var r="click,mousedown,mouseup,mouseenter,mouseleave,scroll,keypress,keyup,keydown,paste,beforepaste,dragenter,dragover,drop,dragleave,dragend".split(",");
e.listenEditarea=function(i){var a=t(i.dom);a.bind("contextmenu",function(t){return t.ctrlKey||t.shiftKey||t.altKey?!0:(e.trigger("contextmenu",{targetElement:t.target,target:t.target,clientX:t.clientX,clientY:t.clientY,targetEditor:i}),!1)});for(var o=0,s=r.length;s>o;o++){var l=t.trim(r[o]);n(a,l,i)}var d=e.IE?"beforepaste":"paste";a.find("body").bind(d,function(){e.utils.execPlugin("paste","paste")}),a.find("body").bind("beforecopy",function(){a.find("body").unbind(d),setTimeout(function(){a.find("body").bind(d,function(){e.utils.execPlugin("paste","paste")})},0),e.IE&&e.errorMessage("请使用 Ctrl+v 进行粘贴")}),a.bind("keydown",function(t){if(t.shiftKey&&13===t.which);else if(t.ctrlKey&&13===t.which);else if(t.ctrlKey&&67===t.which);else if(t.ctrlKey&&86===t.which);else if(t.ctrlKey&&88===t.which);else{if(t.ctrlKey&&66===t.which)return e.command("bold"),!1;if(t.ctrlKey&&73===t.which)return e.command("italic"),!1;if(t.ctrlKey&&85===t.which)return e.command("underline"),!1;if(t.ctrlKey&&90===t.which)return e.command("undo"),!1;if(t.ctrlKey&&89===t.which)return e.command("redo"),!1;if(t.ctrlKey&&65===t.which)return e.curEditor.selectAll(),!1;if(t.ctrlKey&&70===t.which)return e.command("search"),!1;if(t.ctrlKey&&72===t.which)return e.command("replace"),!1;if(t.ctrlKey&&83===t.which)return alert(11),!1;13===t.which?(e.curEditor.baseHistory.prepareHistory(),setTimeout(function(){e.curEditor.baseHistory.recordHistory()},0)):8===t.which||46===t.which}setTimeout(function(){var t=+new Date;t-i.baseHistory.getLastTime()>3e3&&(e.curEditor.baseHistory.prepareHistory(),e.curEditor.baseHistory.recordHistory())},0)}),a.bind("mouseenter",function(){e.curId!==i.Eid&&(e.curId=i.Eid,e.curEditor=i,e.trigger("active",{editor:i}))}).bind("mousedown",function(){a.bind("mousemove.drag",function(t){e.trigger("drag",{targetElement:t,targetEditor:i})})}).bind("mouseup",function(){a.unbind("mousemove.drag")})},e.addEvent({name:"editareaHidePanel",type:["mousedown","keydown"],area:"editArea",fn:function(){e.toolbar.hidePanel()}}),/AppleWebKit/i.test(navigator.userAgent)&&e.addEvent({name:"selectimg",type:["mousedown"],area:"editArea",fn:function(t){"img"===t.target.nodeName.toLowerCase()&&e.utils.selectNode(e.curEditor.win,t.target)}})}(window.jQuery.jQEditor,window.jQuery),function(e,t){function n(n,r){var i=e.pluginList.table,a=t(n).find("tr").length-1,o=t(n).find("tr:first").find("th,td").length-1,s=r.colStart,l=r.colEnd,d=r.rowStart,c=r.rowEnd;e:for(;;){var u={},f={},m={};if(s>0){for(var p=d;c>=p;p++)if(u=t(n).find("[col="+s+"][row="+p+"]"),m=i._rowInfo(u),0>m.isInRow){if(m.lastColspan>1&&m.isInRow+m.lastColspan>0){s-=1;continue e}}else if(f=i._colInfo(u),f.isInCol>=0){s-=1;continue e}}else s=0;if(d>0){for(var h=s;l>=h;h++)if(u=t(n).find("[row="+d+"][col="+h+"]"),f=i._colInfo(u),0>f.isIncol){if(f.lastRowspan>1&&f.isIncol+f.lastRowspan>0){d-=1;continue e}}else if(m=i._rowInfo(u),m.isInRow>=0){d-=1;continue e}}else d=0;if(o>l){for(var p=d;c>=p;p++)if(u=t(n).find("[col="+l+"][row="+p+"]"),m=i._rowInfo(u),0>m.isInRow&&m.lastColspan>1&&-1>m.isInRow){l+=1;continue e}}else l=o;if(a>c){for(var h=s;l>=h;h++)if(u=t(n).find("[row="+c+"][col="+h+"]"),f=i._colInfo(u),0>f.isInCol&&f.lastRowspan>1&&-1>f.isInCol){c+=1;continue e}}else c=a;break e}return{colStart:s,colEnd:l,rowStart:d,rowEnd:c}}function r(e){var n=e.target,r=t(n).closest("table"),a=t(n).closest("body"),o=e.offsetX,s=n.offsetWidth,l=e.offsetY,d=n.offsetHeight;if(r.unbind("mousedown.dragLine"),4>o)a.css("cursor","col-resize"),i(r,{leftTd:t(n).prev("td").not(":hidden")[0],rightTd:n},!1);else if(4>s-o)a.css("cursor","col-resize"),i(r,{leftTd:n,rightTd:t(n).next("td").not(":hidden")[0]},!1);else if(4>l){a.css("cursor","row-resize");var c=parseInt(t(n).attr("col")),u=t(n.parentNode).prev("tr").length?t(n.parentNode).prev("tr").find("td").eq(c).not(":hidden")[0]:void 0;i(r,{topTd:u,bottomTd:n},!0)}else if(4>d-l){a.css("cursor","row-resize");var f=t(n.parentNode).next("tr").length?t(n.parentNode).next("tr").find("td").eq(c).not(":hidden")[0]:void 0;i(r,{topTd:n,bottomTd:f},!0)}else a.css("cursor","default"),r.unbind("mousedown.dragLine")}function i(n,i,o){var s=t(n).closest("body");return void 0===i.topTd&&o===!0?0:void 0===i.leftTd&&o===!1?0:(t(n).bind("mousedown.dragLine",function(l){t(n).find("td").unbind("mousemove.cursorState");var d=l.clientX,c=l.clientY;t(n).parent().append("<div></div>");var u=t(n).parent().children(":last");u.css("position","absolute"),u.css("display","block"),u.css("width","1px"),u.css("height","1px"),u.css("z-index","11"),o===!0?u.width(t(n).find("tbody").width()):u.height(t(n).find("tbody").height());var f=t(n).offset().top,m=t(n).offset().left;o===!0?f+=t(i.topTd)[0].offsetTop+t(i.topTd)[0].offsetHeight:m+=t(i.leftTd)[0].offsetLeft+t(i.leftTd)[0].offsetWidth,u.css("top",f),u.css("left",m),u.css("background-color","green"),t(s).bind("mousemove.changeCell",function(n){e.utils.removeSelection(e.curEditor.win);var r=n.clientX,a=n.clientY;o?a-c+t(i.topTd)[0].offsetHeight>45&&u.css("top",f+a-c):r-d+t(i.leftTd)[0].offsetWidth>45&&(!i.rightTd||t(i.rightTd)[0].offsetWidth-(r-d)>45)&&u.css("left",m+r-d),e.utils.removeSelection(e.curEditor.win)}).bind("mouseup.changeCell",function(l){var f=l.clientX,m=l.clientY,p=0;p=o?m-c+t(i.topTd)[0].offsetHeight>45?m-c:45-t(i.topTd)[0].offsetHeight:f-d+t(i.leftTd)[0].offsetWidth>45&&(!i.rightTd||t(i.rightTd)[0].offsetWidth-(f-d)>45)?f-d:f-d+t(i.leftTd)[0].offsetWidth>45?t(i.rightTd)[0].offsetWidth-45:45-t(i.leftTd)[0].offsetWidth,a(i,p,o),e.utils.removeSelection(e.curEditor.win),t(n).find("td").bind("mousemove.cursorState",function(e){r(e)}),u.remove(),t(n).unbind("mousedown.dragLine"),s.unbind("mousemove.changeCell"),s.unbind("mouseup.changeCell")})}),void 0)}function a(e,n,r){if(r){var i=t(e.topTd).attr("rowspan")?parseInt(t(e.topTd).attr("rowspan")):1,a=parseInt(t(e.topTd).attr("row"))+i,o=[];t(e.topTd).closest("table").find("td:visible,th:visible").each(function(){var e=t(this).attr("rowspan")?parseInt(t(this).attr("rowspan")):1;if(parseInt(t(this).attr("row"))+e===a){var r=parseFloat(t(this).height());o.push({cell:t(this),height:r+n})}});for(var s=o.length,l=0;s>l;l++)o[l].cell.height(o[l].height)}else{var d=t(e.leftTd).attr("colspan")?parseInt(t(e.leftTd).attr("colspan")):1,o=[],c=parseInt(t(e.leftTd).attr("col"))+d;t(e.leftTd).closest("table").find("td:visible,th:visible").each(function(){var e=t(this).attr("colspan")?parseInt(t(this).attr("colspan")):1;if(parseInt(t(this).attr("col"))+e===c){var r=parseFloat(t(this).width()),i=parseFloat(t(this).next("td,th").width());o.push({cell:t(this),width:r+n}),t(this).next("td,th").length&&o.push({cell:t(this).next("td,th"),width:i-n});var a=parseFloat(t(this).closest("table").width())+n>760?760:parseFloat(t(this).closest("table").width())+n;t(this).next("td,th").length||o.push({cell:t(this).closest("table"),width:a})}});for(var s=o.length,l=0;s>l;l++)o[l].cell.width(o[l].width)}}e.listenEditareaExt=function(i){var a=t(i.dom),o=e.config.selectTableClass,s=e.config.selectCellClass;a.delegate("td,th","mousedown",function(r){e.utils.execPlugin("table","freshTableIndex",t(r.target).closest("table"));var i=a.find("body").css("cursor");if("row-resize"===i||"col-resize"===i)return!0;if(1===r.which){var o={col_1:t(r.target).attr("col"),row_1:t(r.target).attr("row")},l=t(r.target).closest("table").find("th,td");l.not(t(r.target)).bind("mousemove.selectCell",function(r){var i=t(r.target),a=i.closest("table");e.utils.removeSelection(e.curEditor.win),l.removeClass(s),o.col_2=i.attr("col"),o.row_2=i.attr("row");var d=Math.max(o.col_1,o.col_2),c=Math.min(o.col_1,o.col_2),u=Math.max(o.row_1,o.row_2),f=Math.min(o.row_1,o.row_2),m=n(a,{colStart:c,colEnd:d,rowStart:f,rowEnd:u});d=m.colEnd,c=m.colStart,u=m.rowEnd,f=m.rowStart;var p=a.find("tr:not(:gt("+u+"),:lt("+f+"))"),h=t();p.each(function(){h=h.add(t(this).find("td,th").not(":gt("+d+"),:lt("+c+")"))}),h.addClass(s),e.utils.removeSelection(e.curEditor.win)}),l.bind("mouseenter",function(){l.removeClass(s),"None"===e.curEditor.win.getSelection().type?l.unbind("mouseenter mousemove.selectCell"):e.utils.setCursor(e.curEditor.win,r.target,!0)}).bind("mouseup",function(){l.unbind("mouseenter")})}}),a.delegate("body","mousedown",function(e){if(1===e.which){var n=t(this);n.find("table").removeClass(o),n.find("td,th").removeClass(s)}}).delegate("body","mouseup",function(){t(this).find("td,th").unbind("mouseenter mousemove.selectCell mouseup")});var l=0;a.delegate("table","mouseenter",function(){clearTimeout(l);var e=t(this),n=e.offset();t(".bke-selecttablebar").data("table",e).css({top:n.top-20,left:n.left-20}).show()}).delegate("table","mouseleave",function(){a.find("body").css("cursor","default"),clearTimeout(l),l=setTimeout(function(){t(".bke-selecttablebar").hide()},200)}),t("#"+i.Eid).delegate(".bke-selecttablebar","click",function(){var e=t(this).data("table");return e.find("td,th").removeClass(s),e.toggleClass(o),!1}).delegate(".bke-selecttablebar","mouseenter",function(){clearTimeout(l)}).delegate(".bke-selecttablebar","mouseleave",function(){clearTimeout(l),l=setTimeout(function(){t(".bke-selecttablebar").hide()},200)}),a.delegate("td","mousemove.cursorState",function(e){r(e)})}}(window.jQuery.jQEditor,window.jQuery),function(e){e.addEvent({name:"readyLog",type:["ready"],fn:function(){return e.log.writeLog("Core is ready","core"),!1}}),e.addEvent({name:"createLog",type:["create"],fn:function(t){return e.log.writeLog("Editor "+t.Eid+" is creating","core"),!1}}),e.addEvent({name:"completeLog",type:["complete"],fn:function(t){return e.log.writeLog("Editor "+t.Eid+" is completed","core"),!1}})}(window.jQuery.jQEditor),function(e,t){var n=t(document);n.bind("click",function(n){var r=t(n.target);r.closest(".bke-btn").size()||e.toolbar.hidePanel()}),n.delegate(".bke-toolbar","mousedown",function(n){var r=t(n.target).closest(".bke-toolbarbox").attr("ref");return e.curId=r,e.curEditor=e.editorList[r],e.curEditor.win.focus(),!1}),n.delegate(".bke-toolbar","click",function(n){var r=t(n.target).closest("[cmd]");if(r.closest(".bke-disabled").length)return!0;if(r.length){var i=r.attr("cmd"),a=r.attr("param"),o=r.attr("args");return e.command(i,a,o),!1}}),n.delegate(".bke-submenu [cmd]","click",function(){e.toolbar.hidePanel()})}(jQuery.jQEditor,jQuery),function(e,t){e.addEvent({name:"elementpath",type:["mouseup"],area:"editArea",fn:function(){for(var n=t("#"+e.curId+" .bke-elementpath"),r=e.utils.getCurElement(),i=[],a=0,o=r.length;o>a;a++)3!==r[a].nodeType&&i.push("<a>"+r[a].nodeName.toLowerCase()+"</a>");n.html("元素路径："+i.join("&gt;"))}})}(jQuery.jQEditor,jQuery),function(e,t){var n=[{name:"宋体",cmd:"fontfamily",param:"SimSun",styleName:"bke-SimSun"},{name:"仿宋体",cmd:"fontfamily",param:"FangSong_GB2312",styleName:"bke-FangSong_GB2312"},{name:"微软雅黑",cmd:"fontfamily",param:"Microsoft YaHei",styleName:"bke-Microsoft_YaHei"},{name:"黑体",cmd:"fontfamily",param:"SimHei",styleName:"bke-SimHei"},{name:"楷体",cmd:"fontfamily",param:"KaiTi_GB2312",styleName:"bke-KaiTi_GB2312"},{name:"Impact",cmd:"fontfamily",param:"Impact",styleName:"bke-Impact"},{name:"Georgia",cmd:"fontfamily",param:"Georgia",styleName:"bke-Georgia"},{name:"Arial",cmd:"fontfamily",param:"Arial",styleName:"bke-Arial"},{name:"Verdana",cmd:"fontfamily",param:"Verdana",styleName:"bke-Verdana"},{name:"Tahoma",cmd:"fontfamily",param:"Tahoma",styleName:"bke-Tahoma"}];e.addPlugin({id:"fontfamilymenu",type:"panel",isEnable:!0,fill:function(t){var r=e.Menu.create(n);e.fillPanel("fontfamilymenu",r,t)},echo:function(e,r){r=r.replace(/'/g,"")||"",r=r.toLowerCase(),t.each(n,function(t,n){return n.param.toLowerCase()===r?(e.find("#icon-fontfamilymenu").find(".bke-Font a").html(n.name),!1):void 0})}})}(jQuery.jQEditor,jQuery),function(e,t){function n(){for(var n={},r={},a={},o=e.utils.getCurElement(),s=o.length,d="",c=0;s>c;c++){var u=o[c].nodeName.toLowerCase();if(r[u]=!0,t(o[c]).attr("style"))for(var f=t(o[c]).attr("style").split(";"),m=f.length,p=0;m>p;p++){var h=f[p].split(":");"string"==typeof h[1]&&(h[0]=h[0].replace(/^[ ]+/g,""),a[h[0]]=h[1].replace(/^[ ]+/g,""))}}for(d in i.customChecked){var g=i.customChecked[d].tag,b=i.customChecked[d].style;n[d]=g&&r[g]===!0?"_on":b&&a[b]===i.customChecked[d].value?"_on":"_off","_off"===n.justifycenter&&"_off"===n.justifyright&&(n.justifyleft="_on")}for(d in i.customValue){var b=i.customValue[d].style;n[d]=b&&a[b]?a[b]:i.customValue[d].state}for(d in i.browserChecked)n[d]=e.curEditor.dom.queryCommandState(d)===!0?"_on":"_off";for(d in i.browserValue)if(e.curEditor.dom.queryCommandValue(d)){if(n[d]=e.curEditor.dom.queryCommandValue(d),"ForeColor"===d||"BackColor"===d){var v=/[0-9]+/g,y=n[d].match(v);n[d]="#";for(var c=0;y.length>c;c++){var w=parseInt(y[c],16);128>w&&(n[d]+="0"),n[d]+=w}}}else n[d]=i.browserValue[d].state;var E=t(e.curEditor.dom).find("table."+e.curEditor.config.selectTableClass).length,k=t(e.curEditor.dom).find("td."+e.curEditor.config.selectCellClass,"th."+e.curEditor.config.selectCellClass).length;for(d in i.tableChecked)if(n[d]="_freeze",0!==E)l.tableSelect[d]!==void 0&&(n[d]=l.tableSelect[d]);else if(0!==k)l.cellSelect[d]!==void 0&&(n[d]=l.cellSelect[d]);else if(r.td===!0||r.th===!0){if(l.cellIn[d]!==void 0&&(n[d]=l.cellIn[d]),"_split"===n[d]){var C=t(e.utils.getCurElement().pop()).closest("td,th");n[d]="_freeze",C.attr("colspan")&&parseInt(C.attr("colspan"))>1&&(n.splittocols="_off",n.splittocells="_off"),C.attr("rowspan")&&parseInt(C.attr("rowspan"))>1&&(n.splittorows="_off",n.splittocells="_off")}"_combine"===n[d]&&(n[d]="_freeze",e.utils.execPlugin("table","combineRowAfter",!0)&&(n.combinerowafter="_off"),e.utils.execPlugin("table","combineColAfter",!0)&&(n.combinecolafter="_off"))}else l.tableOut[d]!==void 0&&(n[d]=l.tableOut[d]);var T=e.curEditor.baseHistory;T&&(n.redo=T.redoState?"_off":"_freeze",n.undo=T.revertState?"_off":"_freeze"),e.curEditor.pasteToText===!0&&(n.pastetotext="_on"),e.pluginList.font&&(n.formatmatch=e.pluginList.font.brushOn[e.curId]?"_on":"_off"),e.curEditor.cursorElements&&t.each(["hn","table","a","sub","sup","pre"],function(r,i){e.curEditor.cursorElements[i]&&t.each(e.curEditor.config.cTagDisable[i],function(e,t){n[t]="_freeze"})});var x=e.curEditor.$toolbar;if(e.curEditor.isShowSource)return x.children(".bke-btn").not("[cmd=codemirror],[cmd=about],[cmd=fullscreen]").addClass("bke-disabled"),void 0;x.children(".bke-btn").not(":has(div.bke-submenu)").removeClass("bke-checked"),x.children(".bke-btn").removeClass("bke-disabled");for(d in n)if("_on"===n[d])x.find("#icon-"+d).closest(".bke-btn").addClass("bke-checked");else if("_freeze"===n[d])x.find("#icon-"+d).closest(".bke-btn").addClass("bke-disabled");else if("_off"===n[d]);else if("backcolor"===d||"forecolor"===d)x.find("#icon-"+d).find("i").css("backgroundColor",n[d]);else if("fontsize"===d||"fontfamily"===d){var N=e.plugin(d+"menu");N&&"function"==typeof N.echo&&N.echo(x,n[d])}}var r=e.config.cCommand,i={browserChecked:{},customChecked:{},browserValue:{},customValue:{},tableChecked:{}};for(var a in r)for(var o in r[a]){var s=r[a][o];""!==s.icon&&(i[s.icon][o]="customChecked"===s.icon||"browserChecked"===s.icon?""===s.param?{tag:s.cmd,state:"_off"}:"pluginCommand"===a?{tag:s.param,state:"_off"}:{style:s.cmd,value:s.param,state:"_off"}:{style:s.cmd,value:s.param,state:"_off"})}var l={tableSelect:{tableprops:"_off",deletetable:"_off"},cellSelect:{cellcolor:"_off",cellcolormenu:"_off",insertcolbefore:"_off",insertcolafter:"_off",insertrowbefore:"_off",insertrowafter:"_off",deletecol:"_off",deleterow:"_off",combinecells:"_off",tableprops:"_off",deletetable:"_off"},cellIn:{cellcolor:"_off",cellcolormenu:"_off",deletecol:"_off",deleterow:"_off",splittocols:"_split",splittorows:"_split",splittocells:"_split",combinecolafter:"_combine",combinerowafter:"_combine",insertcolbefore:"_off",insertcolafter:"_off",insertrowbefore:"_off",insertrowafter:"_off",tableprops:"_off",deletetable:"_off"},tableOut:{inserttable:"_off",inserttablemenu:"_off"}};e.addEvent({name:"iconstate",type:["mouseup","keyup","afterCommand"],area:"editArea",fn:function(){n()}})}(jQuery.jQEditor,jQuery),function(e,t){e.addPlugin({id:"paste",isEnable:!0,click:function(){window.clipboardData?e.curEditor.dom.execCommand("paste"):e.errorMessage("请使用 Ctrl+v 进行粘贴")},cut:function(){e.IE?e.curEditor.dom.execCommand("cut"):e.errorMessage("请使用 Ctrl+x 进行剪切")},copy:function(){e.IE?e.curEditor.dom.execCommand("copy"):e.errorMessage("请使用 Ctrl+c 进行复制")},paste:function(){return e.utils.getBoardContent(e.curEditor,function(n){var r="";r=e.curEditor.isPastetotext?t(n).text():e.utils.filterInner(e.curEditor,n.innerHTML),e.command("insert",r)}),e.IE?!1:void 0},toggleTextpaste:function(){var t=e.curEditor.isPastetotext=!e.curEditor.isPastetotext;this.clicked(t,"pastetotext")}})}(window.jQuery.jQEditor,window.jQuery),function(e){e.addPlugin({id:"redo",isEnable:!0,click:function(){e.curEditor.baseHistory.redo()}})}(window.jQuery.jQEditor),function(e){e.addPlugin({id:"revert",isEnable:!0,click:function(){e.curEditor.baseHistory.revert()}})}(window.jQuery.jQEditor),function(e){e.addPlugin({id:"selectall",title:"清空文档",isEnable:!0,click:function(){e.curEditor.selectAll()}})}(jQuery.jQEditor,jQuery),function(e,t){function n(n,r){var i=document.createElement("div"),a=document.createElement("table");t(a).addClass("bke-plugin-table");for(var o=0;n>o;o++){t(a).append("<tr></tr>");for(var s=0;r>s;s++){var l=t(a).find("tr:eq("+o+")");l.append('<td args="'+(o+1)+"-"+(s+1)+'" cmd="inserttable" param="insert"><a></a></td>')}}return e.Menu.create([{name:"插入表格",cmd:"inserttable",param:"showDialog"}]),t(i).append('<div class="bke-info">0行 0列</div>'),t(i).append(a),i.innerHTML}e.addPlugin({id:"tablemenu",type:"panel",isEnable:!0,fill:function(){e.fillPanel("inserttablemenu",n(10,10)),t(document).delegate(".bke-plugin-table td","mouseenter",function(e){var n=t(e.target).closest("td[args]").attr("args").split("-"),r=parseInt(n[0]),i=parseInt(n[1]),a=t(e.target).closest(".bke-plugin-table");a.parent().children(".bke-info").text(n[0]+"行 "+n[1]+"列"),a.find("td").removeClass("cell-hover"),a.find("tr:lt("+r+")").find("td:lt("+i+")").addClass("cell-hover")}).delegate(".bke-plugin-table","mouseleave",function(e){var n=t(e.target).closest(".bke-plugin-table");n.parent().children(".bke-info").text("0行 0列"),n.find("td").removeClass("cell-hover")})},getTablePanel:function(){return n(10,10)}})}(jQuery.jQEditor,jQuery),function(e){e.addUi({id:"aboutdialog",html:'<p><strong style="color:blue;">version</strong> : '+e.config.version+"</p>"+'<p style="text-indent:2em;">编辑器正处于开发阶段，欢迎各种意见及建议</p>'+'<p><strong style="color:blue;">快捷键</strong></p>'+'<p style="text-indent:2em;">1,	ctrl+a : 全选</p>'+'<p style="text-indent:2em;">2,	ctrl+c : 复制</p>'+'<p style="text-indent:2em;">3,	ctrl+x : 剪切</p>'+'<p style="text-indent:2em;">4,	ctrl+v : 粘贴</p>'+'<p style="text-indent:2em;">5,	ctrl+z : 撤销</p>'+'<p style="text-indent:2em;">6,	ctrl+y : 重做</p>'+'<p style="text-indent:2em;">7,	ctrl+s : 保存</p>'+'<p style="text-indent:2em;">8,	ctrl+b : 加粗</p>'+'<p style="text-indent:2em;">9,	ctrl+i : 斜体</p>'+'<p style="text-indent:2em;">10,ctrl+u : 下划线</p>'}),e.addPlugin({id:"about",title:"关于",ui:"aboutdialog",type:"dialog"})}(jQuery.jQEditor,jQuery),function(e,t){e.addUi({id:"anchordialog",html:'<div style="width:350px;padding:10px;">锚点名称：<input name="name" style="width:200px;height:20px;"/></div>',submit:function(){var e=t("#anchordialog").find("input[name=name]").val();return e=t.trim(e),e?'<img name="'+e+'" title="'+e+'" class="bke-anchor"/>':void 0}}),e.addPlugin({id:"anchor",title:"锚点",ui:"anchordialog",type:"dialog"})}(jQuery.jQEditor,jQuery),function(e,t){function n(e){e.children().eq(0).size()&&(e=e.children().eq(0),e.html(e.html().replace(i,"")),n(e))}function r(e){for(var r,a=t("body",e)[0].childNodes,o=0,s=a.length;s>o;o++)if(r=a[o],1===r.nodeType){var l=t(r);/^(p|h2|h3)$/i.test(r.nodeName)&&(l.html(l.html().replace(i,"a")),n(l))}}var i=/^(\s|&nbsp;|　)+/i;e.addPlugin({id:"autoformat",click:function(){r(e.curEditor.dom)}})}(jQuery.jQEditor,jQuery),function(e){e.addPlugin({id:"baikelink",isEnable:!0,linkName:"baikelink",click:function(){var t=this,n="http://www.baike.com/wiki/",r="",i=e.utils.getSelectionText();return i?i.length>80?e.errorMessage("百科链接，不能选择超过80个字符的长度！"):/[`~!\\\/]/.test(i)?e.errorMessage("百科链接，不能包含特殊字符“`~!/”！"):(r='<a href="'+n+encodeURIComponent(i)+'" class="'+t.linkName+'" title="'+i+'" target="_blank">'+i+"</a>",e.utils.pasteHTML(r)):e.errorMessage("请选择需要设置为百科链接的文字！"),1}})}(jQuery.jQEditor),function(e,t){e.addPlugin({id:"blockquote",title:"引用",click:function(){var n=e.curEditor,r=e.utils.getSelectionRange(n.win,"node"),i=null,a=null,o=null;i=t(r.startContainer).parents().get(),i.pop(),i.pop(),a=i.pop(),i=t(r.endContainer).parents().get(),i.pop(),i.pop(),o=i.pop();var s=t(a);if(a===o)s.is("blockquote")?s.after(s.children()).remove():s.wrap("<blockquote></blockquote>");else{var l=n.dom.createElement("blockquote");s.before(l),s.nextAll().each(function(){return t(l).append(this),o===this?!1:void 0}),t(l).prepend(a)}e.utils.setSelectionRange(n.win,r,"node")}})}(jQuery.jQEditor,jQuery),function(e,t){e.addPlugin({id:"cleardoc",title:"清空文档",isEnable:!0,click:function(){if(confirm("确定要删除当前所有内容吗？")){var n=e.get("body"),r=e.get("editor"),i=r.dom.createElement("p");i.innerHTML="&#8203;",t(n).empty().append(i),e.utils.setCursor(r.win,i,!0)}}})}(jQuery.jQEditor,jQuery),function(e,t){function n(n){n=n.replace(/\n+/g,"");var r=t("<div></div>").append(n),i=null;r.children().each(function(){try{i=t(this),i.after("\n\n")}catch(e){}});var a=r.find("table");return a.size()&&a.find("tr,td,th").after("\n").before("\n"),n=r.html(),n=n.replace(/\n{3,}/g,"\n\n"),n=n.replace(/<BR>/gi,"<br>\n"),n=n.replace(/<.+?>/gi,function(e){return e=e.replace(/COLOR:/g,"color:"),e=e.replace(/rgb\(\d+,(?: |&nbsp;)?\d+,(?: |&nbsp;)?\d+\)/gi,function(e){return Utils.colorToHex(e)})}),e.IE&&(n=n.replace(/<(\w+)/gi,function(e,t){return"<"+t.toLowerCase()}),n=n.replace(/(\w+)>/gi,function(e,t){return t.toLowerCase()+">"})),n}var r,i="",a=!1;e.addPlugin({id:"codemirror",title:"源代码",waitTime:0,init:function(){e.loadCss(e.config.cBase.libDir+"codemirror/codemirror.css"),e.load.loadOneFile(e.config.cBase.libDir+"codemirror/codemirror.js",function(){e.load.loadOneFile(e.config.cBase.libDir+"codemirror/xml.js")})},click:function(){var o=this;if("undefined"!=typeof CodeMirror){var s=e.curEditor,l=t("#"+s.Eid+" textarea"),d="";if(a)d=r.getValue(),s.setContent(d),t(".CodeMirror").remove(),t("#"+s.Eid+" iframe").show(),a=!1,this.clicked(!1),i&&e.utils.setSelectionByOffset(e.curEditor.win,i),i="";else{i=e.utils.getSelectionOffset(s.win),this.clicked(!0),d=n(s.getContent()),l.val(d);var c=t("#"+s.Eid+" iframe");c.hide(),r=CodeMirror.fromTextArea(l[0],{mode:"text/html",lineNumbers:!0,lineWrapping:!0,tabMode:"indent",autoCloseTags:!0}),a=!0,c.closest(".bke-iframeholder").height(t(".CodeMirror").height())}s.isShowSource=a,o.waitTime=0}else o.waitTime>1e4&&e.error.writeError("no mirror_lib error: codemirror.js loading timeout",3,"plugin"),setTimeout(function(){o.click()},200),o.waitTime+=200}})}(jQuery.jQEditor,jQuery),function(e,t){function n(e,t,n){for(var r="ffffff,000000,eeece1,1f497d,4f81bd,c0504d,9bbb59,8064a2,4bacc6,f79646,f2f2f2,7f7f7f,ddd9c3,c6d9f0,dbe5f1,f2dcdb,ebf1dd,e5e0ec,dbeef3,fdeada,d8d8d8,595959,c4bd97,8db3e2,b8cce4,e5b9b7,d7e3bc,ccc1d9,b7dde8,fbd5b5,bfbfbf,3f3f3f,938953,548dd4,95b3d7,d99694,c3d69b,b2a2c7,92cddc,fac08f,a5a5a5,262626,494429,17365d,366092,953734,76923c,5f497a,31859b,e36c09,7f7f7f,0c0c0c,1d1b10,0f243e,244061,632423,4f6128,3f3151,205867,974806,c00000,ff0000,ffc000,ffff00,92d050,00b050,00b0f0,0070c0,002060,7030a0,".split(","),i='<div id="##" class="edui-colorpicker"><div class="edui-colorpicker-topbar edui-clearfix"><div unselectable="on" id="##_preview" class="edui-colorpicker-preview"></div><div unselectable="on" class="edui-colorpicker-nocolor" >'+e+"</div>"+"</div>"+'<table  class="edui-box" style="border-collapse: collapse;" cellspacing="0" cellpadding="0">'+'<tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;padding-top: 2px"><td colspan="10">'+n.getLang("themeColor")+"</td> </tr>"+'<tr class="edui-colorpicker-tablefirstrow" >',a=0;r.length>a;a++)a&&0===a%10&&(i+="</tr>"+(60==a?'<tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;"><td colspan="10">'+n.getLang("standardColor")+"</td></tr>":"")+"<tr"+(60==a?' class="edui-colorpicker-tablefirstrow"':"")+">"),i+=70>a?'<td style="padding: 0 2px;"><a hidefocus cmd="'+t+'" title="'+r[a]+'" onclick="return false;" href="javascript:" unselectable="on" class="edui-box edui-colorpicker-colorcell"'+' param="#'+r[a]+'"'+' style="background-color:#'+r[a]+";border:solid #ccc;"+(10>a||a>=60?"border-width:1px;":a>=10&&20>a?"border-width:1px 1px 0 1px;":"border-width:0 1px 0 1px;")+'"'+"></a></td>":"";return i+="</tr></table></div>"}e.addPlugin({id:"colormenu",type:"panel",isEnable:!0,fill:function(){e.fillPanel("forecolormenu",n("清除颜色","forecolor",e)),e.fillPanel("backcolormenu",n("清除颜色","backcolor",e)),e.fillPanel("cellcolormenu",n("清除颜色","cellcolor",e))},forecolor:function(){e.toolbar.togglePanel("forecolormenu")},backcolor:function(){e.toolbar.togglePanel("backcolormenu")},cellcolor:function(){e.toolbar.togglePanel("cellcolormenu")},getCellcolorPicker:function(){return n("清除颜色","cellcolor",e)}}),t(document).delegate(".edui-box td a","mouseenter",function(){var e=t(this),n=t(".edui-colorpicker-preview");n.css({"background-color":e.attr("param")})}),t(document).delegate(".edui-box td a","mouseleave",function(){var e=(t(this),t(".edui-colorpicker-preview"));e.css({"background-color":""})})}(window.jQuery.jQEditor,window.jQuery),function(e){function t(e){"string"==typeof e&&e||(e="Y-m-d");var t=new Date,n={};return n.Y=t.getFullYear(),n.m=t.getMonth()+1,n.d=t.getDate(),e.replace("Date_","").replace("Y",n.Y).replace("m",n.m).replace("d",n.d)}e.addPlugin({id:"datemenu",type:"panel",isEnable:!0,fill:function(t){var n="",r=[{name:"Y-m-d",cmd:"insertdate",param:"type_1"},{name:"Y/m/d",cmd:"insertdate",param:"type_2"},{name:"Y.m.d",cmd:"insertdate",param:"type_3"},{name:"Y年m月d日",cmd:"insertdate",param:"type_4"}];n=e.Menu.create(r),e.fillPanel("datemenu",n,t)},type_1:function(){e.utils.pasteHTML(t("Y-m-d"))},type_2:function(){e.utils.pasteHTML(t("Y/m/d"))},type_3:function(){e.utils.pasteHTML(t("Y.m.d"))},type_4:function(){e.utils.pasteHTML(t("Y年m月d日"))}})}(window.jQuery.jQEditor),function(e,t){var n={SPAN:!1,EM:!1,STRONG:!1,SUB:!1,SUP:!1},r="";e.addPlugin({id:"font",isEnable:!0,brushOn:{},recordTag:n,recordStyle:r,fontRecord:"",toggleBrush:function(){var t=this.brushOn[e.curId]?!0:!1;this.brushOn[e.curId]=!t,this.brushOn[e.curId]===!0?this.recordStyle():this.fontRecord=""},clear:function(n){var r=e.curEditor.win,i=r.document,a=r.getSelection(),o=a.getRangeAt(0),s=o.commonAncestorContainer,l={ancestor:s,firstNode:o.startContainer,firstOffset:o.startOffset,lastNode:o.endContainer,lastOffset:o.endOffset},d=["td","th","dd","dt"];for(var c in DTD.$block)c=c.toLowerCase(),1===DTD.$block[c]&&d.push(c);d=d.join(",");var u=t(l.lastNode).closest(d)[0],f=o.cloneRange();f.selectNodeContents(u),f.setStart(l.lastNode,l.lastOffset);var m=f.extractContents();f.insertNode(m);var p=t(l.firstNode).closest(d)[0],h=o.cloneRange();h.selectNodeContents(p),h.setEnd(l.firstNode,l.firstOffset);var g=h.extractContents();h.insertNode(g),o.setEnd(f.startContainer,f.startOffset),o.setStart(h.endContainer,h.endOffset);var b=o.cloneRange();b.collapse(!0);var v=o.cloneRange();v.collapse(!1);var y=v.endContainer.childNodes[v.endOffset],w={},s=o.commonAncestorContainer;w=e.IE?i.createNodeIterator(s):i.createNodeIterator(s,NodeFilter.SHOW_ALL);for(var E=w.nextNode(),k=E,C=0,T=1;E;){do k=w.nextNode();while(E===k);if(0===C){var x=i.createRange();x.selectNode(E);var N=x.compareBoundaryPoints(x.START_TO_START,b)}if(1===T)if(k){var S=i.createRange();S.selectNode(k);var j=S.compareBoundaryPoints(S.START_TO_START,v)}else var j=-1;var R=N>-1&&0===C,L=j>-1&&1===T;if(C&&T||R)if(1===E.nodeType&&1===DTD.$font[E.nodeName]){for(var I=E.nextSibling,_=E.parentNode,D=E.childNodes.length,Q=D-1;Q>=0;Q--)I?_.insertBefore(E.childNodes[Q],I):_.appendChild(E.childNodes[Q]);if(y)v.setEndBefore(y),v.collapse(!1);else{var A=v.endContainer.parentNode;v.setEnd(A,A.childNodes.length),v.collapse(!1)}var H=i.createRange();if(H.selectNode(E),H.deleteContents(),R&&(C=1,o.setStart(H.startContainer,H.startOffset)),L){I?o.setEndBefore(I):o.setEnd(_,_.childNodes.length);break}}else if(R&&(C=1,o.setStartBefore(E)),L){o.setEndAfter(E);break}E=k}return a.removeAllRanges(),a.addRange(o),n?o:(e.curEditor.baseFilter.excute("afterTextPre"),e.curEditor.baseFilter.excute("afterText"),void 0)},brush:function(){if(this.brushOn[e.curId]===!0){var t=this.fontRecord,n=this.clear(!0),r=e.curEditor.win,i=r.document,a=r.getSelection(),o=a.getRangeAt(0),s=n.cloneRange();s.collapse(!0);var l=n.cloneRange();l.collapse(!1);var d={},c=n.commonAncestorContainer;d=e.IE?i.createNodeIterator(c,3):i.createNodeIterator(c,NodeFilter.SHOW_TEXT);for(var u=d.nextNode(),f=u,m=0,p=1;u;){if(f=d.nextNode(),0===m){var h=i.createRange();h.selectNode(u);var g=h.compareBoundaryPoints(h.START_TO_START,s)}if(1===p)if(f){var b=i.createRange();b.selectNode(f);var v=b.compareBoundaryPoints(b.START_TO_START,l)}else var v=-1;var y=g>-1&&0===m,w=v>-1&&1===p;if(m&&p||y){var E=i.createRange();if(E.selectNodeContents(u),""!==t.fontStyle){var k=i.createElement("span");k.style.cssText=t.fontStyle,E.surroundContents(k)}for(var C in t.fontTag)if("SPAN"!==C&&t.fontTag[C]===!0){var T=i.createElement(C);E.surroundContents(T)}if(y&&(m=1,o.setStart(E.startContainer,E.startOffset)),w){o.setEnd(E.endContainer,E.endOffset);break}}u=f}a.removeAllRanges(),a.addRange(o)}this.toggleBrush(),e.curEditor.baseFilter.excute("afterTextPre"),e.curEditor.baseFilter.excute("afterText")},recordStyle:function(){for(var r=e.utils.getCurElement(),i=r.length,a=t.extend(!0,{},this.recordTag),o="",s=0;i>s;s++)3!==r[s].nodeType&&void 0!==n[r[s].nodeName]&&(a[r[s].nodeName]=!0,o+=r[s].style.cssText);this.fontRecord={fontTag:a,fontStyle:o}}}),e.addEvent({name:"editareaBrush",type:["mouseup"],area:"editArea",fn:function(){e.curEditor.$toolbar.find("[cmd=formatmatch].bke-checked").length>0&&e.command("brush")}})}(window.jQuery.jQEditor,window.jQuery),function(e,t){var n=[{name:"宋体",cmd:"fontfamily",param:"SimSun",styleName:"bke-SimSun"},{name:"仿宋体",cmd:"fontfamily",param:"FangSong_GB2312",styleName:"bke-FangSong_GB2312"},{name:"微软雅黑",cmd:"fontfamily",param:"Microsoft YaHei",styleName:"bke-Microsoft_YaHei"},{name:"黑体",cmd:"fontfamily",param:"SimHei",styleName:"bke-SimHei"},{name:"楷体",cmd:"fontfamily",param:"KaiTi_GB2312",styleName:"bke-KaiTi_GB2312"},{name:"Impact",cmd:"fontfamily",param:"Impact",styleName:"bke-Impact"},{name:"Georgia",cmd:"fontfamily",param:"Georgia",styleName:"bke-Georgia"},{name:"Arial",cmd:"fontfamily",param:"Arial",styleName:"bke-Arial"},{name:"Verdana",cmd:"fontfamily",param:"Verdana",styleName:"bke-Verdana"},{name:"Tahoma",cmd:"fontfamily",param:"Tahoma",styleName:"bke-Tahoma"}];e.addPlugin({id:"fontfamilymenu",type:"panel",isEnable:!0,fill:function(t){var r=e.Menu.create(n);e.fillPanel("fontfamilymenu",r,t)},echo:function(e,r){r=r.replace(/'/g,"")||"",r=r.toLowerCase(),t.each(n,function(t,n){return n.param.toLowerCase()===r?(e.find("#icon-fontfamilymenu").find(".bke-Font a").html(n.name),!1):void 0})}})}(jQuery.jQEditor,jQuery),function(e){var t=[{name:"12px",cmd:"fontsize",param:"12px",styleName:"bke-font12"},{name:"14px",cmd:"fontsize",param:"14px",styleName:"bke-font14"},{name:"18px",cmd:"fontsize",param:"18px",styleName:"bke-font18"},{name:"24px",cmd:"fontsize",param:"24px",styleName:"bke-font24"},{name:"36px",cmd:"fontsize",param:"36px",styleName:"bke-font36"}];e.addPlugin({id:"fontsizemenu",type:"panel",isEnable:!0,fill:function(){var n=e.Menu.create(t);e.fillPanel("fontsizemenu",n)},echo:function(e,t){e.find("#icon-fontsizemenu").find(".bke-FontSize a").html(t)
}})}(window.jQuery.jQEditor),function(e,t){var n={html:"HTML/XML",js:"Javascript",css:"CSS",php:"PHP",java:"Java",py:"Python",pl:"Perl",rb:"Ruby",cs:"C#",c:"C++/C",vb:"VB/ASP"},r='<div><select name="code_language" style="margin:2px 0;">';for(var i in n)r+='<option value="'+i+'">'+n[i]+"</option>";r+="</select></div>",r+='<textarea name="content" style="width:600px;height:300px;resize:none;"></textarea>',e.addUi({id:"codedialog",html:r,submit:function(){var n=t("#codedialog"),r=n.find("select[name=code_language]").val(),i=n.find("textarea").val();return i=e.utils.escape(i),'\n<pre class="prettyprint lang-'+r+'">'+i+"</pre>\n"}}),e.addPlugin({id:"highlightcode",title:"插入代码",ui:"codedialog",type:"dialog",getData:function(e){var n=e.getCursorElement(),r=t(n).closest("pre").text(),i={content:r};return i}})}(jQuery.jQEditor,jQuery),function(e){e.addPlugin({id:"hn",isEnable:!0,paramStr:function(t){var n="",r=e.utils.getSelectionText();return r?r.length>80?e.log.writeLog("不能选择超过80个字符的长度！"):/[`~!\\\/]/.test(r)?e.log.writeLog("不能包含特殊字符“`~!/”！"):(n="<"+t+' class="'+t+'">'+r+"</"+t+">",e.utils.pasteHTML(n)):e.log.writeLog("请选择需要设置为百科链接的文字！"),1},h2:function(){this.paramStr("h2")},h3:function(){this.paramStr("h3")}})}(window.jQuery.jQEditor),function(E,$){function onePlupload(){if(!$(".bke-dialog div[name=tab1]").is(":hidden")){uploader1&&uploader1.destroy();var conf=E.curEditor.config.cBase.plupload;uploader1=new plupload.Uploader({runtimes:"flash",browse_button:"pickfile",multi_selection:!1,container:"container1",max_file_size:conf.max_file_size,url:conf.url,flash_swf_url:conf.pluploadswf,filters:[{title:"Image files",extensions:"jpg,gif,png"}],resize:{width:1024,height:768,quality:90}}),uploader1.init(),uploader1.bind("FilesAdded",function(e){e.refresh(),uploader1.start()}),uploader1.bind("UploadProgress",function(e,t){$("#container1 span").html("已上传"+t.percent+"%")}),uploader1.bind("Error",function(e){e.refresh()}),uploader1.bind("FileUploaded",function(up,file,obj){eval("var o = "+obj.response),o.url&&$("#imagedialog").find("input[name=url]").val(o.url),setTimeout(function(){$("#container1 span").html("")},1e3)})}}function multPlupload(){if(!$(".bke-dialog div[name=tab2]").is(":hidden")){uploader2&&uploader2.destroy();var conf=E.curEditor.config.cBase.plupload;uploader2=new plupload.Uploader({runtimes:"flash",browse_button:"pickfiles",container:"container2",max_file_size:conf.max_file_size,url:conf.url,flash_swf_url:conf.pluploadswf,filters:[{title:"Image files",extensions:"jpg,gif,png"}],resize:{width:1024,height:768,quality:90}}),uploader2.init(),uploader2.bind("FilesAdded",function(e,t){$.each(t,function(e,t){$("#filelist").append('<a id="'+t.id+'" class="bke-image-thumb">'+t.name+" ("+plupload.formatSize(t.size)+") <b></b>"+"</a>")}),e.refresh(),uploader2.start()}),uploader2.bind("UploadProgress",function(e,t){$("#"+t.id+" b").html(t.percent+"%")}),uploader2.bind("Error",function(e,t){$("#filelist").append("<div>Error: "+t.code+", Message: "+t.message+(t.file?", File: "+t.file.name:"")+"</div>"),e.refresh()}),uploader2.bind("FileUploaded",function(up,file,obj){eval("var o = "+obj.response),o.url&&$("#"+file.id).html('<img src="'+o.url+'" width="100%"><span title="删除">×</span>')})}}E.addUi({id:"imagedialog",check:function(){if(!$(".bke-dialog div[name=tab1]").is(":visible"))return!0;var e=this.getValues();return e.link?void 0:(this.error("请输入正确的图片地址"),!1)},submit:function(){var e="";if($(".bke-dialog div[name=tab1]").is(":visible")){var t=this.getValues();e='<a href="'+t.link+'" target="'+t.target+'"><img src="'+t.url+'"',t.title&&(e+=' title="'+t.title+'"'),t.align&&(e+=' align="'+t.align+'"'),t.width&&(e+=' width="'+t.width+'"'),t.height&&(e+=' height="'+t.height+'"'),e+="/></a>"}else $(".bke-dialog .bke-image-filelist img").each(function(){e+='<img src="'+$(this).attr("src")+'"/>'});return e},callback:function(){setTimeout(function(){onePlupload(),multPlupload()},0)},beforeunload:function(){uploader1.destroy(),uploader2.destroy()}}),$(document).delegate(".bke-tabs a","click",function(){var e=$(this).attr("name");$(".bke-tabs a").removeClass("bke-tabs-selected").filter("a[name="+e+"]").addClass("bke-tabs-selected"),$("div[name=tab1],div[name=tab2]").hide(),$("div[name="+e+"]").show(),"tab2"===e&&multPlupload()}),$(document).delegate(".bke-dialog :input[name=url]","change",function(){var e=$.trim(this.value);if(e){var t=new Image;t.onload=function(){$(".bke-dialog .bke-image-preview").html('<img src="'+e+'" width="160" />'),$(".bke-dialog .bke-image-size").html("宽："+this.width+"px<br>高："+this.height+"px")},t.onerror=function(){$(".bke-dialog .bke-image-preview").html("图片加载失败！"),$(".bke-dialog .bke-image-size").html("")},t.src=e}});var uploader1,uploader2}(jQuery.jQEditor,jQuery),function(e){e.dialogHtml.imagedialog='<div ui="imagedialog" style="width:580px; height:300px"><div class="bke-tabs"><a class="bke-tabs-first bke-tabs-selected" name="tab1">单张插入</a><a name="tab2">批量上传</a></div><div name="tab1"><table><tr><td width="60">地 址：<span style="color:red">*</span></td><td width="300"><input type="text" name="url" style="width:280px"/></td><td width="180" rowspan="8" align="right" valign="top"><div class="bke-image-preview">图片预览</div><div class="bke-image-size"></div></td></tr><tr><td></td><td id="container1">输入图片地址 或 <a id="pickfile" title="上传成功之后，会自动生成地址">上传一张图片</a> <span></span></td></tr><tr><td>链 接：</td><td><input type="text" name="link" style="width:280px"/></td></tr><tr><td></td><td><select name="target"><option value="_blank" selected="selected">新窗口打开链接</option><option value="_top">当前窗口打开链接</option></select></td></tr><tr><td>描 述：</td><td><input type="text" name="title" style="width:280px"/></td></tr><tr><td>宽 度：</td><td><input type="text" name="width"/> px</td></tr><tr><td>高 度：</td><td><input type="text" name="height"/> px</td><td>&nbsp;</td></tr><tr><td>对 齐：</td><td><select name="align"><option value="left" selected="selected">图片局左</option><option value="center">图片居中</option><option value="right">图片局右</option></select></td></tr></table></div><div name="tab2" style="display:none; "><div id="container2" style="line-height:25px;"><a id="pickfiles">选择图片</a><span></span></div><div id="filelist" class="bke-image-filelist"></div></div></div>'}(jQuery.jQEditor),function(e){function t(){var t=$(e.curEditor.dom).find("."+e.curEditor.config.selectImgClass);return t.length>0?t:$(e.utils.getCurElement().pop()).prev("img")}e.addPlugin({id:"image",type:"dialog",waitTime:0,init:function(){e.load.loadOneFile(e.config.cBase.libDir+"plupload/plupload.js"),e.utils.loadDialog(this.id,e.config.cBase.uiDir+"image/")},showDialog:function(t){var n=this;if("undefined"!=typeof plupload){var r=t.Eid;e.dialog.open({id:"imagedialog",editor:r,title:"图片",content:$("[ui=imagedialog]"),ok:function(){return e.ui("imagedialog").check()?(e.dialog.revertSelection(),e.command("imagedialog"),void 0):!1},cancel:function(){e.dialog.close("imagedialog")},init:function(){e.ui("imagedialog").callback()},beforeunload:function(){e.ui("imagedialog").beforeunload()},icon:"succeed"})}else n.waitTime>1e4&&e.error.writeError("no mirror_lib error: codemirror.js loading timeout",3,"plugin"),setTimeout(function(){n.showDialog(t)},200),n.waitTime+=200},imgFloat:function(e){var n="";switch(e=parseInt(e)){case 1:n="left";break;case 2:n="none";break;case 3:n="right";break;default:n="none"}var r=t();$(r).css("float",n)},preInsert:function(e){return'<a href="'+e.link+'" target="'+e.target+'"><img src="'+e.url+'" style="width:'+e.width+";height:"+e.height+';"/></a>'}})}(jQuery.jQEditor),function(e){var t=[{cmd:"insertcode",name:"HTML/XML",param:"html"},{cmd:"insertcode",name:"Javascript",param:"js"},{cmd:"insertcode",name:"CSS",param:"css"},{cmd:"insertcode",name:"PHP",param:"php"},{cmd:"insertcode",name:"Java",param:"java"},{cmd:"insertcode",name:"Python",param:"py"},{cmd:"insertcode",name:"Perl",param:"pl"},{cmd:"insertcode",name:"Ruby",param:"rb"},{cmd:"insertcode",name:"C#",param:"cs"},{cmd:"insertcode",name:"C++/C",param:"c"},{cmd:"insertcode",name:"VB/ASP",param:"vb"},{cmd:"insertcode",name:"Coffee",param:"coffee"},{cmd:"insertcode",name:"Shell",param:"sh"}];e.addPlugin({id:"insertcodemenu",type:"panel",fill:function(){var n=e.Menu.create(t);e.fillPanel("insertcodemenu",n)},echo:function(){}}),e.addEvent({name:"insertcode",type:["click","keyup"],fn:function(n){var r=n.event.keyCode;if(!r||!(37>r||r>40)){var i="插入代码",a=e.curEditor.cursorElements.pre;if(a){var o=$(a).attr("name");$.each(t,function(e,t){t.param.toLowerCase()===o&&(i=t.name)})}e.curEditor.$toolbar.find("#icon-insertcodemenu").find(".bke-InsertCode a").html(i)}}}),e.addPlugin({id:"insertcode",click:function(t){var n='<pre name="'+t+'" id="prettyprint" class="prettyprint lang-'+t+'">&#8203;<br></pre>',r=e.curEditor;r.insert(n),setTimeout(function(){var t=e.$("#prettyprint").removeAttr("id");r.setCursor(t[0],!0)},0)}})}(window.jQuery.jQEditor),function(e,t){e.addPlugin({id:"insertparagraph",title:"插入段落",isEnable:!0,click:function(n){var r=e.curEditor,i=r.getCursorElement(),a=t(i).closest("p,pre,table,ul,ol,div"),o=r.dom.createElement("p");o.innerHTML="&#8203;",a[n](o),e.utils.setCursor(r.win,o,!0)}})}(jQuery.jQEditor,jQuery),function(e){e.addPlugin({id:"inserttime",click:function(){var t=new Date,n=t.getHours(),r=t.getMinutes(),i=t.getSeconds();n=n>9?n:"0"+n,r=r>9?r:"0"+r,i=i>9?i:"0"+i;var a=" "+n+":"+r+":"+i+" ";e.command("insert",a)}})}(window.jQuery.jQEditor),function(e){e.addUi({id:"linkdialog",html:'<table width="300">		  <tr>			<td>链接文字：</td>			<td><input type="text" name="text" style="width:200px"/></td>		  </tr>		  <tr>			<td>链接地址：</td>			<td><input type="text" name="link" value="http://" style="width:200px"/></td>		  </tr>		  <tr>			<td></td>			<td><select name="target">				<option value="_blank" selected="true">新窗口打开</option>				<option value="_top">当前窗口打开</option>			</select></td>		  </tr>		  </table>',check:function(){},submit:function(){var t=this.getValues();if(t.text){var n='<a href="'+t.link+'" target="'+t.target+'">'+t.text+"</a>";e.utils.pasteHTML(n)}}}),e.addPlugin({id:"link",title:"超链接",ui:"linkdialog",type:"dialog",getData:function(){var t={text:e.utils.getSelectionText()};return t}})}(jQuery.jQEditor,jQuery),function(e){e.addUi({id:"mapdialog",submit:function(t){var n=$("#mapdialog");if(0===n.size())return!1;var r=t.Main,i=(r.geocoder,r.map),a=i.getCenter().lat()+","+i.getCenter().lng(),o=r.marker?r.marker.position:a,s=i.getZoom(),l=i.getMapTypeId(),d="http://maps.google.com/maps/api/staticmap?center="+a+"&zoom="+s+"&size=520x340"+"&maptype="+l+"&markers="+o+"&language=zh-cn"+"&sensor=false",c='<img class="googlemap" src="'+d+'" title="'+r.address+'" alt="'+r.address+'"/>';e.utils.pasteHTML(c)}})}(window.jQuery.jQEditor),function(e){var t=null;e.addPlugin({id:"map",type:"dialog",showDialog:function(n){var r=n.Eid;e.dialog.open({id:"mapdialog",editor:r,title:"插入地图",content:'<iframe src="'+e.config.cBase.skinDir+'googlemap.htm" name="googlemapframe" style="width: 600px; height: 350px; border: 0px none;" frameborder="0" allowtransparency="true"></iframe>',ok:function(){e.dialog.revertSelection(),e.command("mapdialog","submit",t)},cancel:function(){e.dialog.close("mapdialog")},init:function(){t=window.frames.googlemapframe},icon:"succeed"})}})}(window.jQuery.jQEditor),function(e){e.addPlugin({id:"olmenu",type:"panel",isEnable:!0,fill:function(t){var n="",r=[{name:"1.2.3...",cmd:"insertorderedlist",param:"decimal"},{name:"a,b,c...",cmd:"insertorderedlist",param:"lower-alpha"},{name:"A,B,C...",cmd:"insertorderedlist",param:"upper-alpha"},{name:"i,ii,iii...",cmd:"insertorderedlist",param:"lower-roman"},{name:"I,II,III...",cmd:"insertorderedlist",param:"upper-roman"}];n=e.Menu.create(r),e.fillPanel("insertorderedlistmenu",n,t)}})}(window.jQuery.jQEditor),function(e){e.addUi({id:"pasteworddialog",html:'<p>请将Word当中的内容粘贴到下面的方框里，然后点击确定按钮。</p>		<textarea id="content" name="content" rows="20" cols="75"></textarea>',submit:function(){var t=this.getValues();if(t.url){var n="";e.utils.pasteHTML(n)}}}),e.addPlugin({id:"pasteword",title:"从 MS Word 粘帖",ui:"pasteworddialog",type:"dialog",getData:function(){var e={};return e}})}(jQuery.jQEditor,jQuery),function(e,t){e.addUi({id:"searchdialog",search:function(n){var r="prev"===n?!1:!0,i=t("#searchdialog");if(0!==i.size()){var a=i.find("#sourceword").val(),o=i.find("[name=whole]")[0].checked,s=i.find("[name=sensitive]")[0].checked;return e.utils.execPlugin("search","search",{backward:r,sourceword:a,whole:o,sensitive:s}),!1}return!1},replace:function(){var n=t("#searchdialog");if(0!==n.size()){var r=n.find("#sourceword").val(),i=n.find("#targetword").val(),a=n.find("[name=whole]")[0].checked,o=n.find("[name=sensitive]")[0].checked;return e.utils.execPlugin("search","replace",{backward:!0,sourceword:r,targetword:i,whole:a,sensitive:o}),!1}return!1}})}(window.jQuery.jQEditor,window.jQuery),function(e){e.dialogHtml.searchdialog='<TABLE ui="searchdialog"><TR><TD>查找：</TD><TD><input type="text" id="sourceword" name="sourceword" /></TD></TR><TR><TD>替换：</TD><TD><input type="text" id="targetword" name="targetword"/></TD></TR><TR><TD><input type="checkbox" id="whole" name="whole"/>全词匹配</TD><TD>&nbsp;</TD></TR><TR><TD><input type="checkbox" id="sensitive" name="sensitive"/>大小写相关</TD><TD>&nbsp;</TD></TR></TABLE>'}(jQuery.jQEditor),function(e){e.addPlugin({id:"search",type:"dialog",init:function(){e.utils.loadDialog(this.id,e.config.cBase.uiDir+"search/")},showDialog:function(t){var n=t.Eid;e.dialog.open({id:"searchdialog",editor:n,title:"查找",content:$("[ui=searchdialog]"),button:[{value:"<< 查找",callback:function(){return e.command("searchdialog","search","prev"),!1}},{value:"查找 >>",callback:function(){return e.command("searchdialog","search","next"),!1}},{value:"替换 ≒",callback:function(){return e.command("searchdialog","replace"),!1}}],icon:"succeed"})},search:function(t){var n=e.curEditor.win,r=!1;if(e.IE){var i=n.document.body.createTextRange();n.focus();var a=n.document.selection.createRange().duplicate();try{t.backward?i.setEndPoint("StartToEnd",a):i.setEndPoint("EndToStart",a)}catch(o){n.focus()}var s=t.sourceword,l=t.whole===!0?2:0,d=t.sensitive===!0?4:0,c=t.backward===!0?0:-1,u=l|d;r=i.findText(s,c,u),r&&i.select()}else{var s=t.sourceword,f=t.whole,m=t.sensitive,p=t.backward===!0?!1:!0;r=n.find(s,m,p,!1,f)}r||e.errorMessage("没有找到目标！")},replace:function(t){e.curEditor.win;var n=e.utils.getSelectionText();n.toLowerCase()!==t.sourceword.toLowerCase()?this.search(t):(e.utils.replaceSelectedText(e.curEditor.win,t.targetword),this.search(t))}})}(window.jQuery.jQEditor),function(e,t){var n,r,i=!1;e.addPlugin({id:"shortcutmenu",totext:function(){var r=t(n).text();e.$(n).replaceWith(r)},unlink:function(){var r=t(n).html();return e.$(n).replaceWith(r),!0},remove:function(){n.parentNode.removeChild(n)},editRefer:function(){return!0},removeImage:function(){var e=t(n);e.closest("div.img").length?e=e.closest("div.img"):e.closest("a").length&&(e=e.closest("a")),confirm("确定删除这个图片？")&&e.remove()},alignImage:function(e){o.update(n,e,"align")},resizeImage:function(e){o.update(n,e,"resize")},moveImage:function(){i=!0},descImage:function(){var e=t(n).closest("div.img"),r="";e.length&&(r=e.attr("class"),r.indexOf("img_l")>-1?r="left":r.indexOf("img_c")>-1?r="center":r.indexOf("img_r")>-1&&(r="right")),o.update(n,r,"desc")},contextmenu:function(){return i?(i=!1,!1):!0},select:function(){e.curEditor.selectNode(n)}}),t(document).delegate(".bke-shortcutmenu","click",function(n){var r=t(n.target).closest("[cmd]");if(r.closest(".bke-disabled").length)return!0;if(r.length){var i=r.attr("cmd"),a=r.attr("param"),o=r.attr("args");return e.command(i,a,o),t(this).css({top:"-2000px"}),!1}}),e.addEvent({name:"shortcutmenu-mousedown",type:["mousedown"],area:"editArea",fn:function(t){var a=e.$(t.target);i||(r=null,n=null,a.is("img")&&a.closest("div.img").length&&(a=a.closest("div.img")),a.is("div.img,img,h2,h3,a,sup.refer,pre")&&(r=a.offset(),r.top+=a.outerHeight()+2,n=t.target))}}),e.addEvent({name:"shortcutmenu-mouseup",type:["mouseup"],area:"editArea",fn:function(s){var l=e.$(s.target);if(3!==s.event.which)if(i)if(l.is("div.img,img,h2,h3,a,sup.refer"))e.errorMessage("此处不适合放置图片，请重新选择");else{var d=e.curEditor.getRange();t(n).closest("div.img").length&&(n=t(n).closest("div.img")[0]),d.insertNode(n),i=!1}else{l=t(".bke-shortcutmenu");var c=t(n),u=null;r?(u=n.tagName.toLowerCase(),l.removeClass("bke-shortcutmenu-img bke-shortcutmenu-sup bke-shortcutmenu-other"),c.is("img")?(l.addClass("bke-shortcutmenu-img"),setTimeout(function(){o.callback(n,l)},0)):c.is("sup")?l.addClass("bke-shortcutmenu-sup"):c.is("pre")?l.addClass("bke-shortcutmenu-pre"):l.addClass("bke-shortcutmenu-other"),l.css(r),l.html(a[u]())):l.css({top:"-2000px"})}}}),e.addEvent({name:"shortcutmenu-keyup",type:["keyup"],area:"editArea",fn:function(t){if(27===t.event.keyCode){var n="";n||e.plugin("shortcutmenu").totext()}}});var a={h2:function(){var e=[];return e.push('<a cmd="shortcutmenu" param="totext">取消目录(Esc)</a>'),e.push('<span class="bke-vline">|</span>'),e.push('<a  cmd="shortcutmenu" param="remove">删除目录</a>'),e.join("")},h3:function(){return this.h2()},a:function(){var e,r=[],i=t(n),a=i.text(),o=i.attr("href");return r.push('<a cmd="shortcutmenu" param="unlink" title="将链接转为纯文本">取消链接(Esc)</a>'),o&&(e=/^http:\/\/www\.(hudong|baike)\.com\/wiki\//.test(o)||i.hasClass("baikelink")||i.hasClass("innerlink")?"http://www.baike.com/wiki/"+encodeURI(a):o,r.push('<span class="bke-vline">|</span>'),r.push(' <a href="'+e+'" title="'+e+'" target="_blank">打开链接</a>')),r.join("")},sup:function(){return'<a cmd="shortcutmenu" param="editRefer">编辑</a><span class="bke-vline">|</span><a cmd="shortcutmenu" param="remove">删除</a>'},pre:function(){return'<a cmd="shortcutmenu" param="select">选中</a><span class="bke-vline">|</span><a cmd="shortcutmenu" param="remove">删除</a>'},img:function(){var e=[],t=/a\d\.att\.(hudong|baike)\.com/i.test(n.src);return e.push('<a cmd="shortcutmenu" param="descImage">添加描述</a>'),e.push('<span class="bke-vline">|</span>'),e.push('<a cmd="shortcutmenu" param="moveImage" title="点击我，然后将光标移到到新的位置，左键插入右键取消">移动图片</a>'),e.push('<a cmd="shortcutmenu" param="removeImage" style="float:right;color:red;">删除</a>'),e.push('<div class="bke-dottedline"></div>'),e.push("排版："),e.push('<a cmd="shortcutmenu" param="alignImage" args="left">居左</a> '),e.push('<a cmd="shortcutmenu" param="alignImage" args="center">居中</a> '),e.push('<a cmd="shortcutmenu" param="alignImage" args="right">居右</a>'),e.push('<span class="bke-vline">|</span>'),t?(e.push('<a cmd="shortcutmenu" param="resizeImage" args="_950">大图</a> '),e.push('<a cmd="shortcutmenu" param="resizeImage" args="_s">中图</a> '),e.push('<a cmd="shortcutmenu" param="resizeImage" args="_140">小图</a>')):e.push("大图 中图 小图"),e.join("")},table:function(){return'<a cmd="shortcutmenu" param="editRefer">表格全选</a><span class="bke-vline">|</span><a cmd="shortcutmenu" param="remove">行列拖拽</a>'}},o={update:function(n,r,i){function a(t){var n=(s.attr("src"),d[r]?d[r]:"img_c");"number"==typeof t&&(l=t),l>o&&(l=o,s.width=l),s.closest("a").length&&(s=s.closest("a"));var a=s.closest("div.img");a.length?"resize"==i?a.width(l).find("img").width(l):a.removeClass("img_l img_c img_r").addClass(n):(a=e.$('<div class="img '+n+'" style="width:'+l+'px"></div>').append(s.clone()),s.replaceWith(a)),"desc"==i?(c=s.attr("title")?s.attr("title"):s.attr("alt")?s.attr("alt"):"图片描述",a.find("strong").length?a.find("strong").text(c):a.append("<strong>"+c+"</strong>")):a.find("strong").removeAttr("style")}var o=600,s=t(n),l=s.width(),d={left:"img_l",center:"img_c",right:"img_r"},c="",u="";if("resize"==i&&/a\d\.att\.(hudong|baike)\.com/i.test(s.attr("src"))){u=s.attr("src").replace(/_140|_s|_950/i,r),s.attr("src",u);var f=new Image;f.onload=function(){s.attr("width",f.width),a(f.width)},f.src=u}else a()},callback:function(e,n){var r=t(e).closest("div.img"),i=null,a={left:"img_l",center:"img_c",right:"img_r"},o=["_950","_s","_140"],s={color:"#666666",cursor:"default","text-decoration":"none"};if(r.length&&r.attr("class").indexOf("img")>-1){var l=r.attr("class");for(var d in a){var c=a[d];if(l.indexOf(c)>-1){i=d;break}}if(i){var u=n.find("[args="+i+"]");u.css(s).removeAttr("cmd")}var f=r.find("strong");f.length>0&&t.trim(f.text())&&(f=n.find("[param=descImage]"),f.css(s).removeAttr("cmd").attr("title","已存在图片描述，直接修改即可"))}if(/a\d\.att\.(hudong|baike)\.com/i.test(e.src))for(var m=e.src,p=0;o.length>p;p++){var c=o[p];if(m.indexOf(c)>-1){var h=n.find("[args="+c+"]");h.css(s).removeAttr("cmd");break}}}}}(jQuery.jQEditor,jQuery),function(){}(jQuery.jQEditor,jQuery),function(e,t){function n(n){n=n.replace(/\n+/g,"");var r=t("<div></div>").append(n),i="",a=null;r.children().each(function(){try{a=t(this),i=a.html(),i.length>50&&a.html("\n"+i+"\n"),a.after("\n")}catch(e){}});var o=r.find("table");return o.size()&&o.find("tr,td,th").after("\n").before("\n"),n=r.html(),n=n.replace(/\n+/g,"\n"),n=n.replace(/<BR>/gi,"<br>\n"),n=n.replace(/<.+?>/gi,function(e){return e=e.replace(/COLOR:/g,"color:"),e=e.replace(/rgb\(\d+,(?: |&nbsp;)?\d+,(?: |&nbsp;)?\d+\)/gi,function(e){return Utils.colorToHex(e)})}),e.IE&&(n=n.replace(/<(\w+)/gi,function(e,t){return"<"+t.toLowerCase()}),n=n.replace(/(\w+)>/gi,function(e,t){return t.toLowerCase()+">"})),n}var r="";e.addUi({id:"sourcedialog",html:'<textarea name="content" style="width:700px;height:400px;resize:none;"></textarea>',submit:function(){var n=t("#sourcedialog").find("textarea").val();e.curEditor.setContent(n),r&&e.utils.setSelectionByOffset(e.curEditor.win,r),r=""}}),e.addPlugin({id:"source",title:"源代码",ui:"sourcedialog",type:"dialog",getData:function(t){r=e.utils.getSelectionOffset(t.win);var i={content:n(t.getContent())};return i}})}(jQuery.jQEditor,jQuery),function(e){var t=[{name:"0px",cmd:"spacebottom",param:"0px",styleName:""},{name:"5px",cmd:"spacebottom",param:"5px",styleName:""},{name:"10px",cmd:"spacebottom",param:"10px",styleName:""},{name:"15px",cmd:"spacebottom",param:"15px",styleName:""},{name:"20px",cmd:"spacebottom",param:"20px",styleName:""}],n=[{name:"0px",cmd:"spacetop",param:"0px",styleName:""},{name:"5px",cmd:"spacetop",param:"5px",styleName:""},{name:"10px",cmd:"spacetop",param:"10px",styleName:""},{name:"15px",cmd:"spacetop",param:"15px",styleName:""},{name:"20px",cmd:"spacetop",param:"20px",styleName:""}],r=[{name:"0行距",cmd:"linespace",param:"1em",styleName:""},{name:"0.5倍行距",cmd:"linespace",param:"1.5em",styleName:""},{name:"单倍行距",cmd:"linespace",param:"2em",styleName:""},{name:"1.25倍行距",cmd:"linespace",param:"2.25em",styleName:""},{name:"1.5倍行距",cmd:"linespace",param:"2.5em",styleName:""},{name:"1.75倍行距",cmd:"linespace",param:"2.75em",styleName:""},{name:"2倍行距",cmd:"linespace",param:"3em",styleName:""},{name:"3倍行距",cmd:"linespace",param:"4em",styleName:""}];e.addPlugin({id:"spacemenu",type:"panel",isEnable:!0,fill:function(){var i=e.Menu.create(n),a=e.Menu.create(t),o=e.Menu.create(r);e.fillPanel("spacebottommenu",a),e.fillPanel("spacetopmenu",i),e.fillPanel("linespacemenu",o)},bottom:function(){e.toolbar.togglePanel("spacebottommenu")},top:function(){e.toolbar.togglePanel("spacetopmenu")},line:function(){e.toolbar.togglePanel("linespacemenu")}})}(window.jQuery.jQEditor),function(e){function t(){for(var e="<table>",t=0;n.length>t;t++){var r=n[t];e+="<tr>";for(var i=0;r.length>i;i++)e+='<td><a href="javascript:void(0)" cmd="spechars" param="'+r[i]+'"'+' class="special_num">'+r[i]+"</a></td>";e+="</tr>"}return e+="</table>"}var n=[["±","×","÷","∶","∑","∏","∪","∩","∈","∷"],["√","⊥","∥","∠","⌒","∫","∮","≡","≌","≈"],["∝","≠","≮","≯","≤","≥","∞","∵","∴","㏑"],["㏒"],["＄","￠","￡","㏎","㎎","㎏","㎜","㎝","㎞","㎡"],["㏄","㏕","№"],["ā","á","ǎ","à","ē","é","ě","è","ī","í"],["ǐ","ì","ō","ó","ǒ","ò","ū","ú","ǔ","ù"],["ǖ","ǘ","ǚ","ǜ","ü"]];e.addPlugin({id:"specharsmenu",type:"panel",fill:function(){e.fillPanel("specharsmenu",t())},click:function(){e.toolbar.togglePanel("specharsmenu")}})}(jQuery.jQEditor,jQuery),function(e,t){e.addUi({id:"tabledialog",submit:function(){var n=t("#tabledialog");if(0!==n.size()){var r=n.find("[name=title]")[0].checked,i=n.find("[name=col]").val(),a=n.find("[name=row]").val(),o=n.find("[name=float]:checked").val(),s=n.find("[name=head]")[0].checked,l=e.utils.execPlugin("table","preInsert",{title:r,head:s,col:i,row:a,"float":o});return l}return!1},changeAttr:function(){var n=t("#tableattrdialog");if(0===n.size())return!1;var r=n.find("[name=title]")[0].checked,i=n.find("[name=col]").val(),a=n.find("[name=row]").val(),o=n.find("[name=float]:checked").val(),s=n.find("[name=head]")[0].checked;e.utils.execPlugin("table","changeTableAttr",{title:r,head:s,col:i,row:a,"float":o})},setValues:function(e){var n=t("#tableattrdialog:visible");n.length>0&&(n.find("[name=float][value="+e.float+"]")[0].checked=!0,n.find("[name=title]")[0].checked=e.title?!0:!1,n.find("[name=head]")[0].checked=e.head?!0:!1,e.row&&n.find("[name=row]").val(e.row),n.find("[name=row]")[0].disabled=!0,e.col&&n.find("[name=col]").val(e.col),n.find("[name=col]")[0].disabled=!0)}})}(window.jQuery.jQEditor,window.jQuery),function(e){e.dialogHtml.tabledialog='<TABLE ui="tabledialog"><TR><TD>表格模板</TD><TD><select id="table-template" name="template"><option value="tpl1" selected="selected">模板1</option><option value="tpl2">模板2</option></select></TD><TD> &nbsp </TD></TR><TR><TD>表格标题</TD><TD><input type="checkbox" id="table-title" name="title" /></TD></TR><TR><TD>表头</TD><TD><input type="checkbox" id="table-head" name="head" /></TD><TD> &nbsp </TD></TR><TR><TD>行</TD><TD><input type="text" id="table-col" name="row" value="4"/></TD><TD> &nbsp </TD></TR><TR><TD>列</TD><TD><input type="text" id="table-row" name="col" value="3"/></TD><TD> &nbsp </TD></TR><TR><TD>浮动方式</TD><TD><p><input type="radio" id="table-float-left" name="float" value="1"/>左浮动<input type="radio" id="table-align-center" name="float" checked="checked" value="2"/>居中<input type="radio" id="table-align-right" name="float" value="3"/>右浮动</p></TD><!--<TD><p><input type="radio" id="table-align-lt" name="align" value="1"/>居左上<input type="radio" id="table-align-ct" name="align" value="2"/>居中上<input type="radio" id="table-align-rt" name="align" value="3"/>居右上</p><p><input type="radio" id="table-align-lm" name="align" value="4"/>居左中<input type="radio" id="table-align-cm" name="align" checked="checked" value="5"/>居&nbsp&nbsp中<input type="radio" id="table-align-rm" name="align" value="6"/>居右中</p><p><input type="radio" id="table-align-lb" name="align" value="7"/>居左下<input type="radio" id="table-align-cb" name="align" value="8"/>居中下<input type="radio" id="table-align-rb" name="align" value="9"/>居右下</p></TD>  --><TD> &nbsp </TD></TR></TABLE>'}(jQuery.jQEditor),function(e,t){function n(n){return n?t(e.curEditor.dom).find(n).find("."+e.curEditor.config.selectCellClass):t(e.curEditor.dom).find("."+e.curEditor.config.selectCellClass)}function r(){return t(e.utils.getCurElement().pop()).closest("td,th")}function i(){var n=t(e.curEditor.dom).find("."+e.curEditor.config.selectTableClass);return n.length>0?n:t(e.utils.getCurElement().pop()).closest("table")}function a(e){var i={curTable:e,startCol:-1,endCol:-1,startRow:-1,endRow:-1},a=n(e);if(0!==a.length){var o=t(a[0]),s=t(a[a.length-1]);i.startCol=parseInt(o.attr("col")),i.startRow=parseInt(o.attr("row")),i.endCol=parseInt(s.attr("col")),i.endRow=parseInt(s.attr("row"));var l=s.attr("colspan")?parseInt(s.attr("colspan")):1,d=s.attr("rowspan")?parseInt(s.attr("rowspan")):1;i.endCol+=l-1,i.endRow+=d-1}else{a=t(r()),i.startCol=parseInt(a.attr("col")),i.startRow=parseInt(a.attr("row"));var l=a.attr("colspan")?parseInt(a.attr("colspan")):1,d=a.attr("rowspan")?parseInt(a.attr("rowspan")):1;i.endCol=i.startCol+l-1,i.endRow=i.startRow+d-1}return i.curTable=a.closest("table"),i}e.addPlugin({id:"table",type:"dialog",selectCellClass:"bke-cell-selected",selectTableClass:"bke-table-selected",tableFreshed:"",init:function(){e.utils.loadDialog(this.id,e.config.cBase.uiDir+"table/")},showDialog:function(n){var r=n?n.Eid:e.curEditor.Eid;e.dialog.open({id:"tabledialog",editor:r,title:"插入表格",content:t("[ui=tabledialog]"),ok:function(){e.dialog.revertSelection(),e.command("tabledialog")},cancel:function(){e.dialog.close("tabledialog")},icon:"succeed"})},insert:function(t){var n=t.split("-"),r={row:n[0],col:n[1],floatStyle:"",head:0,title:""},i=this.getTableHtml(r);e.coreCommand.editInsert(i)},getTableHtml:function(t){var n=50>parseInt(t.row)?parseInt(t.row):4,r=20>parseInt(t.col)?parseInt(t.col):3,i="";i=t.floatStyle?" table-"+t.floatStyle:"";var a='<table class="table '+i+'" border="1" cellpadding="0" border-style="solid" style="width:760px"><tbody>';t.title&&(a+="<caption>"+e.utils.spaceText+"</caption>");for(var o=0;n>o;o++){a+="<tr>";for(var s=0;r>s;s++)a+=t.head&&0===o?'<th row="'+o+'" col="'+s+'">'+e.utils.spaceText+"</th>":'<td row="'+o+'" col="'+s+'">'+e.utils.spaceText+"</td>";a+="</tr>"}return a+="</tbody></table>"},preInsert:function(n){var r=e.curEditor.dom.createElement("table"),i=50>parseInt(n.row)?parseInt(n.row):4,a=20>parseInt(n.col)?parseInt(n.col):3,o=4>parseInt(n.float)?parseInt(n.float):2,s=n.title?!0:!1,l=n.head?!0:!1;t(r).attr({border:1,Cellpadding:0,"border-style":"solid"}),t(r).width("100%"),s&&t(r).prepend("<caption>title</caption>");for(var d=0;i>d;d++){t(r).append("<tr></tr>");for(var c=0;a>c;c++){var u=t(r).find("tr:eq("+d+")");l&&0===d?u.append("<th row="+d+" col="+c+">"+e.utils.spaceText+"</th>"):u.append("<td row="+d+" col="+c+">"+e.utils.spaceText+"</td>")}}var f="";switch(o){case 1:f="left";break;case 2:f="none";break;case 3:f="right";break;default:f="none"}return t(r).css("float",f),r.outerHTML},insertRow:function(n){this.freshTableIndex(i());for(var r=a(),o=t(r.curTable).find("tr").first().find("th,td").length,s={},l={},d={},c=r.startRow;r.endRow>=c;c++){var u=e.curEditor.dom.createElement("tr"),f={},m=0;if("forward"===n){s=t(r.curTable).find("tr:eq("+c+")");for(var p=0;o>p;p++)d=s.find("td,th").eq(p),f=this._cloneRowCell(d,n,m),l=f.cloneCell,m=f.hideCells?f.hideCells:m-1,t(u).append(l);s.before(t(u))}else if("backward"===n){s=t(r.curTable).find("tr:eq("+r.endRow+")");for(var p=0;o>p;p++)d=s.find("td,th").eq(p),f=this._cloneRowCell(d,n,m),l=f.cloneCell,m=f.hideCells?f.hideCells:m-1,t(u).append(l);s.after(t(u))}else e.errorMessage("参数错误")}this.freshTableIndex(r.curTable,!0)},insertCol:function(n){this.freshTableIndex(i());for(var r=a(),o=t(r.curTable).find("tr").length,s={},l={},d={},c={},u=0,f=0;o>f;f++){l=t(r.curTable).find("tr:eq("+f+")");for(var m=r.startCol;r.endCol>=m;m++)"forward"===n?(s=l.find("td,th").eq(m),c=this._cloneColCell(s,n,u),d=c.cloneCell,s.before(d)):"backward"===n?(s=l.find("td,th").eq(r.endCol),c=this._cloneColCell(s,n,u),d=c.cloneCell,s.after(d)):e.errorMessage("参数错误");u=c.hideCells?c.hideCells:u-1}this.freshTableIndex(r.curTable,!0)},combineCell:function(){this.freshTableIndex(i());var r=n(),a=r.length;if(a>1){var o=t(r[a-1]).attr("colspan")?parseInt(t(r[a-1]).attr("colspan")):1,s=t(r[a-1]).attr("rowspan")?parseInt(t(r[a-1]).attr("rowspan")):1,l=parseInt(t(r[a-1]).attr("row"))-parseInt(t(r[0]).attr("row")),d=parseInt(t(r[a-1]).attr("col"))-parseInt(t(r[0]).attr("col"));t(r[0]).attr("colspan",d+o),t(r[0]).attr("rowspan",l+s),r.not(r[0]).hide(),r.not(r[0]).attr("rowspan",1).attr("colspan",1),r.not(r[0]).removeClass(e.curEditor.config.selectCellClass)}},combineColAfter:function(n){this.freshTableIndex(i());var a=r();if(a.length>0){var o=t(a[0]).attr("rowspan")?parseInt(t(a[0]).attr("rowspan")):1,s=t(a[0]).attr("colspan")?parseInt(t(a[0]).attr("colspan")):1,l=t(a[0]).nextAll("td,th").eq(s-1).not(":hidden");if(l.length>0){var d=l.attr("rowspan")?parseInt(l.attr("rowspan")):1,c=l.attr("colspan")?parseInt(l.attr("colspan")):1;if(o===d){if(n)return!0;l.attr("colspan","1").attr("rowspan","1").hide(),a.attr("colspan",s+c)}else{if(n)return!1;e.errorMessage("合并失败，单元格行跨度不一致")}}else{if(n)return!1;e.errorMessage("没有单元格可以合并")}}},combineRowAfter:function(n){this.freshTableIndex(i());var a=r();if(a.length>0){var o=t(a[0]).attr("rowspan")?parseInt(t(a[0]).attr("rowspan")):1,s=t(a[0]).attr("colspan")?parseInt(t(a[0]).attr("colspan")):1,l=parseInt(t(a[0]).attr("col")),d=t(a[0]).closest("tr").nextAll("tr:eq("+(o-1)+")").first().find("td[col="+l+"]:visible,th[col="+l+"]:visible");
if(d.length>0){var c=d.attr("rowspan")?parseInt(d.attr("rowspan")):1,u=d.attr("colspan")?parseInt(d.attr("colspan")):1;if(u===s){if(n)return!0;d.attr("colspan","1").attr("rowspan","1").hide(),a.attr("rowspan",o+c)}else{if(n)return!1;e.errorMessage("合并失败，单元格列跨度不一致")}}else{if(n)return!1;e.errorMessage("没有单元格可以合并")}}},splitCellWhole:function(n){this.freshTableIndex(i());var a="object"==typeof n?t(n):r();if(a.length>0){var o=t(a[0]).attr("rowspan")?parseInt(t(a[0]).attr("rowspan")):1,s=t(a[0]).attr("colspan")?parseInt(t(a[0]).attr("colspan")):1,l=parseInt(t(a[0]).attr("col")),d=t(a[0]).closest("tr").nextAll("tr:lt("+(o-1)+")").andSelf().find("td:lt("+(l+s)+"):gt("+(l-1)+"),th:lt("+(l+s)+"):gt("+(l-1)+")").not(":visible");d.length>0?(a.attr("colspan","1").attr("rowspan","1").addClass(e.curEditor.config.selectCellClass),d.attr("colspan","1").attr("rowspan","1").addClass(e.curEditor.config.selectCellClass).show()):e.errorMessage("没有单元格供拆分")}},splitToRows:function(n){this.freshTableIndex(i());var a="object"==typeof n?t(n):r();if(a.length>0){var o=t(a[0]).attr("rowspan")?parseInt(t(a[0]).attr("rowspan")):1,s=t(a[0]).attr("colspan")?parseInt(t(a[0]).attr("colspan")):1,l=parseInt(t(a[0]).attr("col")),d=t(a[0]).closest("tr").nextAll("tr:lt("+(o-1)+")").find("td[col="+l+"]:hidden,th[col="+l+"]:hidden");d.length>0?(a.attr("rowspan","1").addClass(e.curEditor.config.selectCellClass),s>1&&d.attr("colspan",s),d.attr("rowspan","1").addClass(e.curEditor.config.selectCellClass).show()):e.errorMessage("没有行单元格供拆分")}},splitToCols:function(n){this.freshTableIndex(i());var a="object"==typeof n?t(n):r();if(a.length>0){var o=t(a[0]).attr("rowspan")?parseInt(t(a[0]).attr("rowspan")):1,s=t(a[0]).attr("colspan")?parseInt(t(a[0]).attr("colspan")):1,l=t(a[0]).nextAll("td:lt("+(s-1)+"),th:lt("+(s-1)+")").not(":visible");l.length>0?(a.attr("colspan","1").addClass(e.curEditor.config.selectCellClass),o>1&&l.attr("rowspan",o),l.attr("colspan","1").addClass(e.curEditor.config.selectCellClass).show()):e.errorMessage("没有列单元格供拆分")}},deleteCol:function(){this.freshTableIndex(i());for(var e=a(),n=t(e.curTable).find("tr").first().find("th,td").length,r={},o={},s=e.endRow;s>=e.startRow;s--){r=t(e.curTable).find("tr:eq("+s+")");for(var l=n-1;l>=0;l--){o=r.find("td,th").eq(l);var d=this._colInfo(o);if(0>d.isInCol&&d.lastRowspan>1)if(0===d.isInCol+d.lastRowspan){var c=r.next("tr").find("[col="+l+"]");c.attr("rowspan",d.lastRowspan-1).show()}else d.lastVisibleCell.attr("rowspan",d.lastRowspan-1);o.remove()}r.remove()}this.freshTableIndex(e.curTable,!0)},deleteRow:function(){this.freshTableIndex(i());for(var e=a(),n=t(e.curTable).find("tr").length,r={},o={},s=n-1;s>=0;s--){o=t(e.curTable).find("tr:eq("+s+")");for(var l=e.endCol;l>=e.startCol;l--){r=o.find("td,th").eq(l);var d=this._rowInfo(r);if(0>d.isInRow&&d.lastColspan>1)if(0===d.isInRow+d.lastColspan){var c=r.next("td,th");c.attr("colspan",d.lastColspan-1).html("del").show()}else d.lastVisibleCell.attr("colspan",d.lastColspan-1);r.remove()}}this.freshTableIndex(e.curTable,!0)},deleteTable:function(){var e=i();t(e).remove()},tableAttrDialog:function(){var n=i(),r={};switch(n.css("float")){case"left":r.float=1;break;case"none":r.float=2;break;case"right":r.float=3;break;default:r.float=2}var a=n.find("th").length;r.head=a?!0:!1;var o=n.find("caption:first-child").length;r.title=o?!0:!1;var s=n.find("tr").length;r.row=s?s:!1;var l=n.find("tr:first").find("th,td").length;r.col=l?l:!1;var d=e.curEditor.Eid;e.dialog.open({id:"tableattrdialog",editor:d,ui:"tabledialog",title:"表格属性",content:t("[ui=tabledialog]"),ok:function(){e.command("tabledialog","changeAttr")},cancel:function(){e.dialog.close("tabledialog")},icon:"succeed"},r)},freshTableIndex:function(n,r){if(this.tableFreshed!==t(n)[0]||r===!0){var i=e.utils.getSelectionRange(e.curEditor.win,"node"),a=n?t(n):t(e.curEditor.dom).find("table");a.each(function(){var e=[],n=0,r=0,i=0;t(this).find("td:hidden,th:hidden").remove();var a=t(this).find("tr");a.each(function(){var a=t(this).find("td,th");void 0===e[r]&&(e[r]=[]),a.each(function(){for(var i=t(this).attr("colspan")?parseInt(t(this).attr("colspan")):1,a=t(this).attr("rowspan")?parseInt(t(this).attr("rowspan")):1,o=n;void 0!==e[r][o];)o+=1;if(e[r][o]=t(this),i>1||a>1){for(;i>1;){var s=t(this).clone(!0);s.attr("colspan","1").attr("rowspan","1"),s.html(" ").hide(),e[r][o+i-1]=s;for(var l=a;l>1;){var d=t(this).clone(!0);d.attr("colspan","1").attr("rowspan","1"),d.html(" ").hide(),void 0===e[r+l-1]&&(e[r+l-1]=[]),e[r+l-1][o+i-1]=d,l-=1}i-=1,t(this).after(s)}for(;a>1;){var d=t(this).clone(!0);d.attr("colspan","1").attr("rowspan","1"),d.html(" ").hide(),void 0===e[r+a-1]&&(e[r+a-1]=[]),e[r+a-1][o]=d,a-=1}}n+=1}),i=Math.max(i,e[r].length),r+=1,n=0});for(var o=e.length,s=t(this).find("tr").length;o>s;)t(this).append("<tr></tr>"),s+=1;for(var l=0;o>l;l++)for(var d=Math.max(i,e[l].length),c=t(this).find("tr:eq("+l+")"),u=0;d>u;u++)void 0===e[l][u]&&(e[l][u]=t('<td row="'+l+'" col="'+u+'"></td>')),e[l][u].attr("row",l).attr("col",u),c.append(e[l][u])}),e.utils.setSelectionRange(e.curEditor.win,i,"node"),this.tableFreshed=n?t(n)[0]:""}},toggleHead:function(n){var r=i();if((void 0===n||""===n)&&(n=0!==t(r).find("tr:first").find("th").length?!0:!1),n||0!==t(r).find("tr:first").find("th").length)n&&0!==t(r).find("tr:first").find("th").length&&(t(r).find("tr:first").remove(),this.freshTableIndex(r,!0));else{for(var a=t(r).find("tr:first").find("td").length,o=e.curEditor.dom.createElement("tr"),s=[],l=0;a>l;l++)s[l]=e.curEditor.dom.createElement("th"),s[l].innerHTML="&#8203;",t(o).append(s[l]);t(r).find("tr:first").before(o),e.utils.setCursor(e.curEditor.win,s[0],!0),this.freshTableIndex(r,!0)}},toggleTitle:function(n){var r=i();if((void 0===n||""===n)&&(n=0!==t(r).find("caption:first-child").length?!0:!1),n||0!==t(r).find("caption:first-child").length)n&&0!==t(r).find("caption:first-child").length&&t(r).find("caption:first-child").remove();else{var a=e.curEditor,o=a.dom.createElement("caption");o.innerHTML="&#8203;",t(r).prepend(o),e.utils.setCursor(a.win,o,!0)}},changeTableAttr:function(e){var n=i(),r=4>parseInt(e.float)?parseInt(e.float):2,a=e.title?!0:!1,o=e.head?!0:!1;this.toggleTitle(!a),this.toggleHead(!o);var s="";switch(r){case 1:s="left";break;case 2:s="none";break;case 3:s="right";break;default:s="none"}t(n).css("float",s)},cellJustify:function(e){var i="",a="";switch(e=parseInt(e)){case 1:i="left",a="top";break;case 2:i="center",a="top";break;case 3:i="right",a="top";break;case 4:i="left",a="middle";break;case 5:i="center",a="middle";break;case 6:i="right",a="middle";break;case 7:i="left",a="bottom";break;case 8:i="center",a="bottom";break;case 9:i="right",a="bottom";break;default:i="center",a="middle"}var o=n();(0!==t(o).length||(o=r(),0!==t(o).length))&&(t(o).css("text-align",i),t(o).css("vertical-align",a))},cellColor:function(n){var r=t(e.curEditor.dom).find("body table ."+e.curEditor.config.selectCellClass);0===r.length&&(r=t(e.utils.getCurElement().pop()).closest("td,th")),r.css("background-color",n)},tableFloat:function(e){var n="";switch(e=parseInt(e)){case 1:n="left";break;case 2:n="none";break;case 3:n="right";break;default:n="none"}var r=i();t(r).css("float",n)},_cloneRowCell:function(t,n,r){var i={},a=t.clone().html("newcell"),o="forward"===n?!0:!1,s=this._rowInfo(t);if(0>s.isInRow)!o&&s.addRowspan>1?(a.hide(),0===s.isInRow+s.lastColspan&&s.lastVisibleCell.attr("rowspan",s.addRowspan+1)):a.show();else{var l=this._colInfo(t);0>l.isInCol?l.lastRowspan>1?!o&&-1>l.isInCol||o&&l.isInCol+l.lastRowspan>0?(a.hide(),i.hideCells=l.addColspan,l.lastVisibleCell.attr("rowspan",l.lastRowspan+1)):a.show():a.show():r>0?a.hide():a.show()}return a.removeClass(e.curEditor.config.selectCellClass),a.attr("colspan",1).attr("rowspan",1),a.attr("col",-1).attr("row",-1),i.cloneCell=a,i},_cloneColCell:function(t,n,r){var i={},a=t.clone().html("&#8203;"),o="forward"===n?!0:!1,s=this._colInfo(t);if(0>s.isInCol)!o&&s.addColspan>1?(a.hide(),0===s.isInCol+s.lastRowspan&&s.lastVisibleCell.attr("colspan",s.addColspan+1)):a.show();else{var l=this._rowInfo(t);0>l.isInRow?l.lastColspan>1?!o&&-1>l.isInRow||o&&l.isInRow+l.lastColspan>0?(a.hide(),i.hideCells=l.addRowspan,l.lastVisibleCell.attr("colspan",l.lastColspan+1)):a.show():a.show():r>0?a.hide():a.show()}return a.removeClass(e.curEditor.config.selectCellClass),a.attr("colspan",1).attr("rowspan",1),a.attr("col",-1).attr("row",-1),i.cloneCell=a,i},_rowInfo:function(e){var t={};t=0!==e.not(":visible").length?e.prevAll(":visible").first():e;var n=0===t.length?-1:parseInt(t.attr("col")),r=t.attr("colspan")?parseInt(t.attr("colspan")):1,i=t.attr("rowspan")?parseInt(t.attr("rowspan")):1,a=parseInt(e.attr("col"))-n-r;return{isInRow:a,lastColspan:r,addRowspan:i,lastVisibleCell:t}},_colInfo:function(e){var t={};t=0!==e.not(":visible").length?e.closest("table").find("[col="+parseInt(e.attr("col"))+"]:lt("+parseInt(e.attr("row"))+")").not(":hidden").last():e;var n=0===t.length?-1:parseInt(t.attr("row")),r=t.attr("rowspan")?parseInt(t.attr("rowspan")):1,i=t.attr("colspan")?parseInt(t.attr("colspan")):1,a=parseInt(e.attr("row"))-n-r;return{isInCol:a,lastRowspan:r,addColspan:i,lastVisibleCell:t}}})}(window.jQuery.jQEditor,window.jQuery),function(e){e.addPlugin({id:"ulmenu",type:"panel",isEnable:!0,fill:function(t){var n="",r=[{name:"小圆圈",cmd:"insertunorderedlist",param:"disc"},{name:"小圆点",cmd:"insertunorderedlist",param:"circle"},{name:"小方块",cmd:"insertunorderedlist",param:"square"}];n=e.Menu.create(r),e.fillPanel("insertunorderedlistmenu",n,t)}})}(window.jQuery.jQEditor),function(e,t){var n=(location.hostname,[]);e.addPlugin({id:"uploadremoteimage",domains:[location.hostname],click:function(){r.check(e.curEditor.dom)}});var r={index:0,check:function(r){var i,a,o=r.getElementsByTagName("img"),s=e.plugin("uploadremoteimage"),l=0,d=o.length;for(n=[],l=0;d>l;l++)i=e.$(o[l]).attr("src"),a=this.getHostname(i),a&&t.inArray(a,s.domains)&&n.push(o[l]);n.length?(e.message("有 "+n.length+" 张图片等待上传，请稍等..."),this.upload()):e.message("未检测到需要上传的图片")},getHostname:function(e){var n,r="";return e=t.trim(e),/^https?:/i.test(e)&&(n=e.split("/"),r=n[2]),r},upload:function(){var r=this,i=n.shift(),a=t(i).attr("src"),o="/upload.php?action=saveFromUrl";r.index+=1,t.ajax({type:"POST",url:o,data:{saveFromUrl:a},dataType:"json",success:function(t){e.$(i).attr("src",t.url)},complete:function(){n.length?(e.message("第 "+r.index+" 张图片上传完成"),setTimeout(function(){r.upload()},500)):(r.index=0,e.message("所有图片上传完成"))}})}}}(jQuery.jQEditor,jQuery),function(e){e.addUi({id:"videodialog",html:'<table width="300">			<tr>			<td>视频地址：</td>			<td><input type="text" name="url" style="width:200px"/></td>			</tr><tr>			<td>宽：</td>			<td><input type="text" name="width" value="800" style="width:60px"/> px</td>			</tr><tr>			<td>高：</td>			<td><input type="text" name="height" value="600" style="width:60px"/> px</td>			</tr></table>',check:function(){},submit:function(){var t=this.getValues();if(t.url){var n='<embed src="'+t.url+'" quality="high" width="'+t.width+'" height="'+t.height+'" align="middle" allowScriptAccess="sameDomain" allowFullscreen="true" type="application/x-shockwave-flash"></embed>';e.utils.pasteHTML(n)}}}),e.addPlugin({id:"video",title:"视频",ui:"videodialog",type:"dialog",getData:function(){var e={};return e}})}(jQuery.jQEditor,jQuery);