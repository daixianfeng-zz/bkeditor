/*! Bkeditor - v0.9.0 - 2013-07-30
* https://github.com/daixianfeng/bkeditor
* Copyright (c) 2013 daixianfeng;*/
(function(e){function t(t){var r=this;this.state="init",t.id=t.id?t.id:"bkeditor_"+(new Date).getTime(),this.Eid=t.id,n.editorList[this.Eid]=this,this.config=e.extend(!0,{},n.config,t),n.curEditor=this,n.curId=this.Eid,this.pasteToText=!1,this.pasteToWord=!1,this.revertList=[],this.redoList=[],this.cursorElements={},n.create(this,function(){var i=r.config;r.baseEvent=new n.EditorEvent(r),r.baseHistory=new n.EditorHistory(r),r.baseFilter=new n.EditorFilter(r),r.pluginEnable=n.configPlugin(i),r.toolbar=new n.Toolbar(r),r.fillPanel();var o=i.oriHtml,a=n.utils.filterInner(r,o);r.dom.body.innerHTML=a,e(r.dom.body).css(i.bodyStyle),r.baseFilter.excute("dom"),r.baseHistory.setFirstHistory(r.dom.body.innerHTML),r.state="ready",n.trigger("complete",{Eid:t.id}),e(i.textarea).closest("form").submit(function(){e(i.textarea).val(r.getContent())})})}var n={IE:window.VBArray?!0:!1,IE6:window.VBArray&&!window.XMLHttpRequest?!0:!1,state:"loading",editorList:{},curId:"",curEditor:{},curToolbar:jQuery(),log:{},error:{},pluginList:{},uiList:{},lang:{},listenEditarea:{},listenEditareaExt:{},addFilter:function(){},coreCommand:{},command:function(){},histroy:{},utils:{},load:{},toolbar:{},toolbarPanel:{},dialogHtml:{},dialog:{},themeList:{toolbar:{},editArea:{}},init:function(){},create:function(t,n){var r=this,i=t.config,o=null,a=+new Date,s='<div id="'+i.id+'" ref="editor" style="width:'+i.editWidth+';">';if(s+='<div class="bke-toolbarbox" ref="'+i.id+'"></div>',s+='<div class="bke-contentarea">',s+='<div class="bke-iframeholder" style="height:'+i.editHeight+';"></div>',s+='<div class="bke-bottombar">',s+='<span class="bke-elementpath">元素路径：<a>body</a></span>',s+='<span class="bke-wordcount">字数统计</span>',s+="</div>",s+="</div>",s+="</div>",i.position instanceof jQuery)i.position.before(s),i.position.hide(),o=i.position;else{i.position.content.before(s);var l=i.position.content.prev().find(".bke-toolbarbox");i.position.toolbar.append(l),i.position.content.hide(),o=i.position.content}i.textarea=o,0===e(document.body).find("#ui-dialog").length&&e(document.body).append('<div id="ui-dialog" style="display:none;"></div>');var c=document.createElement("iframe");e(c).height(i.editHeight).attr({frameBorder:0,tabIndex:"0",width:"100%",scrolling:i.editScroll}).addClass("show-content"),e("#"+i.id).find(".bke-iframeholder").append(c).append(o).append('<div class="bke-shortcutmenu"></div>').append('<a class="bke-selecttablebar"></a>');var d=c.contentWindow,u=d.document;u.open();var f='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" ';f+='"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">',f+="<html><head>",f+='<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />',f+='<link rel="stylesheet" type="text/css" href="'+i.cBase.skinDir+'skin-inner.css">',f+="<!--[if IE]>",f+='<script type="text/javascript" src="'+i.cBase.ieDir+"DOMRange.js?"+a+'"></script>',f+="<![endif]-->",f+='</head><body contentEditable="true" style="height:98%"></body></html>',u.write(f),u.close(),r.editWin=d,r.editDom=u,t.win=d,t.dom=u,r.themeList.toolbar[i.skin]||(r.loadCss(i.cBase.skinDir+i.skin+"/skin.css"),r.themeList.toolbar[i.skin]=!0);var m=setInterval(function(){if(r.editWin.getSelection!==void 0){var t="toolbar";i.toolbar&&"default"!==i.toolbar&&(t+="_"+i.toolbar);var o=i.cBase.skinDir+i.skin+"/"+t+".json";r[o]?(e('[ref="'+i.id+'"].bke-toolbarbox').html(r[o]),n&&n()):e.get(o,function(t){e('[ref="'+i.id+'"].bke-toolbarbox').html(t),n&&n(),r[o]=t}),clearInterval(m)}},50)},trigger:function(){},fillPanel:function(e,t){this.toolbar.fillPanel?this.toolbar.fillPanel(e,t):this.toolbarPanel[e]=t},getAttr:function(){},focus:function(){var e=this.curId;this.editorList[e]&&this.editorList[e].focus()},lock:function(){},unlock:function(){},destroy:function(e){this.editorList[e]&&this.editorList[deId].destroy()},ready:function(t){var n=this,r="",i="";"ready"!==n.state?(r=setInterval(function(){var t=n.error.ready&&n.log.ready&&n.load.ready&&n.utils.ready&&n.command.ready&&n.EditorEvent.ready&&n.EditorFilter.ready&&n.EditorHistory.ready&&n.addPlugin.ready&&n.addUi.ready&&n.dialog.ready;if(t===!0){n.state="ready";var i="";i+="<!--[if IE]>",i+='<script type="text/javascript" src="'+n.config.cBase.ieDir+'DOMRange.js?"></script>',i+="<![endif]-->",e("head").append(i),clearInterval(r)}},50),i=setInterval(function(){"ready"===n.state&&(t&&t(),clearInterval(i))},50)):t&&t()},getLang:function(t){var n=this.lang;t=(t||"").split(".");for(var r,i=0;(r=t[i++])&&(n=n[r],n););return void 0===n&&e.browser.mozilla&&console.log(t[t.length-1]),void 0===n?t[t.length-1]:n},errorMessage:function(e){this.curEditor.error(e)},message:function(e,t){this.curEditor.error(e,"green",t)},get:function(e){switch(e){case"editor":return n.curEditor;case"list":return n.editorList;case"window":return n.curEditor.win;case"document":return n.curEditor.dom;case"body":return n.curEditor.dom.body}},$:function(t){return e(t,this.curEditor.dom)},loadCss:function(t){var n=document.createElement("link");n.setAttribute("type","text/css"),n.setAttribute("rel","stylesheet"),n.setAttribute("href",t),e("head")[0].appendChild(n)}};n.init(),e.jQEditor=n;var r=function(e){return n.trigger("create",{Eid:e.id}),new t(e)};t.prototype={pluginEnable:{},ready:function(e){var t=this,n="";"ready"!==t.state?n=setInterval(function(){"ready"===t.state&&(e(),clearInterval(n))},50):e()},fillPanel:function(){try{for(var e in n.pluginList)n.pluginList[e].fill()}catch(t){n.error.writeError("fill panel error: "+t.message+(t.stack?t.stack:""),3,"plugin")}},changeTheme:function(e,t){"editArea"!==t&&typeof n.themeList.toolbar[e]===!1,"toolbar"!==t&&typeof n.themeList.editArea[e]===!1},getContent:function(){var e=this.dom.body.innerHTML;return n.utils.filterInner(this,e)},setContent:function(e){this.dom.body.innerHTML=e,this.baseFilter.excute("dom")},enable:function(){},disable:function(){},execCommand:function(){},queryCommandState:function(){},queryCommandValue:function(){},insert:function(e){n.command("insert",e)},error:function(t,n,r){n=n||"red","number"==typeof n&&(r=n,n="red"),r=r||3e3;var i=e("#"+this.Eid).find(".bke-message");i.stop().text(t).css({color:n}).fadeIn(200),clearTimeout(this.timer),this.timer=setTimeout(function(){i.fadeOut(100)},r)},selectAll:function(){return this.dom.execCommand("selectAll"),this.win.focus(),this},focus:function(){return this.win.focus(),this},getCursorElement:function(){var e=n.utils.getCurElement();return e.pop()},getRange:function(){return n.utils.getSelectionRange(this.win)},getSelectionText:function(){var e=n.utils.getSelectionRange(this.win);return""+e},insertNode:function(e){var t=n.utils.getSelectionRange(this.win);t.insertNode(e)},setCursor:function(e){n.utils.setCursor(this.win,e,!0)},selectNode:function(e){n.utils.selectNode(this.win,e)}},e.editor=r,n.ready(function(){e("textarea.bkeditor").each(function(t,n){var i=e(n),o=(new Date).getTime(),a=i.attr("id")?i.attr("id")+"_":"bkeditor_",s=r({id:a+o,toolbar:i.data("toolbar"),position:i,editWidth:i.css("width"),editHeight:i.css("height"),oriHtml:i.val()});i.data("editor",s)})})})(window.jQuery),function(e,t){var n="http://localhost/bkeditor/",r=!1,i=!1,o=!0,a={all:["codemirror","bold","italic","superscript","subscript","baikelink","strikethrough","underline","removeformat","formatmatch","tolowercase","touppercase","undo","redo","h2","h3","blockquote","fontsizemenu","fontfamilymenu","justifyleft","justifycenter","justifyright","pastetotext","pasteword","image","map","preview","cleardoc","reference","inserttime","insertdate","highlightcode","insertvideo","inserttablemenu","tableprops","combinecells","combinecolafter","combinerowafter","splittocols","splittorows","splittocells","insertcolbefore","insertcolafter","insertrowbefore","insertrowafter","deleterow","deletecol","deletetable","specharsmenu","link","anchor","backcolor","forecolor","linespacemenu","spacebottommenu","spacetopmenu","outdent","indent","insertunorderedlist","insertorderedlist","source","autoformat","search","about"],base:["bold","italic","underline","strikethrough","superscript","subscript","lowercase","uppercase","redo","undo","pastetotext","pasteword","specharsmenu","link","backcolor","forecolor","fontsizemenu","fontfamilymenu","insertunorderedlist","insertorderedlist","source","search"]},s=["bold","italic","superscript","subscript","baikelink","strikethrough","underline","formatmatch","h2","h3","blockquote","fontsizemenu","fontfamilymenu","pasteword","image","map","reference","highlightcode","insertvideo","inserttablemenu","specharsmenu","link","anchor","backcolor","forecolor","linespacemenu","spacebottommenu","spacetopmenu","outdent","indent","insertunorderedlist","insertorderedlist","forecolormenu"],l={a:s,table:["h2","h3"],hn:s,sub:s,sup:s,pre:s,img:s,selectedTable:[]},c={version:"0.9.0",rootDir:n,cBase:{libDir:n+"libs/",ieDir:n+"src/core/base/ie/",pluginDir:n+"src/core/plugin/",uiDir:n+"src/core/ui/",skinDir:n+"src/skin/",isLog:r,isError:i,lang:"zh-cn",plupload:{max_file_size:"10mb",url:"/plupload.php",pluploadswf:n+"libs/plupload/plupload.swf"},ajaxupload:{uploadUrl:"../upload.php?action=saveFromDrag"}},cEvent:{whiteList:[],blackList:[]},cPlugin:{whiteList:[],blackList:[]},cUi:{},cFilter:{whiteList:["block","combine","replace","space"],blackList:[]},cHistory:{onHistory:o,length:100},cError:{onError:i,errorSendAddr:"",length:1},cLog:{onLog:r,logSendAddr:"",length:10},cTools:a,cTagDisable:l,toolbar:"",skin:"default",cSkin:{},editWidth:"auto",editHeight:"auto",editScroll:"no",position:"",oriHtml:"<p><br /></p>",selectTableClass:"bke-table-selected",selectCellClass:"bke-cell-selected",selectImgClass:"bke-img-selected",autoHeight:1,height:200,fixedClassName:"bke-toolbar-fixed",bodyStyle:{"font-size":"14px","font-family":"SimSun"}};e.config=t.extend(!0,{},e.config,c)}(jQuery.jQEditor,jQuery),function(e,t){var n="./code/bke/0.9.0/",r=window.location.search;-1===r.search("debug=true")&&(n="./code/dist/0.9.0/");var i={rootDir:n,cBase:{libDir:n+"libs/",ieDir:n+"ie/",pluginDir:n+"plugin/",uiDir:n+"ui/",skinDir:n+"skin/"}};e.config=t.extend(!0,{},e.config,i)}(jQuery.jQEditor,jQuery),function(e,t){var n={cCommand:{textCommand:{bold:{cmd:"strong",param:"",icon:"browserChecked"},italic:{cmd:"em",param:"",icon:"browserChecked"},underline:{cmd:"text-decoration",param:"underline",icon:"browserChecked"},strikethrough:{cmd:"text-decoration",param:"line-through",icon:"browserChecked"},superscript:{cmd:"sup",param:"",icon:"customChecked"},subscript:{cmd:"sub",param:"",icon:"customChecked"},fontsize:{cmd:"font-size",param:"",icon:"customValue"},fontfamily:{cmd:"font-family",param:"",icon:"customValue"},forecolor:{cmd:"color",param:"",icon:"customValue"},backcolor:{cmd:"background-color",param:"",icon:"customValue"},tolowercase:{cmd:"wordcase",param:"lower",icon:""},touppercase:{cmd:"wordcase",param:"upper",icon:""}},paragraphCommand:{justifyleft:{cmd:"text-align",param:"left",icon:"customChecked"},justifycenter:{cmd:"text-align",param:"center",icon:"customChecked"},justifyright:{cmd:"text-align",param:"right",icon:"customChecked"},justifyfull:{cmd:"text-align",param:"justify",icon:"customChecked"},insertorderedlist:{cmd:"ol",param:"",icon:"customValue"},insertunorderedlist:{cmd:"ul",param:"",icon:"customValue"},spacetop:{cmd:"margin-top",param:"",icon:""},spacebottom:{cmd:"margin-bottom",param:"",icon:""},linespace:{cmd:"line-height",param:"",icon:""},outdent:{cmd:"padding-left",param:"-14px",icon:""},indent:{cmd:"padding-left",param:"14px",icon:""}},pluginCommand:{icon:{cmd:"icon",param:"",icon:""},element:{cmd:"element",param:"",icon:""},redo:{cmd:"redo",param:"",icon:""},undo:{cmd:"revert",param:"",icon:""},cut:{cmd:"paste",param:"cut",icon:""},copy:{cmd:"paste",param:"copy",icon:""},paste:{cmd:"paste",param:"",icon:""},pastetotext:{cmd:"paste",param:"toggleTextpaste",icon:""},removeformat:{cmd:"font",param:"clear",icon:""},formatmatch:{cmd:"font",param:"toggleBrush",icon:""},brush:{cmd:"font",param:"brush",icon:""},boldmenu:{cmd:"boldmenu",param:"",icon:""},forecolormenu:{cmd:"colormenu",param:"forecolor",icon:""},backcolormenu:{cmd:"colormenu",param:"backcolor",icon:""},fontsizemenu:{cmd:"fontsizemenu",param:"",icon:""},fontfamilymenu:{cmd:"fontfamilymenu",param:"",icon:""},spacebottommenu:{cmd:"spacemenu",param:"bottom",icon:""},spacetopmenu:{cmd:"spacemenu",param:"top",icon:""},linespacemenu:{cmd:"spacemenu",param:"line",icon:""},h2:{cmd:"hn",param:"h2",icon:"customChecked"},h3:{cmd:"hn",param:"h3",icon:"customChecked"},blockquote:{cmd:"blockquote",param:"h3",icon:"customChecked"},image:{cmd:"image",param:"",icon:""},imageFloat:{cmd:"image",param:"imgFloat",icon:""},link:{cmd:"link",param:"",icon:""},map:{cmd:"map",param:"",icon:""},insertvideo:{cmd:"video",param:"",icon:""},pasteword:{cmd:"pasteword",param:"",icon:""},specharsmenu:{cmd:"specharsmenu",param:"",icon:""},baikelink:{cmd:"baikelink",param:"",icon:""},inserttable:{cmd:"table",param:"",icon:"tableChecked"},inserttablemenu:{cmd:"tablemenu",param:"",icon:"tableChecked"},inserttime:{cmd:"inserttime",param:"",icon:""},datemenu:{cmd:"datemenu",param:"",icon:""},insertdate:{cmd:"datemenu",param:"",icon:""},multiimage:{cmd:"",param:"",icon:""},insertunorderedlistmenu:{cmd:"ulmenu",param:"",icon:""},insertorderedlistmenu:{cmd:"olmenu",param:"",icon:""},combinecells:{cmd:"table",param:"combineCell",icon:"tableChecked"},combinecolafter:{cmd:"table",param:"combineColAfter",icon:"tableChecked"},combinerowafter:{cmd:"table",param:"combineRowAfter",icon:"tableChecked"},splittocols:{cmd:"table",param:"splitToCols",icon:"tableChecked"},splittorows:{cmd:"table",param:"splitToRows",icon:"tableChecked"},splittocells:{cmd:"table",param:"splitCellWhole",icon:"tableChecked"},insertcolbefore:{cmd:"table",param:"insertCol",args:"forward",icon:"tableChecked"},insertcolafter:{cmd:"table",param:"insertCol",args:"backward",icon:"tableChecked"},insertrowbefore:{cmd:"table",param:"insertRow",args:"forward",icon:"tableChecked"},insertrowafter:{cmd:"table",param:"insertRow",args:"backward",icon:"tableChecked"},deleterow:{cmd:"table",param:"deleteCol",icon:"tableChecked"},deletecol:{cmd:"table",param:"deleteRow",icon:"tableChecked"},deletetable:{cmd:"table",param:"deleteTable",icon:"tableChecked"},tableprops:{cmd:"table",param:"tableAttrDialog",icon:"tableChecked"},cellcolor:{cmd:"table",param:"cellColor",icon:""},celljustify:{cmd:"table",param:"cellJustify",icon:""},tablefloat:{cmd:"table",param:"tableFloat",icon:""},tablehead:{cmd:"table",param:"toggleHead",icon:""},tabletitle:{cmd:"table",param:"toggleTitle",icon:""},reference:{cmd:"",param:"",icon:""},highlightcode:{cmd:"highlightcode",param:"",icon:""},cleardoc:{cmd:"cleardoc",param:"",icon:""},preview:{cmd:"",param:"",icon:""},source:{cmd:"source",param:"",icon:""},anchor:{cmd:"anchor",param:"",icon:""},autoformat:{cmd:"autoformat",param:"",icon:""},selectall:{cmd:"selectall",param:"",icon:""},insertparagraphbefore:{cmd:"insertparagraph",param:"before",icon:""},insertparagraphafter:{cmd:"insertparagraph",param:"after",icon:""},codemirror:{cmd:"codemirror",param:"",icon:""},about:{cmd:"about",param:"",icon:""},search:{cmd:"search",param:"",icon:""},shortcutmenu:{cmd:"shortcutmenu",param:"",icon:""},dragimage:{cmd:"dragimage",param:"",icon:""},ajaxupload:{cmd:"ajaxupload",param:"",icon:""},replace:{cmd:"search",param:"",icon:""},uploadremoteimage:{cmd:"uploadremoteimage",param:"",icon:""},insertcode:{cmd:"insertcode",param:"",icon:""},insertcodemenu:{cmd:"insertcodemenu",param:"",icon:""}},insertCommand:{insert:{cmd:"insert",param:"",icon:""},spechars:{cmd:"insert",param:"",icon:""}},uiCommand:{codedialog:{cmd:"codedialog",param:"",icon:""},imagedialog:{cmd:"imagedialog",param:"",icon:""},tabledialog:{cmd:"tabledialog",param:"",icon:""},videodialog:{cmd:"videodialog",param:"",icon:""},linkdialog:{cmd:"linkdialog",param:"",icon:""},mapdialog:{cmd:"mapdialog",param:"",icon:""},pasteworddialog:{cmd:"pasteworddialog",param:"",icon:""},sourcedialog:{cmd:"sourcedialog",param:"",icon:""},searchdialog:{cmd:"searchdialog",param:"",icon:""},aboutdialog:{cmd:"aboutdialog",param:"",icon:""},anchordialog:{cmd:"anchordialog",param:"",icon:""}}}};e.config=t.extend({},e.config,n)}(window.jQuery.jQEditor,window.jQuery);var DTD=function(){function e(e){for(var t in e)e[t.toUpperCase()]=e[t];return e}function t(e){for(var t=arguments,n=1;t.length>n;n++){var r=t[n];for(var i in r)e.hasOwnProperty(i)||(e[i]=r[i])}return e}var n=e({address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1,li:1,noscript:1}),r=e({area:1,base:1,br:1,col:1,hr:1,img:1,input:1,link:1,meta:1,param:1,embed:1}),i=e({iframe:1,sub:1,img:1,embed:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1,b:1,acronym:1,bdo:1,"var":1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1,ins:1,del:1,script:1,style:1,input:1,button:1,select:1,textarea:1,label:1,a:1}),o=e({strong:1,em:1,sub:1,sup:1,span:1,b:1,i:1,u:1,font:1,tt:1,big:1,small:1,q:1,code:1,cite:1,dfn:1,samp:1,kbd:1,abbr:1,acronym:1,bdo:1});return e({$block:t({},n),$inline:t(e({a:0}),i),$font:o,$body:t(e({script:1,style:1}),n),$cdata:e({script:1,style:1}),$empty:r,$nonChild:e({iframe:1,textarea:1}),$listItem:e({dd:1,dt:1,li:1}),$list:e({ul:1,ol:1,dl:1}),$isNotEmpty:e({table:1,ul:1,ol:1,dl:1,iframe:1,area:1,base:1,col:1,hr:1,img:1,embed:1,input:1,link:1,meta:1,param:1}),$emptyInline:e({hr:1,br:1,img:1,embed:1}),$removeEmpty:e({a:1,abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1}),$removeEmptyBlock:e({p:1,div:1,ol:1,ul:1,dl:1}),$tableContent:e({caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1,table:1}),$notTransContent:e({pre:1,script:1,style:1,textarea:1}),$paragraph:t(e({body:0,legend:1,caption:1,dl:0,ul:0,ol:0,dir:0,div:0,table:0}),n),html:e({body:1,script:1}),body:t(e({child:"p"}),n,i),ul:t(e({li:1,ol:2,dir:2,child:"li"}),n),ol:t(e({li:1,ul:2,dir:2,child:"li"}),n),li:t(e({li:0,parent:"ul"}),n,i),dir:e({li:1,ul:2,ol:2,child:"dd"}),dl:e({dt:1,dd:1,child:"dd"}),dt:t(e({dd:2,parent:"dl"}),i),dd:t(e({dt:2,parent:"dl"}),i,n),table:e({thead:1,tbody:1,tfoot:1,tr:1,colgroup:1,caption:1,col:1,child:"tbody"}),tbody:e({thead:2,tfoot:2,tr:1,parent:"table",child:"tr"}),tfoot:e({thead:2,tbody:2,tr:1,parent:"table",child:"tr"}),thead:e({tbody:2,tfoot:2,tr:1,parent:"table",child:"tr"}),caption:t(e({parent:"table"}),i),colgroup:e({col:1,parent:"table"}),col:{},tr:e({td:1,th:1,parent:"tbody",child:"td"}),td:t(e({th:2,parent:"tr"}),n,i),th:t(e({td:2,parent:"tr"}),n,i),center:t(n,i),p:i,h1:i,h2:i,h3:i,h4:i,h5:i,h6:i,div:t(e({child:"p"}),n,i),pre:t(e({img:0,object:0,big:0,small:0,sub:0,sup:0}),i),blockquote:n,noscript:t(n,i),address:i,fieldset:t(e({legend:1}),n,i),legend:i,form:t(e({form:0}),n,i),img:{},span:e({br:1}),i:e({span:1,em:3,cite:2}),cite:e({span:1,em:3,i:3}),b:e({span:1,em:1,strong:3}),em:e({span:1,i:2,cite:2}),u:e({span:1,i:1,cite:1}),strong:e({span:1,em:1,cite:1,i:1,b:2}),sub:e({span:1,em:1,cite:1,i:1,sup:2,strong:1}),sup:e({span:1,em:1,cite:1,i:1,sub:2,strong:1}),big:e({span:1,em:1,cite:1,i:1,sub:1,sup:1,strong:1,small:2}),small:e({span:1,em:1,cite:1,i:1,sub:1,sup:1,strong:1,big:2}),font:e({span:1,em:1,cite:1,i:1,sub:1,sup:1,strong:1,small:1,big:1}),code:e({span:1,em:1,cite:1,i:1,sub:1,sup:1,strong:1,small:1,big:1,font:1,samp:2}),samp:e({span:1,em:1,cite:1,i:1,sub:1,sup:1,strong:1,small:1,big:1,font:1,code:2}),tt:t(e({tt:0,kbd:2}),i),kbd:t(e({kbd:0,tt:2}),i),dfn:t(e({dfn:0}),i),abbr:t(e({abbr:0}),i),acronym:t(e({acronym:0}),i),q:t(e({q:0}),i),bdo:t(e({bdo:0}),i),label:t(e({label:0}),i),br:{},hr:{},input:{},textarea:{},iframe:{},a:t(e({a:0}),i),select:e({optgroup:1,option:1}),optgroup:e({option:1}),option:{},object:t(e({param:1}),n,i),param:{},map:t(e({area:1}),n),area:{},button:t(e({a:0,input:0,select:0,textarea:0,label:0,button:0,form:0,fieldset:0}),n,i)})}();(function(e,t){var n={enabled:!0,length:1,sendAddr:"",errorList:[],errorCache:{},initError:function(e){this.enabled=e.onError?!0:!1,this.sendAddr=e.sendAddr,this.length=e.length},writeError:function(t,n,r,i){var o=new Date;i=i||""+o;var a="level"+n+" error:"+r+' module "'+t+'" at '+i;this.errorList.push(a),this.enabled&&window.console&&window.console.error(a);for(var s=0;this.errorList.length>s;s++)this.errorList[s]!==a&&(this.sendError(),e.log.sendLog(),this.errorList.shift())},sendError:function(){var e=this;t.ajax({type:"POST",url:e.sendAddr,data:{errorList:e.errorList},success:function(){e.errorList=[]}})}};n.initError(e.config.cError),n.ready=!0,e.error=n})(window.jQuery.jQEditor,window.jQuery),function(e){var t=function(e){this.initHistory(e),this.redoList=[],this.revertList=[],this.lastRecordTime=+new Date};t.prototype={frameBody:{},enabled:!0,length:3,redoState:!1,revertState:!1,initHistory:function(e){this.enabled=e.config.cHistory.onHistory?!0:!1,this.length=e.config.cHistory.times,this.frameBody=e.dom.body,this.lastHistory={historyHtml:e.config.oriHtml,historySelect:""},this.win=e.win},getLastTime:function(){return this.lastRecordTime},setFirstHistory:function(e){this.redoList=[],this.revertList=[],this.lastHistory={historyHtml:e,historySelect:""}},emptyRedo:function(){this.redoList=[]},prepareHistory:function(){this.lastHistory.historySelect=e.utils.getSelectionOffset(this.win)},recordHistory:function(e){e=e?1:0;var t=this.lastHistory.historyHtml!==this.frameBody.innerHTML,n=this.lastHistory.historyHtml.length-this.frameBody.innerHTML.length;if(n>3||-3>n||t&&1===e){var r={};r.historyHtml=this.frameBody.innerHTML,this.lastHistory&&this.revertList.push(this.lastHistory),this.lastHistory=r,this.revertList.length>this.length&&this.revertList.unshift(),this.emptyRedo()}this.changeState(),this.lastRecordTime=+new Date},redo:function(){var t=this.redoList.pop();t&&(this.lastHistory&&this.revertList.push(this.lastHistory),this.lastHistory=t,this.frameBody.innerHTML=t.historyHtml,e.utils.setSelectionByOffset(this.win,t.historySelect),this.revertList.length>this.length&&this.revertList.unshift()),this.changeState()},revert:function(){var t=this.revertList.pop();t&&(this.lastHistory&&this.redoList.push(this.lastHistory),this.lastHistory=t,this.frameBody.innerHTML=t.historyHtml,e.utils.setSelectionByOffset(this.win,t.historySelect),this.redoList.length>this.length&&this.redoList.unshift()),this.changeState()},changeState:function(){this.redoState=this.redoList.length>0?!0:!1,this.revertState=this.revertList.length>0?!0:!1}},t.ready=!0,e.EditorHistory=t}(window.jQuery.jQEditor),function(e,t){var n={delayFile:[],initLoad:function(e){this.delayFile=e.delayFile},loadDelayFile:function(){setTimeout(function(){for(var n=self.delayFile.length,r=0;n>r;r++)t.getScript(e.config.cBase.pluginDir+self.delayFile[r])},100)},loadOneFile:function(n,r){t.getScript(n,function(){e.trigger("afterLoad"),r&&r()})},loadMultiFile:function(){}};n.initLoad(e.config.cBase),n.ready=!0,e.load=n}(window.jQuery.jQEditor,window.jQuery),function(e,t){var n={enabled:!0,length:1,sendAddr:"",logList:[],initLog:function(e){this.enabled=e.onLog?!0:!1,this.sendAddr=e.sendAddr,this.length=e.length},writeLog:function(e,t,n){var r=new Date;n=n||""+r;var i=t+' module "'+e+'" at '+n;this.logList.push(i),this.enabled&&window.console&&window.console.log(i),this.logList.length>this.length&&this.logList.shift()},sendLog:function(){var e=this;t.ajax({type:"POST",url:e.sendAddr,data:{logList:e.logList},success:function(){e.logList=[]}})}};n.initLog(e.config.cLog),n.ready=!0,e.log=n}(window.jQuery.jQEditor,window.jQuery),function(e,t){var n={spaceText:e.IE6?"﻿":"​",nodeIndex:function(e){for(var t=0;e=e.previousSibling;t++);return t},showTips:function(n){t("#"+e.curId+" .tips").html(n),t("#"+e.curId+" .tips").show()},getCurElement:function(){try{var t=[],n=e.curEditor.win.getSelection();if("None"===n.type){var r=e.curEditor.dom.createRange();r.selectNodeContents(e.curEditor.dom.body),r.collapse(!1),n.addRange(r)}var i=n.getRangeAt(0);if(null===i)e.log.writeLog("get no Element");else{for(var o=i.startContainer;o.nodeName&&"HTML"!==o.nodeName&&o!==e.curEditor.dom;)t.unshift(o),o=o.parentNode;var a;for(i.commonAncestorContainer,!i.collapsed&&i.startContainer===i.endContainer&&2>i.startOffset-i.endOffset&&i.startContainer.hasChildNodes()&&(a=i.startContainer.childNodes[i.startOffset]);a&&3==a.nodeType&&a.parentNode;)a=a.parentNode;a&&a!==t[t.length-1]&&t.push(a)}return t}catch(s){e.error.writeError("getElement error: "+s.message+(s.stack?s.stack:""),3,"utils")}},getSelectionOffset:function(t){try{var n={start:[],end:[]};t.focus();var r=t.getSelection();if("None"===r.type){var i=t.document.createRange();i.selectNodeContents(t.document.body),i.collapse(!1),r.addRange(i)}var o=r.getRangeAt(0),a=o.startContainer,s=o.endContainer;for(n.start.unshift(o.startOffset),n.end.unshift(o.endOffset);a.nodeName&&"BODY"!==a.nodeName&&a!==t.document;){var l=this.nodeIndex(a);n.start.unshift(l),a=a.parentNode}for(;s.nodeName&&"BODY"!==s.nodeName&&s!==t.document;){var c=this.nodeIndex(s);n.end.unshift(c),s=s.parentNode}return n}catch(d){e.error.writeError("getSelectionOffset error: "+d.message+(d.stack?d.stack:""),3,"utils")}},setSelectionByOffset:function(n,r){try{n.focus();var i=[];t.extend(!0,i,r);for(var o=n.document,a=i.start.shift(),s=i.end.shift(),l=o.body,c=o.body,d=0,u=0,f=o.body.childNodes[a],m=o.body.childNodes[s];;){if(!f){d=0;break}if(l=f,a=i.start.shift(),void 0===a)break;if(3===f.nodeType){d=f.nodeValue.length>a?a:f.nodeValue.length;break}f.childNodes.length>a?(f=f.childNodes[a],d=a):(d=f.childNodes.length,f=f.lastChild)}for(;;){if(!m){u=0;break}if(c=m,s=i.end.shift(),void 0===s)break;if(3===m.nodeType){u=m.nodeValue.length>s?s:m.nodeValue.length;break}m.childNodes.length>s?(m=m.childNodes[s],u=s):(u=m.childNodes.length,m=m.lastChild)}var h=n.getSelection();"None"!==h.type&&h.removeAllRanges();var p=o.createRange();p.setStart(l,d),p.setEnd(c,u),h.addRange(p)}catch(g){e.error.writeError("setSelectionByOffset error: "+g.message+(g.stack?g.stack:""),3,"utils")}},getNodeDom:function(e){return 9===e.nodeType&&(e=e.body),{dom:e.ownerDocument,node:e}},message:function(t,n){if(e.dialog.open({id:"error",content:t,title:"Error tips"}),n)throw e.lang.unexpectedEnd},execPlugin:function(t,n,r){function i(){var i=e.pluginList[t];return e.curEditor.pluginEnable[t]?"function"==typeof i[n]?i[n](r):i.click(n):(e.messageError("plugin "+t+" disabled!"),void 0)}return e.pluginList[t]?i():(e.loadPlugin(t,i),void 0)},execUi:function(t,n,r,i){var o="";e.uiList[t]?(o=e.uiList[t][n](r),o&&i&&i(o)):e.loadUi(t,function(){o=e.uiList[t][n](r),o&&i&&i(o)})},stringToNode:function(e,t){return t===void 0&&(t=document.createElement("div")),t.innerHTML=e,t},filterInner:function(t,n){try{var r=t.baseFilter.excute("html",n),i=this.stringToNode(r),o=t.baseFilter.excute("beforeInsert",i).innerHTML;return o}catch(a){e.error.writeError("filterInner error: "+a.message+(a.stack?a.stack:""),3,"utils")}},loadDialog:function(n,r,i){if(e.uiList[n+"dialog"]===void 0&&e.loadUi(n+"dialog",function(){}),r!==void 0){var o=r+n+".dialog.json",a="[ui="+n+"]";if(0===t(a).length)if(e.dialogHtml[n+"dialog"]===void 0)e.load.loadOneFile(o,function(){var r=e.dialogHtml[n+"dialog"];t("#ui-dialog").append(r),i&&i()});else{var s=e.dialogHtml[n+"dialog"];t("#ui-dialog").append(s),i&&i()}else i&&i()}},getSelectionText:function(){try{var t=e.curEditor.win.getSelection().getRangeAt(0);return""+t}catch(n){e.error.writeError("getText error: "+n.message+(n.stack?n.stack:""),3,"utils")}},removeSelection:function(t){try{t.getSelection().removeAllRanges()}catch(n){e.error.writeError("removeSelection error: "+n.message+(n.stack?n.stack:""),3,"utils")}},setCursor:function(t,n,r){try{r=r?!0:!1;var i={},o=t.getSelection();i=0===o.rangeCount?t.document.createRange():o.getRangeAt(0),i.selectNodeContents(n),i.collapse(r),o.removeAllRanges(),o.addRange(i)}catch(a){e.error.writeError("setCursor error: "+a.message+(a.stack?a.stack:""),3,"utils")}},getSelectionRange:function(t,n){try{var r=t.getSelection(),i={};if("None"!==r.type)i=r.getRangeAt(0);else{var o=t.document.createRange();o.selectNodeContents(t.document.body),o.collapse(!0),r.addRange(o),i=r.getRangeAt(0)}return"node"===n&&(i={startContainer:i.startContainer,startOffset:i.startOffset,endContainer:i.endContainer,endOffset:i.endOffset}),i}catch(a){e.error.writeError("getSelectionRange error: "+a.message+(a.stack?a.stack:""),3,"utils")}},setSelectionRange:function(t,n,r){try{var i={};"object"!=typeof n?(i=t.document.createRange(),i.selectNodeContents(t.document.body),i.collapse(!0)):"node"===r?(i=t.document.createRange(),i.setStart(n.startContainer,n.startOffset),i.setEnd(n.endContainer,n.endOffset)):i=n;var o=t.getSelection();o.removeAllRanges(),o.addRange(i)}catch(a){e.error.writeError("setSelectionRange error: "+a.message+(a.stack?a.stack:""),3,"utils")}},pasteHTML:function(t){e.coreCommand.editInsert(t)},getBoardContent:function(t,n){var r=t.win,i=t.dom,o=i.createElement("div");o.style.cssText="position:absolute;width:1px;height:1px;overflow:hidden;left:-1000px;white-space:nowrap;",o.innerHTML=this.spaceText;try{var a=r.getSelection().getRangeAt(0).cloneRange(),s=r.getSelection().getRangeAt(0);s.setStart(i.body,0),s.collapse(!0),s.surroundContents(o),s.selectNodeContents(o),s.collapse(!0),r.getSelection().removeAllRanges(),r.getSelection().addRange(s)}catch(l){e.error.writeError("getBoardContent error: "+l.message+(l.stack?l.stack:""),3,"utils")}setTimeout(function(){r.getSelection().removeAllRanges(),r.getSelection().addRange(a),n&&n(o),i.body.removeChild(o)},0)},replaceSelectedText:function(t,n){try{var r=t.getSelection(),i={};if("None"===r.type)return!1;if(i=r.getRangeAt(0),3!==i.startContainer.nodeType||i.startContainer!==i.endContainer)return!1;var o=i.startContainer.parentNode,a=i.extractContents();a.firstChild.nodeValue=n,i.insertNode(a),e.curEditor.baseFilter.excuteOne("combine",o)}catch(s){e.error.writeError("replaceSelectedText error: "+s.message+(s.stack?s.stack:""),3,"utils")}},selectNode:function(t,n){try{var r={},i="object"==typeof n?n.ownerDocument:doucment;if(i===t.document){r=i.createRange(),"object"!=typeof n?(r.selectNodeContents(i.body),r.collapse(!0)):r.selectNode(n);var o=t.getSelection();o.removeAllRanges(),o.addRange(r)}}catch(a){e.error.writeError("selectNode error: "+a.message+(a.stack?a.stack:""),3,"utils")}},newApi:function(e,t){alert(e+t)},escape:function(e){return e&&"string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/ /g,"&nbsp;"):e}};n.ready=!0,e.utils=n}(window.jQuery.jQEditor,window.jQuery),function(e){var t={labelMap:{anchor:"锚点",undo:"撤销",redo:"重做",bold:"加粗",indent:"增加缩进量",snapscreen:"截图",italic:"斜体",underline:"下划线",strikethrough:"删除线",subscript:"下标",superscript:"上标",formatmatch:"格式刷",codemirror:"源代码",source:"源代码",blockquote:"引用",pasteplain:"纯文本粘贴模式",selectall:"全选",print:"打印",preview:"预览",horizontal:"分隔线",removeformat:"清除格式",inserttime:"时间",insertdate:"日期",unlink:"取消链接",insertrowbefore:"前插入行",insertcolbefore:"前插入列",insertrowafter:"后插入行",insertcolafter:"后插入列",combinecolafter:"右合并单元格",combinerowafter:"下合并单元格",deleterow:"删除行",deletecol:"删除列",splittorows:"拆分成行",splittocols:"拆分成列",splittocells:"完全拆分单元格",combinecells:"合并多个单元格",deletetable:"删除表格",tableprops:"表格属性",insertparagraphbeforetable:"表格前插行",cleardoc:"清空文档",fontfamily:"字体",fontsize:"字号",paragraph:"段落格式",image:"图片",inserttablemenu:"表格",link:"超链接",emotion:"表情",specharsmenu:"特殊字符",searchreplace:"查询替换",search:"查找",replace:"替换",bmap:"Baidu地图",map:"Google地图",insertvideo:"视频",help:"帮助",justifyleft:"居左对齐",justifyright:"居右对齐",justifycenter:"居中对齐",justifyjustify:"两端对齐",forecolor:"字体颜色",backcolor:"背景色",insertorderedlist:"有序列表",insertunorderedlist:"无序列表",fullscreen:"全屏",directionalityltr:"从左向右输入",directionalityrtl:"从右向左输入",spacetopmenu:"段前距",spacebottommenu:"段后距",highlightcode:"插入代码",pagebreak:"分页",insertframe:"插入Iframe",imagenone:"默认",imageleft:"左浮动",imageright:"右浮动",attachment:"附件",imagecenter:"居中",wordimage:"图片转存",linespacemenu:"行间距",edittd:"单元格",customstyle:"自定义标题",autoformat:"自动排版",touppercase:"字母大写",tolowercase:"字母小写",background:"背景",template:"模板",scrawl:"涂鸦",music:"音乐",cut:"剪切",fontsizemenu:"字体",fontfamilymenu:"字号",pastetotext:"粘贴为纯文本",pasteword:"从 MS Word 粘帖",reference:"参考资料",insertdatemenu:"更多时间格式",multiimage:"多图上传",baikelink:"百科链接",outdent:"减少缩进量",insertunorderedlistmenu:"无序列表样式",insertorderedlistmenu:"有序列表样式",about:"关于",forecolormenu:"更多颜色",backcolormenu:"更多颜色",h2:"一级目录",h3:"二级目录"},insertorderedlist:{decimal:"1,2,3...","lower-alpha":"a,b,c...","lower-roman":"i,ii,iii...","upper-alpha":"A,B,C...","upper-roman":"I,II,III..."},insertunorderedlist:{circle:"○ 小圆圈",disc:"● 小圆点",square:"■ 小方块 "},paragraph:{p:"段落",h1:"标题 1",h2:"标题 2",h3:"标题 3",h4:"标题 4",h5:"标题 5",h6:"标题 6"},fontfamily:{songti:"宋体",kaiti:"楷体",heiti:"黑体",lishu:"隶书",yahei:"微软雅黑",andaleMono:"andale mono",arial:"arial",arialBlack:"arial black",comicSansMs:"comic sans ms",impact:"impact",timesNewRoman:"times new roman"},customstyle:{tc:"标题居中",tl:"标题居左",im:"强调",hi:"明显强调"},fontsize:"字号",fontfamily:"字体",createError:"编辑器创建失败",fillError:"填充panel错误",eventInitError:"事件模块初始化错误",eventRefreshError:"事件重置错误",filterInitError:"过滤器模块初始化错误",filterRefreshError:"过滤器重置错误",pluginInitError:"插件添加并初始化错误",pluginLoadError:"插件文件加载错误",pluginConfigError:"插件配置错误",uiInitError:"ui添加并初始化错误",uiLoadError:"ui文件加载错误",initError:"初始化失败",noCommand:"未检测到该命令，请在config中添加。"};
e.lang=t}(window.jQuery.jQEditor),function(e){var t={initCommand:function(t){this.Eid=t.id,this.win=e.curEditor.win,this.dom=e.curEditor.dom,this.startTime="",this.endTime=""},editText:function(){},editInsert:function(){},beforeCommand:function(t){this.startTime=+new Date,e.trigger("beforeCommand",{targetEditor:e.curEditor,commandName:t}),this.endTime=+new Date,e.log.writeLog("command "+t+" after excute "+(this.endTime-this.startTime)+"ms","command")},excuteCommand:function(t,n,r){var i=this;this.beforeCommand(t);var o="";try{for(var a in e.config.cCommand){var s=e.config.cCommand[a];if(s[t]){""!==s[t].param&&(n&&(r=n),n=s[t].param),s[t].args!==void 0&&(r=s[t].args),t=s[t].cmd,o=a;break}}}catch(l){e.error.writeError("command config error: "+l.message+(l.stack?l.stack:""),4,"command"),e.utils.message(e.lang.commandError,"finish")}try{if(""===t)throw"config cmd no defined";if("textCommand"===o)i.editText(t,n);else if("paragraphCommand"===o)i.editParagraph(t,n);else if("insertCommand"===o)i.editInsert(n);else if("pluginCommand"===o)n=n||"click",r=r||"",e.utils.execPlugin(t,n,r);else{if("uiCommand"!==o)throw e.lang.noCommand+t;n=n||"submit",r=r||"",e.utils.execUi(t,n,r,function(e){e!==!1&&e!==void 0&&i.editInsert(e)})}}catch(l){e.error.writeError(t+"-"+n+" running error: "+l.message+(l.stack?l.stack:""),4,"command")}this.endTime=+new Date,this.afterCommand(t)},afterCommand:function(t){e.trigger("afterCommand",{targetEditor:e.curEditor,commandName:t}),this.endTime=+new Date,e.log.writeLog("command "+t+" after excute "+(this.endTime-this.startTime)+"ms","command")}};e.coreCommand=t,e.command=function(e,n,r){t.excuteCommand(e,n,r)},e.command.ready=!0}(window.jQuery.jQEditor),function(e){function t(){n=e.curEditor.win,r=e.curEditor.dom}var n,r,i=function(i){var o=new t;return o.init(n,r),i=e.utils.filterInner(e.curEditor,i),o.insert(i),o};t.prototype={mainRange:{},mainSelection:{},document:{},win:{},tmpBoard:{},init:function(e,t){this.win=e,this.document=t,this.mainRange=t.createRange(),this.mainSelection=e.getSelection(),"None"===this.mainSelection.type?this.mainSelection.addRange(this.mainRange):this.mainRange=this.mainSelection.getRangeAt(0)},insert:function(t){var n=this._preDoHtml(t),r=this._copyToBoard(n);if(r!==!1)for(var i=0;r.length>i;i++)this._paste(r[i]);this.tmpBoard.nodeValue="",e.curEditor.baseFilter.excute("afterInsert")},_preDoHtml:function(e){return e},_copyToBoard:function(e){var t={},n=this.document.createRange();return n.selectNodeContents(this.document.body),this.tmpBoard=n.createContextualFragment(e),t=this._cutInsertNode(this.tmpBoard)},_paste:function(e){this.mainRange.collapsed||this.mainRange.deleteContents();var t=this.mainRange.cloneRange(),n=t.startContainer,r=!1,i=!1;if(t.startContainer.childNodes.length===t.startOffset&&(i=!0),0===t.startOffset&&(r=!0),"text"!==e.insertType){for(this._hasParentNode(e.insertType,n)||this._fillNode(e);"BODY"!==n.tagName&&(3===n.nodeType||3!==n.nodeType&&1!==DTD[n.tagName][e.insertType]);)t.setStartBefore(n),n=n.parentNode;var o=t.extractContents();t.insertNode(o),t.collapse(!1),t.insertNode(e.insertValue)}else if(3!==t.startContainer.nodeType){t.insertNode(e.insertValue);var a=t.startContainer.childNodes[t.startOffset-1];if(a&&3!==a.nodeType&&1===DTD.$block[a.nodeName]){var s=this.document.createElement("p");t.surroundContents(s)}}else t.insertNode(e.insertValue);t.selectNode(e.insertOri),t.collapse(!1),this.mainRange=t,this.mainSelection.removeAllRanges(),this.mainSelection.addRange(this.mainRange)},_cutInsertNode:function(e){for(var t=[],n=0;e.childNodes.length>n;n++){var r=Object({insetType:"",insertValue:{},insertOri:{}});3===e.childNodes[n].nodeType?(r.insertType="text",r.insertValue=e.childNodes[n],r.insertOri=e.childNodes[n]):(r.insertType=e.childNodes[n].tagName,r.insertValue=e.childNodes[n],r.insertOri=e.childNodes[n]),t[n]=r}return t},_hasParentNode:function(e,t){for(var n=!1;"HTML"!==t.tagName;){if(3!==t.nodeType&&1===DTD[t.tagName][e]){n=!0;break}t=t.parentNode}return n},_fillNode:function(e){var t=this.document.createRange();t.selectNode(e.insertValue);for(var n=e.insertType;DTD[n].parent;){var r=this.document.createElement(DTD[n].parent);t.surroundContents(r),n=DTD[n].parent,e.insertType=n,e.insertValue=r}}},e.coreCommand.editInsert=i}(window.jQuery.jQEditor),function(e,t){function n(){r=e.curEditor.win,i=e.curEditor.dom}var r,i,o=function(e,t){var o=!0,a=new n,s=a.init(r,i);a.mainRange=s.rangeSet[0];for(var l=0;s.len>l;l++)a.mainRange=s.rangeSet[l],o=a.changeParagraph(e,t);return o};n.prototype={mainRange:{},mainSelection:{},document:{},win:{},init:function(n,r){var i={len:0,rangeSet:[]};this.win=n,this.document=r;var o=r.createRange();this.mainSelection=n.getSelection();var a=t(e.curEditor.dom).find("."+e.curEditor.config.selectCellClass),s=t(e.curEditor.dom).find("."+e.curEditor.config.selectTableClass);if(0!==s.length){i.len=s.length;for(var l=0;s.length>l;l++)o.selectNodeContents(s[l]),i.rangeSet[l]=o.cloneRange()}else if(0!==a.length){i.len=a.length;for(var l=0;a.length>l;l++)o.selectNodeContents(a[l]),i.rangeSet[l]=o.cloneRange()}else"None"===this.mainSelection.type?i.len=0:(i.len=1,i.rangeSet[0]=this.mainSelection.getRangeAt(0));return i},changeParagraph:function(e,n){var r="";if(n){if("padding-left"===e){var i=n;n=function(e,t){var n=parseFloat(t)+parseFloat(i);return(n>0?n:0)+"px"}}}else"ul"===e&&(n="disc"),"ol"===e&&(n="decimal");var o=this.mainRange,a=o.commonAncestorContainer,s={ancestor:a,firstNode:o.startContainer,firstOffset:o.startOffset,lastNode:o.endContainer,lastOffset:o.endOffset,styleNode:t()},l=o.cloneRange();l.collapse(!0);var c=o.cloneRange();if(c.collapse(!1),"ul"===e||"ol"===e)return r=this.judgeValue(e,n),this._setParagraph(s,e,n,r),!0;var d={};d=0>=navigator.userAgent.indexOf("MSIE")?this.document.createNodeIterator(a,NodeFilter.SHOW_TEXT):this.document.createNodeIterator(a,3);for(var u={},f={},m={},h=d.nextNode(),p={},g=0,b=1;h;){if(p=d.nextNode(),0===g){var v=this.document.createRange();v.selectNode(h);var y=v.compareBoundaryPoints(v.START_TO_START,l)}if(1===b)if(p){var E=this.document.createRange();E.selectNode(p);var w=E.compareBoundaryPoints(E.START_TO_START,c)}else var w=-1;var C=y>-1&&0===g,k=w>-1&&1===g&&1===b;if(h===s.lastNode||k){u=this._setStyle(h,s,e,n),b=0;break}g&&b&&(m=this._setStyle(h,s,e,n)),g||h!==s.firstNode&&!C||(f=this._setStyle(h,s,e,n),g=1),h=p}},_setStyle:function(n,r,i,o){var a=this.document,s=t(n).closest(r.styleNode).length;if(!s){var l="td,th,dt,dd,li",c=[],d=[],u=[];for(var f in DTD.$paragraph)f=f.toLowerCase(),1===DTD.$paragraph[f]?c.push(f):0===DTD.$paragraph[f]&&d.push(f);c=c.join(","),d=d.join(",");var m=t(n).closest(l);if(m.length>0)t(m[0]).css(i,o),r.styleNode=m[0];else{var h=t(n).closest(d);if(h.length>0){var p=h[0].nodeName;if("body"===p.toLowerCase()||"div"===p.toLowerCase()){var g=t(n).closest(c);if(g.length>0)t(g[0]).css(i,o),r.styleNode=g[0];else for(var b=a.createElement(DTD[p].child),v=h[0].childNodes.length,y=0;v>y;y++)u=h[0].childNodes[y],(3===u.nodeType||1!==DTD[p][u.nodeName])&&(t(u).wrap(b),t(n).closest(u).length>0&&(t(u.parentNode).css(i,o),r.styleNode=b))}else for(var b=a.createElement(DTD[p].child),v=h[0].childNodes.length,y=0;v>y;y++)u=h[0].childNodes[y],(3===u.nodeType||1!==DTD[p][u.nodeName])&&(t(u).wrap(b),t(n).closest(u).length>0&&(t(u.parentNode).css(i,o),r.styleNode=b))}else e.utils.message("has no paragraph")}}},_setParagraph:function(n,r,i,o){var a=this.mainRange.startContainer,s=this.mainRange.endContainer,l={},c={},d=t(a).closest("ol,ul"),u=t(s).closest("ol,ul"),f=o.split("_"),m=[];for(var h in DTD.$block)h=h.toLowerCase(),1===DTD.$block[h]&&1!==DTD.$listItem[h]&&1!==DTD.$list[h]&&m.push(h);m=m.join(","),d.length>0?(l=t(a).closest("li")[0],d=d[0]):(l=t(a).closest(m)[0],d=""),u.length>0?(c=t(s).closest("li")[0],u=u[0]):(c=t(s).closest(m)[0],u="");var p=this.document.createRange(),g=p.cloneRange(),b=this.document.createRange();t(n.ancestor).closest(l).length>0&&(n.ancestor=l.parentNode),t(n.ancestor).closest(c).length>0&&(n.ancestor=c.parentNode),t(n.ancestor).closest(d).length>0&&(n.ancestor=d.parentNode),t(n.ancestor).closest(u).length>0&&(n.ancestor=u.parentNode),p.selectNodeContents(n.ancestor),p.setEndBefore(l),g.selectNodeContents(n.ancestor),g.setStartAfter(c);var v=g.extractContents();g.insertNode(v);var y=p.extractContents();p.insertNode(y),b.setEnd(g.startContainer,g.startOffset),b.setStart(p.endContainer,p.endOffset);for(var E=b.extractContents(),w=E.firstChild,C={};w;){C=w.nextSibling;var k="";k="UL"!==w.nodeName&&"OL"!==w.nodeName?t(w).find("ul,ol"):t(w),k.each(function(){var e=this;t(this).find("li").children().each(function(){e.parentNode.insertBefore(this,e)}),t(this).remove()}),w=C}if(b.insertNode(E),"on"===f[0]){var N=this.document.createElement(r);N.style["list-style-type"]=i;var T=this.document.createElement("li");b.surroundContents(N),t(N).children().each(function(){t(this).wrap(T.cloneNode())})}e.curEditor.baseFilter.excute("afterList"),this.mainRange.setStart(n.firstNode,n.firstOffset),this.mainRange.setEnd(n.lastNode,n.lastOffset),this.mainSelection.removeAllRanges(),this.mainSelection.addRange(this.mainRange)},judgeValue:function(e,n){var r=this.mainRange.startContainer,i=this.mainRange.endContainer,o=[];return o[0]=t(r).closest(e).length>0?t(r).closest(e).css("list-style-type")===n?"off":"on":"on",o[1]=t(i).closest(e).length>0?t(i).closest(e).css("list-style-type")===n?"off":"on":"on",o.join("_")}},e.coreCommand.editParagraph=o}(window.jQuery.jQEditor,window.jQuery),function(e,t){function n(){r=e.curEditor.win,i=e.curEditor.dom}var r,i,o=function(t,o){var a=new n,s=a.init(r,i);a.mainRange=s.rangeSet[0],o&&"text-decoration"!==t||(o=a.judgeValue(t,o));for(var l=0;s.len>l;l++){a.mainRange=s.rangeSet[l];var c=a.changeText(t,o)}return e.curEditor.baseFilter.excute("afterTextPre"),e.curEditor.baseFilter.excute("afterText"),c};n.prototype={mainRange:{},mainSelection:{},document:{},win:{},init:function(n,r){var i={len:0,rangeSet:[]};this.spaceText=e.IE6?"﻿":"​",this.win=n,this.document=r;var o=r.createRange();this.mainSelection=n.getSelection();var a=t(e.curEditor.dom).find("."+e.curEditor.config.selectCellClass),s=t(e.curEditor.dom).find("."+e.curEditor.config.selectTableClass);if(0!==s.length){i.len=s.length;for(var l=0;s.length>l;l++)o.selectNodeContents(s[l]),i.rangeSet[l]=o.cloneRange()}else if(0!==a.length){i.len=a.length;for(var l=0;a.length>l;l++)o.selectNodeContents(a[l]),i.rangeSet[l]=o.cloneRange()}else"None"===this.mainSelection.type?i.len=0:(i.len=1,i.rangeSet[0]=this.mainSelection.getRangeAt(0));return i},changeText:function(e,t){(!t||"text-decoration"===e&&"none"!==t)&&(t=this.judgeValue(e,t)),this.mainRange.collapsed?this.setChange(this.mainRange,e,t):this.excuteChange(this.mainRange,e,t)},setChange:function(e,t,n){"_on"!==n&&"_off"!==n?this._setSpan(e,t,n):"_on"===n?this._setTag(e,t):this._unsetTag(e,t),this.document.createElement("span")},excuteChange:function(e,t,n){var r="style";"wordcase"===t?r="wordcase":"_on"===n?r="tag_on":"_off"===n&&(r="tag_off");var i=e.cloneRange();i.collapse(!0);var o=e.cloneRange();o.collapse(!1);var a=e.commonAncestorContainer,s={ancestor:a,firstNode:e.startContainer,firstOffset:e.startOffset,lastNode:e.endContainer,lastOffset:e.endOffset},l="",c="",d="",u="";if(s.firstNode!==s.lastNode||3!==s.firstNode.nodeType){var f={};f=0>=navigator.userAgent.indexOf("MSIE")?this.document.createNodeIterator(a,NodeFilter.SHOW_TEXT):this.document.createNodeIterator(a,3);for(var m=f.nextNode(),h={},p=0,g=1,b=0;m;){if(h=f.nextNode(),0===p){var v=this.document.createRange();v.selectNode(m);var y=v.compareBoundaryPoints(v.START_TO_START,i)}if(1===g)if(h){var E=this.document.createRange();E.selectNode(h);var w=E.compareBoundaryPoints(E.START_TO_START,o)}else var w=-1;var C=y>-1&&0===p,k=w>-1&&1===p&&1===g;if(m===s.lastNode||k){c="style"===r?this._addSpan(m,s,t,n,"last"):"wordcase"===r?this._wordCase(m,s,t,n,"last"):"tag_on"===r?this._addTag(m,s,t,"last","on"):this._addTag(m,s,t,"last","off"),c?l||(l=c):c=d,g=0,this.mainRange.setStart(l.startContainer,l.startOffset),this.mainRange.setEnd(c.endContainer,c.endOffset),this.mainSelection.removeAllRanges(),this.mainSelection.addRange(this.mainRange);break}p&&g&&(u="style"===r?this._addSpan(m,s,t,n,"mid"):"wordcase"===r?this._wordCase(m,s,t,n,"mid"):"tag_on"===r?this._addTag(m,s,t,"mid","on"):this._addTag(m,s,t,"mid","off"),u&&(d=u,l||(l=u))),p||m!==s.firstNode&&!C||(l="style"===r?this._addSpan(m,s,t,n,"first"):"wordcase"===r?this._wordCase(m,s,t,n,"first"):"tag_on"===r?this._addTag(m,s,t,"first","on"):this._addTag(m,s,t,"first","off"),p=1,l&&3!==m.nodeType&&(b=1)),m=h}}else l="style"===r?this._addSpan(s.firstNode,s,t,n,"cut"):"wordcase"===r?this._wordCase(s.firstNode,s,t,n,"cut"):"tag_on"===r?this._addTag(s.firstNode,s,t,"cut","on"):this._addTag(s.firstNode,s,t,"cut","off"),this.mainRange=l,this.mainSelection.removeAllRanges(),this.mainSelection.addRange(this.mainRange)},_addSpan:function(e,t,n,r,i){var o=this.document.createElement("span");if(3===e.nodeType&&/\S/.test(e.nodeValue)){var a=this.document.createRange();a.selectNode(e);var s=a.cloneRange(),l=a.cloneRange();if(("last"===i||"cut"===i)&&(a.setEnd(e,t.lastOffset),s.setEndAfter(e.parentNode),s.setStart(e,t.lastOffset)),("first"===i||"cut"===i)&&(a.setStart(e,t.firstOffset),l.setStartBefore(e.parentNode),l.setEnd(e,t.firstOffset)),"SPAN"===e.parentNode.tagName){var c="",d="";if("cut"===i)c=s.extractContents(),s.insertNode(c),d=l.extractContents(),l.insertNode(d),this.setStyleType(n,r,e.parentNode),a.selectNodeContents(e);else{if("last"===i&&(c=s.extractContents(),s.insertNode(c)),"first"===i&&(d=l.extractContents(),l.insertNode(d)),e.parentNode.firstChild!==e.parentNode.lastChild){var u="",f="";"first"===i?(a.setStartBefore(e.parentNode),a.setEndAfter(e),f=a.extractContents(),e=f.firstChild.firstChild,a.insertNode(f)):"last"===i?(a.setEndAfter(e.parentNode),a.setStartBefore(e),u=a.extractContents(),e=u.firstChild.firstChild,a.insertNode(u)):"mid"===i&&(a.setStartBefore(e.parentNode),a.setEndAfter(e),f=a.extractContents(),a.insertNode(f),a.setStartBefore(e),u=a.extractContents(),e=u.firstChild.firstChild,a.insertNode(u))}this.setStyleType(n,r,e.parentNode),a.selectNodeContents(e)}}else this.setStyleType(n,r,o),a.surroundContents(o);return a}},_wordCase:function(e,t,n,r,i){if(3===e.nodeType&&/\S/.test(e.nodeValue)){var o=this.document.createRange();o.selectNode(e),("last"===i||"cut"===i)&&o.setEnd(e,t.lastOffset),("first"===i||"cut"===i)&&o.setStart(e,t.firstOffset);var a=o.extractContents(),s=a.firstChild.nodeValue,l="lower"===r?s.toLowerCase():s.toUpperCase();return a.firstChild.nodeValue=l,o.insertNode(a),o}},_addTag:function(e,t,n,r,i){var o=this.document.createElement(n);if(3===e.nodeType&&/\S/.test(e.nodeValue)){var a=this.document.createRange();a.selectNode(e);var s=a.cloneRange(),l=a.cloneRange();for(("first"===r||"cut"===r)&&(a.setStart(e,t.firstOffset),s.setStartBefore(e),s.setEnd(e,t.firstOffset)),("last"===r||"cut"===r)&&(a.setEnd(e,t.lastOffset),l.setEndAfter(e),l.setStart(e,t.lastOffset));1===DTD[n][e.parentNode.tagName]&&1!==DTD.$block[e.parentNode.tagName]&&e.parentNode.firstChild===e.parentNode.lastChild;)("first"===r||"mid"===r||"cut"===r)&&(a.setEndAfter(e.parentNode),s.setStartBefore(e.parentNode)),("last"===r||"mid"===r||"cut"===r)&&(a.setStartBefore(e.parentNode),l.setEndAfter(e.parentNode)),e=e.parentNode;if(e.parentNode.tagName===n.toUpperCase()){if("on"===i)return a;var c=!0}else if("off"===i)return a;var d="",u="";if(("cut"===r||"last"===r)&&(d=l.extractContents(),l.insertNode(d),a.setEnd(l.startContainer,l.startOffset)),("cut"===r||"first"===r)&&(u=s.extractContents(),s.insertNode(u),a.setStart(s.endContainer,s.endOffset)),2===DTD[n][e.parentNode.tagName]||c===!0){var f=e.parentNode,m=a.extractContents();("cut"===r||"last"===r)&&(l.setEndAfter(f),d=l.extractContents(),l.insertNode(d),l.collapse(!0),a=l),("cut"===r||"first"===r||"mid"===r)&&(s.setEnd(a.startContainer,a.startOffset),s.setStartBefore(f),u=s.extractContents(),s.insertNode(u),s.collapse(!1),a=s),a.insertNode(m),c!==!0&&a.surroundContents(o)}else"cut"===r&&(a.setStart(s.endContainer,s.endOffset),a.setEnd(l.startContainer,l.startOffset)),a.surroundContents(o);return a}},_setTag:function(e,t){var n=e.startContainer,r=this.document.createElement(t);if(3===n.nodeType&&/\S/.test(n.nodeValue)){var i=this.document.createTextNode(this.spaceText);e.insertNode(i),n=i;var o=e.cloneRange();o.setStartBefore(i),o.setEndAfter(i);var a=r.cloneNode(),s=this.document.createRange(a);s.selectNodeContents(a);var l=o.cloneRange(),c=o.cloneRange();for(l.setStartBefore(n),l.setEndBefore(i),c.setEndAfter(n),c.setStartAfter(i);1===DTD[t][n.parentNode.tagName]&&1!==DTD.$block[n.parentNode.tagName]&&n.parentNode.firstChild===n.parentNode.lastChild;)l.setStartBefore(n.parentNode),c.setEndAfter(n.parentNode),n=n.parentNode;if(n.parentNode.tagName===t.toUpperCase())return;var d=c.extractContents();c.insertNode(d);var u=l.extractContents();if(l.insertNode(u),2===DTD[t][n.parentNode.tagName]){var f=n.parentNode;o.setStart(l.endContainer,l.endOffset),o.setEnd(c.startContainer,c.startOffset);var m=o.extractContents();c.setEndAfter(f),d=c.extractContents(),c.insertNode(d),l.setStartBefore(f),u=l.extractContents(),l.insertNode(u),o.setStart(l.endContainer,l.endOffset),o.setEnd(c.startContainer,c.startOffset),o.deleteContents(),o.insertNode(m),o.surroundContents(r)}else o.setStart(l.endContainer,l.endOffset),o.setEnd(c.startContainer,c.startOffset),o.surroundContents(a);this.mainSelection.removeAllRanges(),this.mainRange.setStart(i,0),this.mainRange.setEnd(i,1),this.mainSelection.addRange(this.mainRange)}},_setSpan:function(e,t,n){var r=this.document.createElement("span"),i=e.startContainer;if(3===i.nodeType&&/\S/.test(i.nodeValue)){var o=e.cloneRange();if("SPAN"===i.parentNode.tagName){var a=t+": "+n,s=i.parentNode.style.cssText.search(a);if(-1!==s)return;o.setStartBefore(i.parentNode);var l=o.extractContents();o.insertNode(l),o.collapse(!1)}var c=this.document.createRange();c.selectNodeContents(r);var d=this.document.createTextNode(this.spaceText);c.insertNode(d),this.setStyleType(t,n,r),o.insertNode(r),this.mainSelection.removeAllRanges(),this.mainRange.setStart(d,1),this.mainSelection.addRange(this.mainRange)}},_unsetTag:function(e,t){var n=e.cloneRange(),r=e.cloneRange(),i=e.cloneRange();e.cloneRange();var o=this.document.createTextNode(this.spaceText);i.insertNode(o),n.setEndBefore(o),r.setStartAfter(o);for(var a=e.startContainer;a.parentNode&&t.toUpperCase()!==a.parentNode.tagName;)a=a.parentNode;if(t.toUpperCase()===a.parentNode.tagName){var s=a.parentNode,l="",c="";i.setStart(n.endContainer,n.endOffset),i.setEnd(r.startContainer,r.startOffset);var d=i.extractContents();r.setEndAfter(s),l=r.extractContents(),r.insertNode(l),n.setStartBefore(s),c=n.extractContents(),n.insertNode(c),i.setStart(n.endContainer,n.endOffset),i.setEnd(r.startContainer,r.startOffset),i.deleteContents(),i.insertNode(d)}this.mainSelection.removeAllRanges(),this.mainRange.setStart(o,0),this.mainRange.setEnd(o,1),this.mainSelection.addRange(this.mainRange)},setStyleType:function(e,t,n){n.style.cssText+=";"+e+": "+t+";"},judgeValue:function(t,n){var r="_on",i=this.mainRange.startContainer,o=3!==i.nodeType||i.nodeValue.length<=this.mainRange.startOffset;if(!this.mainRange.collapsed&&o){var a={},s=this.mainRange.commonAncestorContainer;a=0>=navigator.userAgent.indexOf("MSIE")?this.document.createNodeIterator(s,NodeFilter.SHOW_ALL):this.document.createNodeIterator(s);for(var l=this.document.createRange(),c=a.nextNode(),d=!1;c;){if((c===i||d===!0)&&(d=!0,3===c.nodeType&&c.nodeValue.length>0&&(l.selectNodeContents(c),1>this.mainRange.compareBoundaryPoints(l.START_TO_START,l)))){i=c;break}c=a.nextNode()}l.detach()}if("string"==typeof n)r=n,e.curEditor.dom.queryCommandState("underline")===!0&&"underline"===n&&(r="none"),e.curEditor.dom.queryCommandState("strikethrough")===!0&&"line-through"===n&&(r="none");else for(;i&&"BODY"!==i.nodeName;){if(3!==i.nodeType&&(3===DTD[i.nodeName][t]||t===i.nodeName.toLowerCase())){r="_off";break}i=i.parentNode}return r}},e.coreCommand.editText=o}(window.jQuery.jQEditor,window.jQuery),function(e){function t(e){this.name=e.name,this.type=e.type,this.area=e.area?e.area:"custom",this.fn=e.fn,this.isEnable=e.isEnable?e.isEnable:!0}function n(){this.editAreaEvents={},this.customEvents={},this.customEventList={},this.delegate()}function r(t){try{this.editWin=t.win,this.editDom=t.dom,this.Eid=t.config.id,this.curEditor=t,this.customEvents={},this.editAreaEvents={},this.blackList=t.config.cEvent.blackList,this.eventConfig={},e.listenEditarea(this.curEditor),e.listenEditareaExt(this.curEditor),this.refreshList()}catch(n){e.error.writeError("editor event init error: "+n.message+(n.stack?n.stack:""),5,"event"),e.utils.message(e.lang.initError,"finish")}}n.allList={},n.prototype={addEvent:function(e){var n={};n=this.customEventList[e.name]===void 0?new t(e):this.customEventList[e.name];for(var r=e.type.length,i=0;r>i;i++)this.customEvents[e.type[i]]===void 0&&(this.customEvents[e.type[i]]={}),this.customEvents[e.type[i]][n.name]=n;this.customEventList[n.name]=n},bindEvent:function(e){this.customEventList[e].isEnable=!0},unbindEvent:function(e){this.customEventList[e].isEnable=!0},triggerEvent:function(e,t){var n=this.customEvents[e];for(var r in n)n[r].isEnable!==!1&&n[r].fn(t)},delegate:function(){}};var i=new n(e.config);e.trigger=function(t,n){var r=!0,o=i.customEvents[t];if(o)for(var a in o)if(o[a]&&o[a].isEnable!==!1)try{if(n&&n.targetEditor&&n.targetEditor.baseEvent){var s=n.targetEditor.baseEvent.eventConfig;s[o[a]]!==!1&&!1===o[a].fn(n)&&(r=!1)}else!1===o[a].fn(n)&&(r=!1)}catch(l){e.error.writeError(t+"type-name"+a+" event error: "+l.message+(l.stack?l.stack:""),4,"event")}return r},r.prototype={add:function(e,t){var n={name:t,type:e};i.addEvent(n)},_findEvent:function(e,t){if(this.customEvents[e]!==void 0)for(var n=this.customEvents[e].length,r=0;n>r;r++)if(t===this.customEvents[e][r])return r;return!1},remove:function(t,n){try{if("*"===t)if("*"===n)for(var r in i.customEvents)i.customEvents[r]={};else for(var r in i.customEvents)i.customEvents[r][n]=void 0;else"*"===n?i.customEvents[t]={}:i.customEvents[t][n]=void 0}catch(o){e.error.writeError(t+" type - "+n+" remove error: "+o.message+(o.stack?o.stack:""),3,"event")}},disable:function(t,n){try{var r="";if("*"===t)if("*"===n)for(var i in this.customEvents)this.customEvents[i]=[];else for(var i in this.customEvents)r=this._findEvent(i,n),r!==!1&&this.customEvents[i].splice(r,1);else"*"===n?this.customEvents[t]=[]:(r=this._findEvent(t,n),r!==!1&&this.customEvents[t].splice(r,1))}catch(o){e.error.writeError(t+" type - "+n+" disable error："+o.message+(o.stack?o.stack:""),3,"event")}},enable:function(t,n){try{var r="";if("*"===t){if("*"===n)for(var o in i.customEvents)for(var a=i.customEvents[o].length,s=0;a>s;s++)r=this._findEvent(o,i.customEvents[o][s].name),r===!1&&this.customEvents[o].push(i.customEvents[o][s].name);else if(i.customEventList[n]!==void 0)for(var o in i.customEvents)r=this._findEvent(o,n),r===!1&&this.customEvents[o].push(n)}else if("*"===n)for(var a=i.customEvents[t].length,s=0;a>s;s++)r=this._findEvent(t,i.customEvents[t][s].name),r===!1&&this.customEvents[t].push(i.customEvents[t][s].name);else r=this._findEvent(t,n),r===!1&&i.customEventList[n]!==void 0&&this.customEvents[t].push(n)}catch(l){e.error.writeError(t+" type - "+n+" enabel error "+l.message+(l.stack?l.stack:""),3,"event")}},refreshList:function(){try{this.customEvents={},this.eventConfig={};for(var t in i.customEvents){var n=i.customEvents[t];this.customEvents[t]===void 0&&(this.customEvents[t]=[]);for(var r in n)this.customEvents[t].push(r),this.eventConfig[r]=!0}for(var o=this.blackList.length,a=0;o>a;a++){var s=this.blackList[a].split(".");this.disable(s[0],s[1])}}catch(l){e.error.writeError("event refresh error: "+l.message+(l.stack?l.stack:""),4,"event")}}},r.ready=!0,e.EditorEvent=r,e.addEvent=function(e){i.addEvent(e)},e.bind=function(e,t,n){"string"==typeof t&&(t=[t]),i.addEvent({name:e,type:t,fn:n})}}(window.jQuery.jQEditor),function(e){function t(e){this.name=e.name,this.order=e.order?e.order:"third",this.type=e.type?e.type:["dom"],this.replace=e.replace?e.replace:function(){}}function n(t){try{this.editWin=t.win,this.editDom=t.dom,this.Eid=t.Eid,this.curEditor=t,this.enableList=this.configFilter(t.config),this.exeList={},this.refreshList()}catch(n){e.error.writeError("editor filter init error: "+n.message+(n.stack?n.stack:""),5,"filter"),e.utils.message(e.lang.initError,"finish")}}t.exeList={dom:{dom:{first:[],second:[],third:[],fourth:[],fifth:[]},afterTextPre:{first:[],second:[],third:[],fourth:[],fifth:[]},afterText:{first:[],second:[],third:[],fourth:[],fifth:[]},afterList:{first:[],second:[],third:[],fourth:[],fifth:[]},beforeSubmit:{first:[],second:[],third:[],fourth:[],fifth:[]},beforeCmd:{first:[],second:[],third:[],fourth:[],fifth:[]},afterCmd:{first:[],second:[],third:[],fourth:[],fifth:[]},beforeInsert:{first:[],second:[],third:[],fourth:[],fifth:[]},afterInsert:{first:[],second:[],third:[],fourth:[],fifth:[]}},html:{html:{first:[],second:[],third:[],fourth:[],fifth:[]},beforePaste:{first:[],second:[],third:[],fourth:[],fifth:[]}}},t.list={},e.addFilter=function(n){try{for(var r=new t(n),i=r.type.length,o=0;i>o;o++)"dom"===r.type[o]?t.exeList.dom.dom[r.order].push(r):t.exeList.dom[r.type[o]]&&(t.exeList.dom[r.type[o]][r.order].push(r),t.exeList.dom.dom[r.order].push(r)),"html"===r.type[o]?t.exeList.html.html[r.order].push(r):t.exeList.html[r.type[o]]&&(t.exeList.html[r.type[o]][r.order].push(r),t.exeList.html.html[r.order].push(r));t.list[r.name]=r}catch(a){e.error.writeError(n.name+" filter add error: "+" "+a.message+(a.stack?a.stack:""),3,"filter")}},e.loadFilter=function(t){e.load.loadOneFile(t,function(){for(var t in e.editorList)e.editorList[t].baseFilter.refreshList()})},t.prototype={replace:function(){}},n.prototype={refreshList:function(){try{for(var n in t.exeList.dom){var r=[],i=t.exeList.dom[n].first,o=t.exeList.dom[n].second,a=t.exeList.dom[n].third,s=t.exeList.dom[n].fourth,l=t.exeList.dom[n].fifth;this.exeList[n]=r.concat(i,o,a,s,l)}for(var n in t.exeList.html){var r=[],i=t.exeList.html[n].first,o=t.exeList.html[n].second,a=t.exeList.html[n].third,s=t.exeList.html[n].fourth,l=t.exeList.html[n].fifth;this.exeList[n]=r.concat(i,o,a,s,l)}}catch(c){e.error.writeError("filter refresh error: "+c.message+(c.stack?c.stack:""),3,"filter")}},configFilter:function(e){for(var t={},n=e.cFilter.blackList,r=e.cFilter.whiteList,i=n.length,o=r.length,a=0;i>a;a++)t[n[a]]=!1;for(var a=0;o>a;a++)t[r[a]]=!0;return t},excute:function(t,n){var r=this.exeList[t].length;if("string"==typeof n){for(var i=void 0,o=n,a=0;r>a;a++){var s=this.exeList[t][a].name;if(this.enableList[s]!==!1)try{i=this.exeList[t][a].replace(this.editWin,o),i!==void 0&&(o=i)}catch(l){e.error.writeError(t+" type-"+s+" filter error "+l.message+(l.stack?l.stack:""),2,"filter")}}return o}n===void 0&&(n=this.editDom);for(var c=n,a=0;r>a;a++){var s=this.exeList[t][a].name;if(this.enableList[s]!==!1)try{this.exeList[t][a].replace(this.editWin,c)}catch(l){e.error.writeError(t+" type-"+s+" filter error "+l.message+(l.stack?l.stack:""),3,"filter")}}return c},excuteOne:function(n,r){if(t.list[n]&&this.enableList[n]!==!1){if("string"==typeof r){var i=void 0,o=r;try{i=t.list[n].replace(this.editWin,o),i!==void 0&&(o=i)}catch(a){e.error.writeError(n+" filter error "+a.message+(a.stack?a.stack:""),2,"filter")}return o}r===void 0&&(r=this.editDom);try{var s=r;t.list[n].replace(this.editWin,s)}catch(a){e.error.writeError(n+" filter error "+a.message+(a.stack?a.stack:""),3,"filter")}return s}},enable:function(e){this.enableList[e]=!0},disable:function(e){this.enableList[e]=!1}},n.ready=!0,e.EditorFilter=n}(window.jQuery.jQEditor),function(e){function t(n){if(this.ui="",n){for(var r in n)this[r]=n[r];var i=t.allList[this.id];i||alert("添加插件之后，还需要到command-conig.js进行注册喲"),i.title=e.getLang(this.id),i.isEnable=this.isEnable,this.htmlCmd=i.htmlCmd;for(var o in e.editorList)e.editorList[o].pluginEnable[this.id]===void 0&&(e.editorList[o].pluginEnable[this.id]=this.isEnable);this.fill()}}function n(n){function r(e){t.call(this,e)}try{if(n.id){var i=n.id;r.prototype=s,e.pluginList[i]=new r(n),e.pluginList[i].init(),e.trigger("afterPlugin")}}catch(o){e.error.writeError(n.id+" plugin add error: "+o.message+(o.stack?o.stack:""),3,"plugin")}}var r=e.config.cCommand,i={};for(var o in r.pluginCommand){var a=r.pluginCommand[o];i[a.cmd]={htmlCmd:o,isEnable:!0,scriptAddr:e.config.cBase.pluginDir+a.cmd+".plugin.js"}}e.loadPlugin=function(t,n){var r=i[t].scriptAddr;e.pluginList[t]===void 0?e.load.loadOneFile(r,function(){n&&n()}):n&&n()},t.allList=i,e.configPlugin=function(n){try{var r={};for(var i in t.allList)r[i]="undefined"===t.allList[i].isEnable?t.allList[i].isEnable:!0;for(var o=n.cPlugin.blackList,a=n.cPlugin.whiteList,s=o.length,l=a.length,c=0;s>c;c++)r[o[c]]=!1;for(var c=0;l>c;c++)r[a[c]]=!0;return r}catch(d){e.error.writeError("plugin config error: "+d.message+(d.stack?d.stack:""),3,"plugin")}},t.prototype={initPlugin:function(){},init:function(){var t=this.id+"dialog";"dialog"===this.type&&setTimeout(function(){e.loadUi(t)},0)},click:function(){"panel"===this.type?e.toolbar.togglePanel(this.htmlCmd):"dialog"===this.type&&this.showDialog&&this.showDialog(e.curEditor)},getData:function(){return{}},showDialog:function(t){var n=this;e.dialog.open({id:n.ui,editor:t.Eid,title:n.title,content:e.uiList[n.ui].getHtml(),ok:function(){return n.check()?(e.dialog.revertSelection(),e.command(n.ui),void 0):!1},cancel:function(){e.dialog.close(n.ui)}},n.getData(t))},check:function(){return!0},fill:function(){},enable:function(t){t||(t=e.curEditor),t.pluginEnable[this.id]=!0},disable:function(t){t||(t=e.curEditor),t.pluginEnable[this.id]=!1},getTitle:function(){return e.lang.pluginTitle[this.title]},writeLog:function(t){var n="The operate "+t+" !",r="plugin",i=new Date,o=i.toLocaleString();e.log.writeLog(n,r,o)},writeError:function(t,n){var r="The operate "+t+" error !",i="plugin",o=new Date,a=o.toLocaleString();e.error.writeError(r,n,i,a)},showTips:function(t){var n="";t||(t=this.tips),n=e.lang.pluginTips[t]?e.lang.pluginTips[t]:t,e.utils.showTips(n)},loadUiTpl:function(t){e.utils.loadDialog(this.id,e.config.cBase.uiDir+this.id+"/",t)},clicked:function(t,n){n=n||this.id;var r=e.curEditor.$toolbar;r.find("#icon-"+n).closest(".bke-btn")[t?"addClass":"removeClass"]("bke-clicked")}};var s=new t;s.initPlugin(),n.ready=!0,e.addPlugin=n,e.plugin=function(t){return e.pluginList[t]}}(window.jQuery.jQEditor),function(e,t){function n(e){if(this.html="",e)for(var t in e)this[t]=e[t]}function r(t){function r(e){n.call(this,e)}try{if(t.id){var i=t.id;r.prototype=c,e.uiList[i]=new r(t),e.uiList[i].initUi(),e.trigger("afterUi")}}catch(o){e.error.writeError(t.id+" ui add error: "+o.message+(o.stack?o.stack:""),3,"ui")}}var i=e.config.cCommand,o={};for(var a in i.uiCommand){var s=i.uiCommand[a],l=s.cmd.replace("dialog","");o[s.cmd]={isEnable:!0,scriptAddr:e.config.cBase.uiDir+l+"/"+l+".dialog.js"}}e.loadUi=function(t,n){if(o[t]){var r=o[t].scriptAddr;e.uiList[t]===void 0?e.load.loadOneFile(r,function(){n&&n()}):n&&n()}},n.prototype={initUi:function(){this.allList=o,0===t(document.body).find("#ui-dialog").length&&t(document.body).append('<div id="ui-dialog" style="display:none;"></div>')},check:function(){return!0},submit:function(){return!1},cancel:function(){return!1},getHtml:function(){return this.html},getValues:function(){var e={},n=t("#"+this.id+" :input");return n.each(function(){this.name&&(e[this.name]=t(this).val())}),e},setValues:function(e){var n=t("#"+this.id+" :input");n.each(function(){this.name&&"undefinded"!=typeof e[this.name]&&t(this).val(e[this.name])})},hide:function(){},enable:function(){this.isEnable=!0},disable:function(){this.isEnable=!1},error:function(t){e.dialog.error(t)
},success:function(t){e.dialog.success(t)},writeLog:function(t){var n="The operate "+t+" !",r="ui",i=new Date,o=i.toLocaleString();e.log.writeLog(n,r,o)},writeError:function(t,n){var r="The operate "+t+" error !",i="ui",o=new Date,a=o.toLocaleString();e.error.writeError(r,n,i,a)},showTips:function(t){var n="";t||(t=this.tips),n=e.lang.UiTips[t]?e.lang.UiTips[t]:t,e.utils.showTips(n)}};var c=new n;c.initUi(),r.ready=!0,e.addUi=r,e.ui=function(t){return e.uiList[t]}}(window.jQuery.jQEditor,window.jQuery),function(e,t){function n(){}var r,i="",o=null;n.prototype={init:function(e){var n=e.id,i=e.content instanceof jQuery?e.content[0].outerHTML:e.content,o=e.title,a=e.ok,s=e.cancel,l=e.init||e.initialize,c=e.button;return e.url,r=t.artDialog({id:n,content:i,title:o,fixed:!0,ok:a,cancel:s,button:c,okValue:" 确定 ",cancelValue:" 取消 ",initialize:l}),r.dom.dialog.addClass("bke-dialog").attr("id",e.id).find(".d-buttons").prepend('<div class="d-error"></div>'),r},open:function(n,a){i=e.utils.getSelectionRange(e.curEditor.win),t.artDialog.get(n.id)?t.artDialog.get(n.id).dom.dialog.attr("editor",n.editor):(r=this.init(n),r.dom.dialog.attr("editor",n.editor)),a!==void 0&&(o=n.ui?n.ui:n.id,e.utils.execUi(o,"setValues",a))},close:function(n){n=n||o,t.artDialog.get(n)&&t.artDialog.get(n).close(),this.revertSelection(),e.curEditor.win.focus()},submit:function(e){this.close(e)},revertSelection:function(){i&&e.utils.setSelectionRange(e.curEditor.win,i)},error:function(e,t){t=t||"red",r.dom.dialog.find(".d-error").css("color",t).html(e).show()},success:function(e){this.error(e,"green")},clear:function(){r.dom.dialog.find(".d-error").fadeOut()}};var a=new n;a.ready=!0,e.dialog=a,t(document).delegate(".d-content :input","click",function(){a.clear()})}(jQuery.jQEditor,jQuery),function(e,t){var n,r=0,i=0,o=0;setTimeout(function(){t("body").append('<div id="bke-contextmenu" class="bke-contextmenu" style="display:none;"></div>')},0),t(document).bind("click",function(){t("#bke-contextmenu").hide()});var a={create:function(e){for(var t='<div class="bke-menu"><div class="bke-shadow bke-default"></div><div class="bke-menu-body">',n=e.length,r=0;n>r;r++){var i="",o="";if(e[r].submenu&&(i="object"==typeof e[r].submenu?a.create(e[r].submenu):'<div class="bke-menu">'+e[r].submenu+"</div>",o='<div class="bke-menu-more"></div>'),"separator"===e[r].name||"-"===e[r].name)t+='<div class="bke-menu-separator"><div class="bke-menu-separator-inner"></div></div>';else{var s=e[r].icon||"",l="",c="";e[r].disabled&&(s+=" disabled"),e[r].styleName&&(c=e[r].styleName),e[r].cmd&&(l=' cmd="'+e[r].cmd+'"'),e[r].param&&(l+=' param="'+e[r].param+'"'),e[r].args&&(l+=' args="'+e[r].args+'"'),t+='<div class="bke-menu-item '+c+'"'+l+">"+'<div class="bke-menu-icon '+s+'"></div>'+'<div class="bke-menu-label"><a href="javascript:'+e[r].cmd+'" onclick="return false;">'+e[r].name+"</a></div>"+o+i+"</div>"}}return t+="</div></div>"},contextmenu:function(e,r){var i=this;n=t("#bke-contextmenu"),n.html(i.create(e)),i._show(n,r),i._setEvent(n)},_show:function(e,t){e.css({"z-index":10,top:-1e3,left:-1e3}).show();var n=this,r=n._setPosition(e,t);e.css(r)},_setEvent:function(n){this._setEvent=function(){};var r=this,i=e.curEditor.dom;t(i).bind("click.contextmenu",function(){n.hide()}),n.delegate(".bke-menu-item","mouseenter",function(e){var n=t(this).find(".bke-menu, .bke-submenu");if(clearTimeout(o),n.size()){o=setTimeout(function(){n.show()},200);var i=r._setSubPosition(n,e);n.css(i),n.css({"z-index":150})}}).delegate(".bke-menu-item","mouseleave",function(){t(this).find(".bke-menu").hide()}).delegate(".bke-menu-item","mousedown",function(){return e.curEditor.win.focus(),!1}).delegate(".bke-menu-item","click",function(r){var i=t(r.target).closest("[cmd]");if(i.length){var o=i.attr("cmd"),a=i.attr("param"),s=i.attr("args");e.command(o,a,s),n.hide()}return!1})},_setPosition:function(n,o){var a=t("#"+e.curId).find("iframe").offset(),s=a.left,l=a.top,c=t(document).scrollTop(),d=t(document).scrollLeft(),u=o.clientX+s+5,f=o.clientY+l+5-c,m=t(window).width()-u,h=t(window).height()-f;return r=n.outerWidth()>m?d+u-n.outerWidth():d+u,i=n.outerHeight()>h?f>n.outerHeight()?c+f-n.outerHeight():c+30:c+f,{top:i,left:r}},_setSubPosition:function(){return{top:0}}};e.Menu=a}(jQuery.jQEditor,jQuery),function(e,t){var n=/^http:\/\/(\w+\.){0,2}(?:hudong|baike|hoodong)\.com/i,r="function"==typeof g_filterExternal?g_filterExternal:function(){return 1};e.addFilter({name:"baike",type:["dom"],replace:function(e,i){if("object"!=typeof i||!i.body)return i;var o=t("a",i);o.each(function(){var e=t(this),i=e.attr("href"),o=e.text();if(!e.is(".innerlink,.baikelink")&&!/www\.(hudong|baike)\.com\/wiki\//i.test(i)||n.test(o)){if(i&&r()){i=i.toLowerCase();var a=i.indexOf(location.hostname);/^\w+:/i.test(i)&&!n.test(i)&&(!location.hostname||0>a||a>10)&&e.replaceWith(e.html())}}else e.attr("href","http://www.baike.com/wiki/"+encodeURI(o))}),t(".hdwiki_tmml",i).each(function(){var e=t(this),n=e.text();e.replaceWith("<h2>"+n+"</h2>")}),t(".hdwiki_tmmll",i).each(function(){var e=t(this),n=e.text();e.replaceWith("<h3>"+n+"</h3>")})}})}(jQuery.jQEditor,jQuery),function(e){var t=function(e,t,n){var r=!1,i=n.firstChild;if(null!==i){var o={},a=t.createRange();for(a.setStartBefore(i),a.collapse(!0);null!==i;){if(o=i.nextSibling,DTD.$inline[i.tagName]!==void 0||3===i.nodeType&&/\S/.test(i.nodeValue))a.setEndAfter(i),r=!0;else if(DTD.$block[i.tagName]!==void 0){if(r===!0){var s=t.createElement("p");a.surroundContents(s)}a.setStartAfter(i),a.collapse(!0),r=!1}if(i===n.lastChild&&r===!0){var s=t.createElement("p");a.surroundContents(s)}i=o}}},n=function(n,r){var i=e.utils.getNodeDom(r),o=i.dom;return r=i.node,t(n,o,r),r};e.addFilter({name:"block",type:["afterText","afterInsert"],replace:n})}(window.jQuery.jQEditor),function(e,t){function n(o){for(var a=[],s=o.childNodes,l=0;s.length>l;l++){var c=s[l];if(1===c.nodeType){var d=c.tagName.toLowerCase();if(r[d]){for(var u,f=e.IE?i:t.makeArray(c.attributes),m=r[d],h="",p=0,g=f.length;g>p;p++)u=e.IE?f[p]:f[p].name.toLowerCase(),-1===t.inArray(u,m)&&(c.removeAttribute(u),a[u]=c.getAttribute(u));if(h=e.IE?c.style.cssText:c.getAttribute("style")){h=h.replace(/; /g,";").toLowerCase();for(var b,v=h.split(";"),p=0,g=v.length;g>p;p++)b=v[p].split(":"),2===b.length&&-1===t.inArray("."+b[0],m)&&(h=h.replace(RegExp(b[0]+":"+b[1]+";?","i"),""));h=t.trim(h),h?e.IE?c.style.cssText=h:c.setAttribute("style",h):c.removeAttribute("style")}if("table"===d){var y=t(c),E=y.attr("bordercolor");y.hasClass("jqe-table")||y.addClass("jqe-table"),E||y.attr("bordercolor","#cccccc"),y.attr("border",1)}c.hasChildNodes()&&n(c)}else if(c.hasChildNodes()){for(var p=0;c.childNodes.length>p;p++)n(c.childNodes[p]),c.parentNode.insertBefore(c.childNodes[p].cloneNode(!0),c);c.parentNode.removeChild(c)}else c.parentNode.removeChild(c)}}return o.innerHTML}var r={font:[],span:["class","style",".font-weight",".font-size",".font-family",".font-style",".text-decoration"],div:["class","id","style",".width",".text-align"],a:["class","href","target","title","alt","name"],img:["class","id","src","alt","title","align","usemap","border","name","width","/"],hr:["/"],br:["/"],p:["class","align","style",".text-align",".padding-left",".margin-top",".margin-bottom",".line-height"],table:["class","style","width",".width","align","border","bordercolor","cellpadding",".margin",".margin-left",".margin-right"],tbody:[],tr:[],th:["class","align","colspan","rowspan","width"],td:["class","align","colspan","rowspan","width"],ol:["class","style",".text-align",".padding-left",".margin-top",".margin-bottom",".line-height"],ul:["class","style",".text-align",".padding-left",".margin-top",".margin-bottom",".line-height"],li:["class"],sub:["class"],sup:["class","name"],pre:["class","name"],blockquote:["style",".margin",".padding"],h2:[],h3:[],h4:[],h5:[],h6:[],em:[],strong:["style",".width"],b:[],i:[],u:[],strike:[],object:["classid","class","id","width","height","codebase"],embed:["style","src","type","loop","autostart","quality",".width",".height","flename","width","height","volume","pluginspage","console","controls","/"],param:["name","value"],map:["id","name"],area:["shape","coords","href","title","/"]},i=["onerror","onclick","onmouseout","onmouseover","onmousemove","align","color","font","height","vspace","hspace","id","class","style","left","right","name","rel","size","title","width","valign","bgcolor","dir"];e.addFilter({name:"cleanup",order:"first",type:["dom"],replace:function(e,t){n(t.body)}})}(jQuery.jQEditor,jQuery),function(e){var t=function(t,n){var r=e.utils.getNodeDom(n),i=r.dom;n=r.node;var o=t.getSelection(),a=0!==o.rangeCount?o.getRangeAt(0):" ",s=[];s=0>=navigator.userAgent.indexOf("MSIE")?i.createNodeIterator(n,NodeFilter.SHOW_ELEMENT):i.createNodeIterator(n,1);for(var l=s.nextNode();l;){var c=!1;e:for(;l.nextSibling&&l.tagName===l.nextSibling.tagName&&1===DTD.$font[l.tagName];){if("SPAN"===l.tagName){var d=l.style.cssText.split(";").length,u=l.nextSibling.style.cssText.split(";").length;if(d!==u)break e;for(var f=0;d>f;f++)if(l.nextSibling.style[l.style[f]]!==l.style[l.style[f]])break e}var m={},h={};if(a){m={container:a.startContainer,offset:a.startOffset},h={container:a.endContainer,offset:a.endOffset},a.startContainer.childNodes[a.startOffset]===l.nextSibling&&(a.setStartAfter(l),c=!0),a.endContainer.childNodes[a.endOffset]===l.nextSibling&&(a.setEndAfter(l),c=!0);var p=e.utils.nodeIndex(l.nextSibling);a.startContainer===l.parentNode&&a.startOffset>p&&(m.offset=p,c=!0),a.endContainer===l.parentNode&&a.endOffset>p&&(h.offset=p,c=!0)}var g=i.createRange(),b=i.createRange();g.selectNodeContents(l),g.collapse(!1),b.selectNodeContents(l.nextSibling);var v=b.extractContents();b.selectNode(l.nextSibling),b.deleteContents(),g.insertNode(v),a&&(a.setStart(m.container,m.offset),a.setEnd(h.container,h.offset),o.removeAllRanges(),o.addRange(a))}l=s.nextNode()}s=0>=navigator.userAgent.indexOf("MSIE")?i.createNodeIterator(n,NodeFilter.SHOW_TEXT):i.createNodeIterator(n,3);var y=!1;for(l=s.nextNode();l;){if(l.nextSibling&&3===l.nextSibling.nodeType)y=!0;else if(y===!0){for(var E=l.previousSibling;E&&3===E.nodeType;){var m={},h={},w="",c="";if(a){w=!1,c=!1,m={container:a.startContainer,offset:a.startOffset},h={container:a.endContainer,offset:a.endOffset};var p=e.utils.nodeIndex(E.nextSibling);if(a.startContainer===l.parentNode)a.startOffset>p&&(w="start",m.offset=a.startOffset-1,c=!0);else if(a.startContainer===E.nextSibling){var C=E.length;m.offset=C+a.startOffset,c=!0}else a.startContainer===E&&(m.container=E.nextSibling,c=!0);if(a.endContainer===l.parentNode)a.startOffset>p&&(w="end",h.offset=a.endOffset-1,c=!0);else if(a.endContainer===E.nextSibling){var C=E.length;h.offset=C+a.endOffset,c=!0}else a.endContainer===E&&(h.container=E.nextSibling,c=!0)}l.nodeValue=E.nodeValue+l.nodeValue;var k=E.previousSibling;E.parentNode.removeChild(E),E=k,a&&(a.setStart(m.container,m.offset),a.setEnd(h.container,h.offset),c===!0&&(o.removeAllRanges(),o.addRange(a)))}y=!1}l=s.nextNode()}};e.addFilter({name:"combine",type:["afterText","beforeInsert","afterInsert"],order:"second",replace:t})}(window.jQuery.jQEditor),function(e){function t(e){return e=e.replace(/<!--\[if gte mso [0-9]{1,2}\]>[\s\S]*?<!\[endif\]-->/gi,""),e=e.replace(/<style>[\s\S]*?mso[\s\S]*?<\/style>/gi,""),e=e.replace(/ lang=".+?"/gi,""),e=e.replace(/<o:p><\/o:p>/gi,""),e=e.replace(/ class="Mso.+?"/gi,""),e=e.replace(/ mso-spacerun: 'yes'/gi,"")}e.addFilter({name:"default",type:["html"],replace:function(e,n){return"string"==typeof n&&n?(n=n.replace(/^\s+/g,""),n=n.replace(/\s+$/g,""),n=n.replace(/>\s+</g,"><"),n=n.replace(/(<td[^>]*>)<\/td>/g,"$1&#8203;<br></td>"),n=n.replace(/<\/sup>(\s|&nbsp;)*/gi,"</sup> "),n=n.replace(/(\s|&nbsp;)*<sup/gi,"<sup"),n=n.replace(/<\/?textarea>/gi,""),n=n.replace(/<!--[\s\S]*?-->/gi,""),/http:\/\/www\.(hudong|baike)\.com\/editdocauth/i.test(location.href)&&(n=n.replace(/<\/?font[^>]*>/gi,"")),n=n.replace(/<(div|strong|span)[^>]*?>\s*<\/\1>/gi,""),n=n.replace(/<(span|font)>([^<]+)<\/\1>/gi,"$2"),n=n.replace(/<\??xml(:\w+)?(\s+[^>]*?)?>([\s\S]*?<\/xml>)?/gi,""),n=n.replace(/<\/?(html|head|body|meta|title|iframe|frame)(\s+[^>]*?)?>/gi,""),n=n.replace(/<link(\s+[^>]*?)?>/gi,""),n=n.replace(/<script(\s+[^>]*?)?>[\s\S]*?<\/script>/gi,""),n=n.replace(/(<\w+)(\s+[^>]*?)?\s+on(?:error|click|dblclick|mousedown|mouseup|mousemove|mouseover|mouseout|mouseenter|mouseleave|keydown|keypress|keyup|change|select|submit|reset|blur|focus|load|unload)\s*=\s*(["']?).*?\3((?:\s+[^>]*?)?\/?>)/gi,"$1$2$4"),n=n.replace(/<style(\s+[^>]*?)?>[\s\S]*?<\/style>/gi,""),n=n.replace(/<\/(strong|b|u|strike|em|i)>((?:\s|<br\/?>|&nbsp;)*?)<\1(\s+[^>]*?)?>/gi,"$2"),n=n.replace(/class=\"Apple-style-span\"/gi,""),n=n.replace(/ jquery\d+=\"?\d+\"?/gi," "),n=t(n)):n}})}(jQuery.jQEditor,jQuery),function(e,t){var n=function(e,n,r){t(r).find("ul,ol").each(function(){if(0===t(this).find("li").length)t(this).remove();else if(this.previousSibling&&this.previousSibling.nodeName===this.nodeName&&t(this.previousSibling).css("list-style-type")===t(this).css("list-style-type")){var e=this;t(this.previousSibling).find("li").each(function(){t(e).prepend(this)}),t(this.previousSibling).remove()}})},r=function(t,r){var i=e.utils.getNodeDom(r),o=i.dom;return r=i.node,n(t,o,r),r};e.addFilter({name:"list",type:["afterList"],replace:r})}(window.jQuery.jQEditor,window.jQuery),function(e){var t=function(e,t,n){n.style.cssText+=e+": "+t},n={B:{styleType:"STRONG",styleValue:void 0},I:{styleType:"EM",styleValue:void 0},U:{styleType:"text-decoration",styleValue:"underline"},DEL:{styleType:"text-decoration",styleValue:"line-through"}},r=function(e,n,r,i){var o=e.createElement("span");if(3===n.nodeType&&/\S/.test(n.nodeValue)){var a=e.createRange();a.selectNode(n),a.cloneRange(),"SPAN"===n.parentNode.tagName?t(r,i,n.parentNode):(t(r,i,o),a.surroundContents(o))}},i=function(t,i,o){if(3!==o.nodeType&&void 0!==n[o.tagName]){var a=n[o.tagName].styleType,s=n[o.tagName].styleValue;if(void 0===s){var l=i.createRange();l.selectNodeContents(o);var c=l.extractContents();l.selectNode(o),l.deleteContents(),l.insertNode(c);var d=i.createElement(a);l.surroundContents(d)}else{var u={};u=e.IE?i.createNodeIterator(o,3):i.createNodeIterator(o,NodeFilter.SHOW_TEXT);for(var f=u.nextNode(),m={};f;)m=u.nextNode(),r(i,f,a,s),f=m;var l=i.createRange();l.selectNodeContents(o);var c=l.extractContents();l.selectNode(o),l.deleteContents(),l.insertNode(c)}}},o=function(e,t,n){var r=n.firstChild;if(null!==r)for(var a={};null!==r;)a=r.nextSibling,o(e,t,r),i(e,t,r),r=a},a=function(t,n){var r=e.utils.getNodeDom(n),i=r.dom;n=r.node,o(t,i,n)};e.addFilter({name:"replace",type:["beforeInsert"],replace:a})}(window.jQuery.jQEditor),function(e){var t=function(t,n){var r=e.utils.getNodeDom(n),i=r.dom;n=r.node;var o=t.getSelection(),a=0!==o.rangeCount?o.getRangeAt(0):"",s="",l=!1,c=[];c=e.IE?i.createNodeIterator(n,3):i.createNodeIterator(n,NodeFilter.SHOW_TEXT);for(var d=c.nextNode(),u={};d;){u=c.nextNode();var f=/(^[ ]+$)/g,m=d.nodeValue.replace(f,"");if(f=/([\t\n\r])/g,m=d.nodeValue.replace(f,""),m!==d.nodeValue&&(d.nodeValue=m),!d.nodeValue)if(a&&a.startRange===d)s=d;else{var h=i.createRange();h.selectNode(d),h.deleteContents(),h.detach()}d=u}var p=[];p=e.IE?i.createNodeIterator(n,1):i.createNodeIterator(n,NodeFilter.SHOW_ELEMENT);var d=p.nextNode();for(l=!1;d;)if(u=p.nextNode(),1===DTD.$emptyInline[d.nodeName]||"A"===d.nodeName.toUpperCase()&&d.name)d=u;else{if(0==d.children.length&&0===d.innerText.length&&d!==s&&1!==DTD.$block[d.nodeName]&&"BODY"!==d.nodeName){var g=i.createRange();g.selectNode(d),a&&(d===a.startContainer&&(a.setStartBefore(d),l=!0),d===a.endContainer&&(a.setEndAfter(d),l=!0));for(var b=d.parentNode;b.firstChild===b.lastChild&&(1===DTD.$removeEmpty[b.tagName]||1===DTD.$removeEmptyBlock[b.tagName])&&"BODY"!==b.tagName;)g.selectNode(b),a&&(b===a.startContainer&&(a.setStartBefore(b),l=!0),b===a.endContainer&&(a.setEndAfter(b),l=!0)),b=b.parentNode;a&&l&&(o.removeAllRanges(),o.addRange(a)),g.deleteContents()}d=u}};e.addFilter({name:"space",type:["afterText","afterTextPre","beforeInsert","afterInsert"],order:"fourth",replace:t})}(window.jQuery.jQEditor),function(e,t){e.addFilter({name:"video",type:["dom"],replace:function(n,r){var i=e.curEditor.config.video_whiteList||["youku.com","tudou.com","iqiyi.com","qiyi.com","sohu.com","sina.com.cn","sina.com","qq.com","xunlei.com","ku6.com","56.com","cntv.cn","cctv.com","ifeng.com","baofeng.com","joy.cn","pps.tv","mtime.com","m1905.com","pptv.com","baidu.com","163.com"];if("object"==typeof r&&i instanceof Array){var o=i.slice(0),a=t("object,embed",r),s=null,l=!0,c="",d=null;o=o.join("|").toUpperCase().replace(/http:\/\//gi,"").replace(/\./g,"\\."),o="("+o+")$",s=RegExp(o,"i"),a.each(function(){d=t(this),c=d.attr("src"),c.length&&(c=c.replace("http://","").replace(/(\?|#)/g,"/").split("/"),c&&c.length>0&&s.test(c[0])&&(l=!1)),l&&d.remove(),l=!0})}}})}(jQuery.jQEditor,jQuery),function(e,t){var n=/^javascript:/i;e.addFilter({name:"xss",type:["dom"],replace:function(e,r){"object"==typeof r&&(t("a",r).each(function(){var e=t(this),r=e.attr("href");r&&(r=r.replace(/\s/g,""),n.test(r)&&e.replaceWith(e.html()))}),t("img",r).each(function(){var e=t(this),r=e.attr("src");r&&(r=r.replace(/\s/g,""),n.test(r)&&e.remove())}))}})}(jQuery.jQEditor,jQuery),function(e,t){function n(e){e&&(e.$toolbar=t("#"+e.Eid+" .bke-toolbar"),0===e.$toolbar.length&&(e.$toolbar=t("[ref="+e.Eid+"] .bke-toolbar")))}n.prototype={isShow:function(n){var r=t("#"+e.curId+" [cmd="+n+"]");return 0===r.length&&(r=t("[ref="+e.curId+"] .bke-toolbar  [cmd="+n+"]")),r.closest(".bke-btn").hasClass("bke-checked")},openPanel:function(n){var r=t("#"+e.curId+" [cmd="+n+"]");0===r.length&&(r=t("[ref="+e.curId+"] .bke-toolbar [cmd="+n+"]"));var i=r.closest(".bke-btn"),o=i.find(".bke-submenu");o.length&&i.addClass("bke-checked")},closePanel:function(n){var r=t("#"+e.curId+" [cmd="+n+"]");0===r.length&&(r=t("[ref="+e.curId+"] .bke-toolbar [cmd="+n+"]"));var i=r.closest(".bke-btn"),o=i.find(".bke-submenu");o.length&&i.removeClass("bke-checked")},fillPanel:function(e,n){var r=t("[cmd="+e+"]"),i=r.closest(".bke-btn"),o=i.find(".bke-submenu");o.length&&o.each(function(){var e=t(this);""===t.trim(e.html())&&e.html(n)})},clearPanel:function(e){var n=t("[cmd="+e+"]"),r=n.closest(".bke-btn"),i=r.find(".bke-submenu");i.length&&i.empty()},hidePanel:function(t){var n=e.curEditor.$toolbar.children(".bke-checked").has("div.bke-submenu");if(t){var r=e.curEditor.$toolbar.find("#icon-"+t),i=r.closest(".bke-btn");n=n.not(i)}n.removeClass("bke-checked")},togglePanel:function(e){this.isShow(e)?this.closePanel(e):this.openPanel(e)},disabledAll:function(n){n&&n instanceof Array||(n=[]);var r=[],i=e.curEditor.$toolbar;t.each(n,function(e,t){r.push("[cmd="+t+"]")}),i.children(".bke-btn").not(r.join(",")).addClass("bke-disabled")}};var r=new n;r.ready=!0,e.toolbar=r,e.Toolbar=n,e.IE6&&(t(document).delegate(".bke-btn","mouseover",function(){t(this).addClass("bke-clicked")}).delegate(".bke-btn","mouseleave",function(){t(this).removeClass("bke-clicked")}),t(document).delegate(".bke-menu-item","mouseover",function(){t(this).addClass("bke-menu-item-hover").children(".bke-menu-icon").addClass("bke-menu-icon-hover")}).delegate(".bke-menu-item","mouseleave",function(){t(this).removeClass("bke-menu-item-hover").children(".bke-menu-icon").removeClass("bke-menu-icon-hover")}))}(jQuery.jQEditor,jQuery),function(e){if(window.FileReader&&window.XMLHttpRequest){e.addUi({id:"ajaxuploaddialog",html:'<div class="bke-ajaxupload-progress"><div>文件上传中,请稍等...</div><span>10% ( 1.1MB / 2.0MB )</span><ol></ol></div>'}),e.addPlugin({id:"ajaxupload",title:"文件上传",ui:"ajaxuploaddialog",type:"dialog"}),/Chrome/i.test(navigator.userAgent)&&e.bind("ajaxupload-paste","paste",function(t){if(t){var n=t.event.originalEvent.clipboardData,r=n.items,i=r[0];if("file"==i.kind&&i.type.match(/^image\//i)){var o=i.getAsFile(),a=new FileReader;return a.onload=function(t){var n='<img src="'+t.target.result+'"/>';e.pasteHTML(n)},a.readAsDataURL(o),!1}}}),e.bind("ajaxupload-dragover","dragover",function(t){var n=e.curEditor.getSelectionText();if(!n){var r=e.plugin("dragimage");r&&r.mousedown||(t.event.stopPropagation(),t.event.preventDefault())}}),e.bind("ajaxupload-drop","drop",function(n){if(n.event.originalEvent.dataTransfer.files.length){var r=[],i=[],o=e.curEditor.config.cBase.ajaxupload,a=e.plugin("ajaxupload"),s={event:n.event,minsize:1048576,maxsize:10737418240,action:o.uploadUrl,inputName:"filedata",init:function(){a.click()},onprogress:function(e){var t=$("#ajaxuploaddialog").find(".bke-ajaxupload-progress span");t.text(e.totalPercent+"% ( "+e.completeCount+"/"+e.totalCount+" )")},callback:function(e,t){if("object"==typeof t)if(t.success)r.push({url:t.url,file:e});else{e.data=t,i.push(e);var n=t.msg||"未知错误";this.error(e,n)}},oncomplete:function(){var t=[];for(var n in r)r[n].file.type.match(/^image\//i)?t.push('<img src="'+r[n].url+'" style="max-width:600px;" />'):t.push('<a href="'+r[n].url+'" target="_blank">'+r[n].file.name+"</a>");e.curEditor.insert(t.join("")),i.length?setTimeout(function(){$("#ajaxuploaddialog").find(".bke-ajaxupload-progress div").html("")},500):setTimeout(function(){e.dialog.close()},1e3)},error:function(e,t){$("#ajaxuploaddialog").find(".bke-ajaxupload-progress ol").append("<li>"+e.name+" 上传失败，原因: "+t+"</li>")}};t.ondrop(s)}});var t={xhr:new XMLHttpRequest,Client:null,completeCount:0,totalCount:0,totalSize:0,completeSize:1,isUploading:!1,fileList:[],successFileList:[],failureFileList:[],init:function(e){if(!this.isUploading){var t=this;t.completeCount=1,t.fileList=e,t.successFileList=[],t.failureFileList=[],t.isUploading=!0,t.totalCount=e.length,t.start()}},ondrop:function(e){var t=this,n=e.event.originalEvent.dataTransfer,r=[],i=n.files;t.Client=e,e.event.stopPropagation(),e.event.preventDefault();for(var o=0,a=i.length;a>o;o++)i[o].size&&(r.push(i[o]),t.totalSize+=i[o].size);r.length&&(e.init(r),t.init(r))},start:function(){var e=this,t=e.fileList,n=t.shift();n?e.post(n):e.complete()},complete:function(){var e=this;e.Client.oncomplete(),e.isUploading=!1},callback:function(e,t){var n,r=this;r.completeCount+=1,r.completeSize+=e.size||e.fileSize;try{n=$.parseJSON(t)}catch(i){}r.Client.callback(e,n)},onprogress:function(e,t){var n=this;if(e&&e.loaded>=0){var r=t.size||t.fileSize,i=Math.round(100*e.loaded/r),o=Math.round(100*(e.loaded+n.completeSize)/n.totalSize),a={totalPercent:o,currentPercent:i,loaded:n.formatBytes(e.loaded),size:n.formatBytes(r),name:t.name||t.fileName,completeSize:n.formatBytes(e.loaded+n.completeSize),totalSize:n.formatBytes(n.totalSize),completeCount:n.completeCount,totalCount:n.totalCount};n.Client.onprogress(a)}},post:function(e){var t=this,n=t.xhr;n.onreadystatechange=function(){4===n.readyState&&(200==n.status?(t.successFileList.push(e),t.callback(e,n.responseText),t.start()):t.failureFileList.push(e))},n.upload?n.upload.onprogress=function(n){t.onprogress(n,e)}:t.onprogress(!1),n.open("POST",t.Client.action),n.setRequestHeader("Content-Type","application/octet-stream"),n.setRequestHeader("Content-Disposition",'attachment; name="'+t.Client.inputName+'"; filename="'+(e.name||e.fileName)+'"'),n.sendAsBinary?n.sendAsBinary(e.getAsBinary()):n.send(e)},formatBytes:function(e){var t=["Byte","KB","MB","GB","TB","PB"],n=Math.floor(Math.log(e)/Math.log(1024));return(e/Math.pow(1024,Math.floor(n))).toFixed(2)+t[n]}}}}(jQuery.jQEditor),function(e,t){function n(){function n(e){var n=e.config,r=t("#"+e.Eid).find(".bke-toolbar");0===r.length&&(r=t("[ref="+e.Eid+"] .bke-toolbar")),r.size()&&(n.toolbarTop=r.offset().top?r.offset().top:n.toolbarTop,r.parent().height(r.height()))}t.each(e.editorList,function(e,t){n(t)})}function r(e){var n=e.dom,r=0,i=n.createElement("DIV");i.style.clear="both",i.style.display="block",n.body.appendChild(i),r=Math.max(i.offsetTop+20,parseInt(e.config.editHeight,10)),n.body.removeChild(i);var o=t("#"+e.Eid);o.find("iframe").is(":visible")&&(o.find("iframe:visible").height(r),o.find(".bke-iframeholder").height(r)),o.find(".bke-iframeholder textarea").height(r)}function i(n){var r=t(window).scrollTop(),i=n.config,a=t("#"+n.Eid),s=a.find(".bke-toolbar"),l=0;0===s.length&&(s=t("[ref="+n.Eid+"] .bke-toolbar")),s.size()&&i.autoHeight&&(l=a.offset().top+a.height()-30,i.toolbarTop&&(i.toolbarTop>r||r>l)?(s.removeClass(i.fixedClassName),e.IE6&&(s[0].style.removeExpression("top"),s[0].style.position="static"),o=!1):(o||(s.width(s.width()).addClass(i.fixedClassName),e.IE6&&(s[0].style.setExpression("top",'eval(document.documentElement.scrollTop)+"px"'),s[0].style.position="absolute")),o=!0))}var o=!1;if(e.IE6&&"fixed"!==document.body.currentStyle.backgroundAttachment){var a=document.getElementsByTagName("html")[0];a.style.backgroundImage="url(about:blank)",a.style.backgroundAttachment="fixed"}e.addEvent({name:"autoHeight",type:["complete"],fn:function(){function n(i){return setTimeout(function(){t.each(e.editorList,function(e,t){t.config.autoHeight&&r(t)})},i),n}n(0)(300)(1e3)(2e3)(5e3)}}),e.addEvent({name:"autoHeight",type:["afterCommand","keyup"],fn:function(){e.curEditor.config.autoHeight&&r(e.curEditor)}}),t(window).scroll(function(){t.each(e.editorList,function(n,r){if(e.curEditor===r)i(r);else{var o=r.config,a=t("#"+r.Eid).find(".bke-toolbar");0===a.length&&(a=t("[ref="+r.Eid+"] .bke-toolbar")),a.removeClass(o.fixedClassName)}})}),e.addEvent({name:"setToolbarTop",type:["complete","active"],fn:function(){setTimeout(function(){n()},0)}});var s=0;t(window).resize(function(){clearTimeout(s),s=setTimeout(function(){n()},200)})}(jQuery.jQEditor,jQuery),function(e,t){function n(t,n){var r={name:"表格",icon:"bke-InsertTable",submenu:[{name:"删除表格",icon:"bke-RemoveTable",cmd:"deletetable"},{name:"-"},{name:"左插入列",icon:"bke-ColumnInsertBefore",cmd:"insertcolbefore"},{name:"右插入列",icon:"bke-ColumnInsertAfter",cmd:"insertcolafter"},{name:"上插入行",icon:"bke-RowInsertBefore",cmd:"insertrowbefore"},{name:"下插入行",icon:"bke-RowInsertAfter",cmd:"insertrowafter"},{name:"-"},{},{},{name:"-"},{name:"合并单元格",icon:"bke-CellCombine",cmd:"combinecells"},{name:"向下合并",icon:"bke-RowMergeAfter",cmd:"combinerowafter"},{name:"向右合并",icon:"bke-ColumnMergeAfter",cmd:"combinecolafter"},{name:"-"},{name:"表格属性",icon:"bke-TableProps",cmd:"tableprops"}]};r.submenu[7]=n.find("caption").length?{name:"删除表格名称",cmd:"tabletitle"}:{name:"插入表格名称",cmd:"tabletitle"},r.submenu[8]=n.find("th").length?{name:"删除表格标题行",cmd:"tablehead"}:{name:"插入表格标题行",cmd:"tablehead"},t.push(r),t.push({name:"单元格对齐方式",icon:"bke-JustifyFull",submenu:[{name:"居左",cmd:"celljustify",param:"4"},{name:"居中",cmd:"celljustify",param:"5"},{name:"居右",cmd:"celljustify",param:"6"},{name:"-"},{name:"居左（靠上）",cmd:"celljustify",param:"1"},{name:"居中（靠上）",cmd:"celljustify",param:"2"},{name:"居右（靠上）",cmd:"celljustify",param:"3"},{name:"-"},{name:"居左（靠下）",cmd:"celljustify",param:"7"},{name:"居中（靠下）",cmd:"celljustify",param:"8"},{name:"居右（靠下）",cmd:"celljustify",param:"9"}]},{name:"表格对齐方式",submenu:[{name:"左浮动",cmd:"tablefloat",param:"1"},{name:"居中",cmd:"tablefloat",param:"2"},{name:"右浮动",cmd:"tablefloat",param:"3"}]});var i={name:"单元格背景色",submenu:e.utils.execPlugin("colormenu","getCellcolorPicker")};return t.push(i),t}e.addEvent({name:"contextmenu",type:["contextmenu"],area:"editArea",fn:function(r){var i=e.plugin("shortcutmenu");if(!i||i.contextmenu()){var o=[];o.push({name:"全选",cmd:"selectall",icon:"bke-SelectAll"},{name:"清空文档",cmd:"cleardoc",icon:"bke-ClearDoc"},{name:"separator"});var a=t(r.target).closest("table");a.length?o=n(o,a):o.push({name:"段落格式",icon:"bke-JustifyFull",submenu:[{name:"左对齐",cmd:"justifyleft",icon:"bke-JustifyLeft"},{name:"右对齐",cmd:"justifyright",icon:"bke-JustifyRight"},{name:"居中对齐",cmd:"justifycenter",icon:"bke-JustifyCenter"},{name:"两端对齐",cmd:"justifyfull",icon:"bke-JustifyFull"}]},{name:"插入表格",icon:"bke-InsertTable",submenu:e.utils.execPlugin("tablemenu","getTablePanel")}),o.push({name:"separator"},{name:"段前插入段落",cmd:"insertparagraphbefore",param:""},{name:"段后插入段落",cmd:"insertparagraphafter",param:""},{name:"复制(Ctrl + c)",icon:"bke-Copy",cmd:"copy"},{name:"粘帖(Ctrl + v)",icon:"bke-Paste",cmd:"paste"},{name:"插入代码",icon:"bke-Code",cmd:"highlightcode"}),e.Menu.contextmenu(o,r),t(r.target).hasClass("selectCellClass")}}})}(jQuery.jQEditor,jQuery),function(e,t){e.addEvent({name:"cursorelements",type:["mousedown","keyup"],area:"editArea",fn:function(n){var r=n.target;if(t(r).is("body")){var i=e.utils.getCurElement();i.pop(),r=i.pop()}var o={},a=e.$(r),s=a.closest("h1,h2,h3,h4,h5,h6,h7"),l=a.closest("a"),c=a.closest("img"),d=a.closest("pre"),u=a.closest("sub"),f=a.closest("sup.refer"),m=a.closest("sup"),h=a.closest("td,th"),p=h.closest("tr"),g=p.closest("table"),b=a.closest("ol"),v=a.closest("ul"),y=a.closest("embed");s.length&&(o.hn=s[0]),l.length&&(o.a=l[0]),c.length&&(o.img=c[0]),d.length&&(o.pre=d[0]),u.length&&(o.sub=u[0]),f.length&&(o.refer=f[0]),m.length&&(o.sup=m[0]),h.length&&(o.cell=h[0]),p.length&&(o.row=p[0]),g.length&&(o.table=g[0]),b.length&&(o.ol=b[0]),v.length&&(o.ul=v[0]),y.length&&(o.embed=y[0]),e.curEditor.cursorElements=o}})}(jQuery.jQEditor,jQuery),function(e,t){function n(n){var r="html",i="",o=n.closest("[cmd]").attr("cmd"),a="";t.trim(n.text())?(i=n.text(),a=n.text()):a=e.getLang("labelMap."+o.toLowerCase())||n.text(),n.children().size()&&(r="prepend"),n[r]("<a href=\"javascript: void('"+o+'\')" title="'+a+'">'+i+"</a>")}e.addEvent({name:"commandHidePanel",type:["beforeCommand"],fn:function(t){var n=t.commandName;e.toolbar.hidePanel(n),e.curEditor.baseHistory&&"revert"!==n&&"redo"!==n&&"codemirror"!==n&&"source"!==n&&e.curEditor.baseHistory.prepareHistory()}}),e.addEvent({name:"recordHistory",type:["afterCommand"],fn:function(t){e.curEditor.baseHistory&&"revert"!==t.commandName&&"redo"!==t.commandName&&e.curEditor.baseHistory.recordHistory()}}),e.addEvent({name:"toolbarinit",type:["complete"],fn:function(r){e.editorList[r.Eid].config;var i=t('[ref="'+r.Eid+'"] .bke-toolbar');i.find(".bke-icon, .bke-caret").each(function(){n(t(this))}),i.find("div[cmd],span[cmd]").each(function(){var e=t(this),n=e.attr("cmd");e.attr("id","icon-"+n)}),i.find(".bke-text").each(function(){var e=t(this);e.find(".bke-caret").size()?e.find(".bke-caret").prev().each(function(){n(t(this))}):n(e)})}})}(jQuery.jQEditor,jQuery),function(e,t){t(".bke-dialog").live("click",function(n){var r=t(n.target),i=r.attr("cmd"),o=r.attr("param"),a=r.closest(".bke-dialog").attr("id");return r.attr("cmd")?(e.command(a,i,o),!1):void 0})}(window.jQuery.jQEditor,window.jQuery),function(e,t){function n(){var n=e.$("img");n.each(function(){var e=t(this);e.attr("id","img-"+o),e.closest("div.img").attr("id","wrap-img-"+o),o+=1})}function r(t){var n=t.closest("div.img"),r=t.attr("id");n.length||(e.$("#wrap-"+r).hide(),e.curEditor.baseHistory.prepareHistory(),setTimeout(function(){var t=e.$("#"+r),n=e.$("#wrap-"+r);t.parent().is("a")?(t.parent().after(n),n.prepend(t.parent())):(t.after(n),n.prepend(t)),n.show(),e.curEditor.baseHistory.recordHistory(1),e.trigger("mouseup")},0))}e.addPlugin({id:"dragimage",mousedown:!1});var i,o=0;e.addEvent({name:"dragimage-mousedown",type:["mousedown"],area:"editArea",fn:function(t){"img"===t.target.nodeName.toLowerCase()?(i=t.target,e.plugin("dragimage").mousedown=!0,/MSIE [678]\.0/i.test(navigator.userAgent)&&e.$(i).unbind("dragend").bind("dragend",function(){r(e.$(this))})):i=null}}),e.bind("dragimage-mouseup","mouseup",function(){e.plugin("dragimage").mousedown=!1}),e.addEvent({name:"dragimage-dragend",type:["dragend"],area:"editArea",fn:function(){i&&r(e.$(i))}}),e.addEvent({name:"dragimage-complete",type:["complete"],fn:function(){n()}})}(jQuery.jQEditor,jQuery),function(e,t){function n(t,n,r){e.IE&&/paste/i.test(n)&&(t=t.find("body")),t.bind(n,function(t){return e.trigger(n,{targetElement:t.target,target:t.target,event:t,targetEditor:r})})}var r="click,mousedown,mouseup,mouseenter,mouseleave,scroll,keypress,keyup,keydown,paste,beforepaste,dragenter,dragover,drop,dragleave,dragend".split(",");
e.listenEditarea=function(i){var o=t(i.dom);o.bind("contextmenu",function(t){return t.ctrlKey||t.shiftKey||t.altKey?!0:(e.trigger("contextmenu",{targetElement:t.target,target:t.target,clientX:t.clientX,clientY:t.clientY,targetEditor:i}),!1)});for(var a=0,s=r.length;s>a;a++){var l=t.trim(r[a]);n(o,l,i)}var c=e.IE?"beforepaste":"paste";o.find("body").bind(c,function(){e.utils.execPlugin("paste","paste")}),o.find("body").bind("beforecopy",function(){o.find("body").unbind(c),setTimeout(function(){o.find("body").bind(c,function(){e.utils.execPlugin("paste","paste")})},0),e.IE&&e.errorMessage("请使用 Ctrl+v 进行粘贴")}),o.bind("keydown",function(t){if(t.shiftKey&&13===t.which);else if(t.ctrlKey&&13===t.which);else if(t.ctrlKey&&67===t.which);else if(t.ctrlKey&&86===t.which);else if(t.ctrlKey&&88===t.which);else{if(t.ctrlKey&&66===t.which)return e.command("bold"),!1;if(t.ctrlKey&&73===t.which)return e.command("italic"),!1;if(t.ctrlKey&&85===t.which)return e.command("underline"),!1;if(t.ctrlKey&&90===t.which)return e.command("undo"),!1;if(t.ctrlKey&&89===t.which)return e.command("redo"),!1;if(t.ctrlKey&&65===t.which)return e.curEditor.selectAll(),!1;if(t.ctrlKey&&70===t.which)return e.command("search"),!1;if(t.ctrlKey&&72===t.which)return e.command("replace"),!1;if(t.ctrlKey&&83===t.which)return alert(11),!1;13===t.which?(e.curEditor.baseHistory.prepareHistory(),setTimeout(function(){e.curEditor.baseHistory.recordHistory()},0)):8===t.which||46===t.which}setTimeout(function(){var t=+new Date;t-i.baseHistory.getLastTime()>3e3&&(e.curEditor.baseHistory.prepareHistory(),e.curEditor.baseHistory.recordHistory())},0)}),o.bind("mouseenter",function(){e.curId!==i.Eid&&(e.curId=i.Eid,e.curEditor=i,e.trigger("active",{editor:i}))}).bind("mousedown",function(){o.bind("mousemove.drag",function(t){e.trigger("drag",{targetElement:t,targetEditor:i})})}).bind("mouseup",function(){o.unbind("mousemove.drag")})},e.addEvent({name:"editareaHidePanel",type:["mousedown","keydown"],area:"editArea",fn:function(){e.toolbar.hidePanel()}}),/AppleWebKit/i.test(navigator.userAgent)&&e.addEvent({name:"selectimg",type:["mousedown"],area:"editArea",fn:function(t){"img"===t.target.nodeName.toLowerCase()&&e.utils.selectNode(e.curEditor.win,t.target)}})}(window.jQuery.jQEditor,window.jQuery),function(e,t){function n(n,r){var i=e.pluginList.table,o=t(n).find("tr").length-1,a=t(n).find("tr:first").find("th,td").length-1,s=r.colStart,l=r.colEnd,c=r.rowStart,d=r.rowEnd;e:for(;;){var u={},f={},m={};if(s>0){for(var h=c;d>=h;h++)if(u=t(n).find("[col="+s+"][row="+h+"]"),m=i._rowInfo(u),0>m.isInRow){if(m.lastColspan>1&&m.isInRow+m.lastColspan>0){s-=1;continue e}}else if(f=i._colInfo(u),f.isInCol>=0){s-=1;continue e}}else s=0;if(c>0){for(var p=s;l>=p;p++)if(u=t(n).find("[row="+c+"][col="+p+"]"),f=i._colInfo(u),0>f.isIncol){if(f.lastRowspan>1&&f.isIncol+f.lastRowspan>0){c-=1;continue e}}else if(m=i._rowInfo(u),m.isInRow>=0){c-=1;continue e}}else c=0;if(a>l){for(var h=c;d>=h;h++)if(u=t(n).find("[col="+l+"][row="+h+"]"),m=i._rowInfo(u),0>m.isInRow&&m.lastColspan>1&&-1>m.isInRow){l+=1;continue e}}else l=a;if(o>d){for(var p=s;l>=p;p++)if(u=t(n).find("[row="+d+"][col="+p+"]"),f=i._colInfo(u),0>f.isInCol&&f.lastRowspan>1&&-1>f.isInCol){d+=1;continue e}}else d=o;break e}return{colStart:s,colEnd:l,rowStart:c,rowEnd:d}}function r(e){var n=e.target,r=t(n).closest("table"),o=t(n).closest("body"),a=e.offsetX,s=n.offsetWidth,l=e.offsetY,c=n.offsetHeight;if(r.unbind("mousedown.dragLine"),4>a)o.css("cursor","col-resize"),i(r,{leftTd:t(n).prev("td").not(":hidden")[0],rightTd:n},!1);else if(4>s-a)o.css("cursor","col-resize"),i(r,{leftTd:n,rightTd:t(n).next("td").not(":hidden")[0]},!1);else if(4>l){o.css("cursor","row-resize");var d=parseInt(t(n).attr("col")),u=t(n.parentNode).prev("tr").length?t(n.parentNode).prev("tr").find("td").eq(d).not(":hidden")[0]:void 0;i(r,{topTd:u,bottomTd:n},!0)}else if(4>c-l){o.css("cursor","row-resize");var f=t(n.parentNode).next("tr").length?t(n.parentNode).next("tr").find("td").eq(d).not(":hidden")[0]:void 0;i(r,{topTd:n,bottomTd:f},!0)}else o.css("cursor","default"),r.unbind("mousedown.dragLine")}function i(n,i,a){var s=t(n).closest("body");return void 0===i.topTd&&a===!0?0:void 0===i.leftTd&&a===!1?0:(t(n).bind("mousedown.dragLine",function(l){t(n).find("td").unbind("mousemove.cursorState");var c=l.clientX,d=l.clientY;t(n).parent().append("<div></div>");var u=t(n).parent().children(":last");u.css("position","absolute"),u.css("display","block"),u.css("width","1px"),u.css("height","1px"),u.css("z-index","11"),a===!0?u.width(t(n).find("tbody").width()):u.height(t(n).find("tbody").height());var f=t(n).offset().top,m=t(n).offset().left;a===!0?f+=t(i.topTd)[0].offsetTop+t(i.topTd)[0].offsetHeight:m+=t(i.leftTd)[0].offsetLeft+t(i.leftTd)[0].offsetWidth,u.css("top",f),u.css("left",m),u.css("background-color","green"),t(s).bind("mousemove.changeCell",function(n){e.utils.removeSelection(e.curEditor.win);var r=n.clientX,o=n.clientY;a?o-d+t(i.topTd)[0].offsetHeight>45&&u.css("top",f+o-d):r-c+t(i.leftTd)[0].offsetWidth>45&&(!i.rightTd||t(i.rightTd)[0].offsetWidth-(r-c)>45)&&u.css("left",m+r-c),e.utils.removeSelection(e.curEditor.win)}).bind("mouseup.changeCell",function(l){var f=l.clientX,m=l.clientY,h=0;h=a?m-d+t(i.topTd)[0].offsetHeight>45?m-d:45-t(i.topTd)[0].offsetHeight:f-c+t(i.leftTd)[0].offsetWidth>45&&(!i.rightTd||t(i.rightTd)[0].offsetWidth-(f-c)>45)?f-c:f-c+t(i.leftTd)[0].offsetWidth>45?t(i.rightTd)[0].offsetWidth-45:45-t(i.leftTd)[0].offsetWidth,o(i,h,a),e.utils.removeSelection(e.curEditor.win),t(n).find("td").bind("mousemove.cursorState",function(e){r(e)}),u.remove(),t(n).unbind("mousedown.dragLine"),s.unbind("mousemove.changeCell"),s.unbind("mouseup.changeCell")})}),void 0)}function o(e,n,r){if(r){var i=t(e.topTd).attr("rowspan")?parseInt(t(e.topTd).attr("rowspan")):1,o=parseInt(t(e.topTd).attr("row"))+i,a=[];t(e.topTd).closest("table").find("td:visible,th:visible").each(function(){var e=t(this).attr("rowspan")?parseInt(t(this).attr("rowspan")):1;if(parseInt(t(this).attr("row"))+e===o){var r=parseFloat(t(this).height());a.push({cell:t(this),height:r+n})}});for(var s=a.length,l=0;s>l;l++)a[l].cell.height(a[l].height)}else{var c=t(e.leftTd).attr("colspan")?parseInt(t(e.leftTd).attr("colspan")):1,a=[],d=parseInt(t(e.leftTd).attr("col"))+c;t(e.leftTd).closest("table").find("td:visible,th:visible").each(function(){var e=t(this).attr("colspan")?parseInt(t(this).attr("colspan")):1;if(parseInt(t(this).attr("col"))+e===d){var r=parseFloat(t(this).width()),i=parseFloat(t(this).next("td,th").width());a.push({cell:t(this),width:r+n}),t(this).next("td,th").length&&a.push({cell:t(this).next("td,th"),width:i-n});var o=parseFloat(t(this).closest("table").width())+n>760?760:parseFloat(t(this).closest("table").width())+n;t(this).next("td,th").length||a.push({cell:t(this).closest("table"),width:o})}});for(var s=a.length,l=0;s>l;l++)a[l].cell.width(a[l].width)}}e.listenEditareaExt=function(i){var o=t(i.dom),a=e.config.selectTableClass,s=e.config.selectCellClass;o.delegate("td,th","mousedown",function(r){e.utils.execPlugin("table","freshTableIndex",t(r.target).closest("table"));var i=o.find("body").css("cursor");if("row-resize"===i||"col-resize"===i)return!0;if(1===r.which){var a={col_1:t(r.target).attr("col"),row_1:t(r.target).attr("row")},l=t(r.target).closest("table").find("th,td");l.not(t(r.target)).bind("mousemove.selectCell",function(r){var i=t(r.target),o=i.closest("table");e.utils.removeSelection(e.curEditor.win),l.removeClass(s),a.col_2=i.attr("col"),a.row_2=i.attr("row");var c=Math.max(a.col_1,a.col_2),d=Math.min(a.col_1,a.col_2),u=Math.max(a.row_1,a.row_2),f=Math.min(a.row_1,a.row_2),m=n(o,{colStart:d,colEnd:c,rowStart:f,rowEnd:u});c=m.colEnd,d=m.colStart,u=m.rowEnd,f=m.rowStart;var h=o.find("tr:not(:gt("+u+"),:lt("+f+"))"),p=t();h.each(function(){p=p.add(t(this).find("td,th").not(":gt("+c+"),:lt("+d+")"))}),p.addClass(s),e.utils.removeSelection(e.curEditor.win)}),l.bind("mouseenter",function(){l.removeClass(s),"None"===e.curEditor.win.getSelection().type?l.unbind("mouseenter mousemove.selectCell"):e.utils.setCursor(e.curEditor.win,r.target,!0)}).bind("mouseup",function(){l.unbind("mouseenter")})}}),o.delegate("body","mousedown",function(e){if(1===e.which){var n=t(this);n.find("table").removeClass(a),n.find("td,th").removeClass(s)}}).delegate("body","mouseup",function(){t(this).find("td,th").unbind("mouseenter mousemove.selectCell mouseup")});var l=0;o.delegate("table","mouseenter",function(){clearTimeout(l);var e=t(this),n=e.offset();t(".bke-selecttablebar").data("table",e).css({top:n.top-20,left:n.left-20}).show()}).delegate("table","mouseleave",function(){o.find("body").css("cursor","default"),clearTimeout(l),l=setTimeout(function(){t(".bke-selecttablebar").hide()},200)}),t("#"+i.Eid).delegate(".bke-selecttablebar","click",function(){var e=t(this).data("table");return e.find("td,th").removeClass(s),e.toggleClass(a),!1}).delegate(".bke-selecttablebar","mouseenter",function(){clearTimeout(l)}).delegate(".bke-selecttablebar","mouseleave",function(){clearTimeout(l),l=setTimeout(function(){t(".bke-selecttablebar").hide()},200)}),o.delegate("td","mousemove.cursorState",function(e){r(e)})}}(window.jQuery.jQEditor,window.jQuery),function(e){e.addEvent({name:"readyLog",type:["ready"],fn:function(){return e.log.writeLog("Core is ready","core"),!1}}),e.addEvent({name:"createLog",type:["create"],fn:function(t){return e.log.writeLog("Editor "+t.Eid+" is creating","core"),!1}}),e.addEvent({name:"completeLog",type:["complete"],fn:function(t){return e.log.writeLog("Editor "+t.Eid+" is completed","core"),!1}})}(window.jQuery.jQEditor),function(e,t){var n=t(document);n.bind("click",function(n){var r=t(n.target);r.closest(".bke-btn").size()||e.toolbar.hidePanel()}),n.delegate(".bke-toolbar","mousedown",function(n){var r=t(n.target).closest(".bke-toolbarbox").attr("ref");return e.curId=r,e.curEditor=e.editorList[r],e.curEditor.win.focus(),!1}),n.delegate(".bke-toolbar","click",function(n){var r=t(n.target).closest("[cmd]");if(r.closest(".bke-disabled").length)return!0;if(r.length){var i=r.attr("cmd"),o=r.attr("param"),a=r.attr("args");return e.command(i,o,a),!1}}),n.delegate(".bke-submenu [cmd]","click",function(){e.toolbar.hidePanel()})}(jQuery.jQEditor,jQuery),function(e,t){e.addEvent({name:"elementpath",type:["mouseup"],area:"editArea",fn:function(){for(var n=t("#"+e.curId+" .bke-elementpath"),r=e.utils.getCurElement(),i=[],o=0,a=r.length;a>o;o++)3!==r[o].nodeType&&i.push("<a>"+r[o].nodeName.toLowerCase()+"</a>");n.html("元素路径："+i.join("&gt;"))}})}(jQuery.jQEditor,jQuery),function(e,t){var n=[{name:"宋体",cmd:"fontfamily",param:"SimSun",styleName:"bke-SimSun"},{name:"仿宋体",cmd:"fontfamily",param:"FangSong_GB2312",styleName:"bke-FangSong_GB2312"},{name:"微软雅黑",cmd:"fontfamily",param:"Microsoft YaHei",styleName:"bke-Microsoft_YaHei"},{name:"黑体",cmd:"fontfamily",param:"SimHei",styleName:"bke-SimHei"},{name:"楷体",cmd:"fontfamily",param:"KaiTi_GB2312",styleName:"bke-KaiTi_GB2312"},{name:"Impact",cmd:"fontfamily",param:"Impact",styleName:"bke-Impact"},{name:"Georgia",cmd:"fontfamily",param:"Georgia",styleName:"bke-Georgia"},{name:"Arial",cmd:"fontfamily",param:"Arial",styleName:"bke-Arial"},{name:"Verdana",cmd:"fontfamily",param:"Verdana",styleName:"bke-Verdana"},{name:"Tahoma",cmd:"fontfamily",param:"Tahoma",styleName:"bke-Tahoma"}];e.addPlugin({id:"fontfamilymenu",type:"panel",isEnable:!0,fill:function(t){var r=e.Menu.create(n);e.fillPanel("fontfamilymenu",r,t)},echo:function(e,r){r=r.replace(/'/g,"")||"",r=r.toLowerCase(),t.each(n,function(t,n){return n.param.toLowerCase()===r?(e.find("#icon-fontfamilymenu").find(".bke-Font a").html(n.name),!1):void 0})}})}(jQuery.jQEditor,jQuery),function(e,t){function n(){for(var n={},r={},o={},a=e.utils.getCurElement(),s=a.length,c="",d=0;s>d;d++){var u=a[d].nodeName.toLowerCase();if(r[u]=!0,t(a[d]).attr("style"))for(var f=t(a[d]).attr("style").split(";"),m=f.length,h=0;m>h;h++){var p=f[h].split(":");"string"==typeof p[1]&&(p[0]=p[0].replace(/^[ ]+/g,""),o[p[0]]=p[1].replace(/^[ ]+/g,""))}}for(c in i.customChecked){var g=i.customChecked[c].tag,b=i.customChecked[c].style;n[c]=g&&r[g]===!0?"_on":b&&o[b]===i.customChecked[c].value?"_on":"_off","_off"===n.justifycenter&&"_off"===n.justifyright&&(n.justifyleft="_on")}for(c in i.customValue){var b=i.customValue[c].style;n[c]=b&&o[b]?o[b]:i.customValue[c].state}for(c in i.browserChecked)n[c]=e.curEditor.dom.queryCommandState(c)===!0?"_on":"_off";for(c in i.browserValue)if(e.curEditor.dom.queryCommandValue(c)){if(n[c]=e.curEditor.dom.queryCommandValue(c),"ForeColor"===c||"BackColor"===c){var v=/[0-9]+/g,y=n[c].match(v);n[c]="#";for(var d=0;y.length>d;d++){var E=parseInt(y[d],16);128>E&&(n[c]+="0"),n[c]+=E}}}else n[c]=i.browserValue[c].state;var w=t(e.curEditor.dom).find("table."+e.curEditor.config.selectTableClass).length,C=t(e.curEditor.dom).find("td."+e.curEditor.config.selectCellClass,"th."+e.curEditor.config.selectCellClass).length;for(c in i.tableChecked)if(n[c]="_freeze",0!==w)l.tableSelect[c]!==void 0&&(n[c]=l.tableSelect[c]);else if(0!==C)l.cellSelect[c]!==void 0&&(n[c]=l.cellSelect[c]);else if(r.td===!0||r.th===!0){if(l.cellIn[c]!==void 0&&(n[c]=l.cellIn[c]),"_split"===n[c]){var k=t(e.utils.getCurElement().pop()).closest("td,th");n[c]="_freeze",k.attr("colspan")&&parseInt(k.attr("colspan"))>1&&(n.splittocols="_off",n.splittocells="_off"),k.attr("rowspan")&&parseInt(k.attr("rowspan"))>1&&(n.splittorows="_off",n.splittocells="_off")}"_combine"===n[c]&&(n[c]="_freeze",e.utils.execPlugin("table","combineRowAfter",!0)&&(n.combinerowafter="_off"),e.utils.execPlugin("table","combineColAfter",!0)&&(n.combinecolafter="_off"))}else l.tableOut[c]!==void 0&&(n[c]=l.tableOut[c]);var N=e.curEditor.baseHistory;N&&(n.redo=N.redoState?"_off":"_freeze",n.undo=N.revertState?"_off":"_freeze"),e.curEditor.pasteToText===!0&&(n.pastetotext="_on"),e.pluginList.font&&(n.formatmatch=e.pluginList.font.brushOn[e.curId]?"_on":"_off"),e.curEditor.cursorElements&&t.each(["hn","table","a","sub","sup","pre"],function(r,i){e.curEditor.cursorElements[i]&&t.each(e.curEditor.config.cTagDisable[i],function(e,t){n[t]="_freeze"})});var T=e.curEditor.$toolbar;if(e.curEditor.isShowSource)return T.children(".bke-btn").not("[cmd=codemirror],[cmd=about],[cmd=fullscreen]").addClass("bke-disabled"),void 0;T.children(".bke-btn").not(":has(div.bke-submenu)").removeClass("bke-checked"),T.children(".bke-btn").removeClass("bke-disabled");for(c in n)if("_on"===n[c])T.find("#icon-"+c).closest(".bke-btn").addClass("bke-checked");else if("_freeze"===n[c])T.find("#icon-"+c).closest(".bke-btn").addClass("bke-disabled");else if("_off"===n[c]);else if("backcolor"===c||"forecolor"===c)T.find("#icon-"+c).find("i").css("backgroundColor",n[c]);else if("fontsize"===c||"fontfamily"===c){var x=e.plugin(c+"menu");x&&"function"==typeof x.echo&&x.echo(T,n[c])}}var r=e.config.cCommand,i={browserChecked:{},customChecked:{},browserValue:{},customValue:{},tableChecked:{}};for(var o in r)for(var a in r[o]){var s=r[o][a];""!==s.icon&&(i[s.icon][a]="customChecked"===s.icon||"browserChecked"===s.icon?""===s.param?{tag:s.cmd,state:"_off"}:"pluginCommand"===o?{tag:s.param,state:"_off"}:{style:s.cmd,value:s.param,state:"_off"}:{style:s.cmd,value:s.param,state:"_off"})}var l={tableSelect:{tableprops:"_off",deletetable:"_off"},cellSelect:{cellcolor:"_off",cellcolormenu:"_off",insertcolbefore:"_off",insertcolafter:"_off",insertrowbefore:"_off",insertrowafter:"_off",deletecol:"_off",deleterow:"_off",combinecells:"_off",tableprops:"_off",deletetable:"_off"},cellIn:{cellcolor:"_off",cellcolormenu:"_off",deletecol:"_off",deleterow:"_off",splittocols:"_split",splittorows:"_split",splittocells:"_split",combinecolafter:"_combine",combinerowafter:"_combine",insertcolbefore:"_off",insertcolafter:"_off",insertrowbefore:"_off",insertrowafter:"_off",tableprops:"_off",deletetable:"_off"},tableOut:{inserttable:"_off",inserttablemenu:"_off"}};e.addEvent({name:"iconstate",type:["mouseup","keyup","afterCommand"],area:"editArea",fn:function(){n()}})}(jQuery.jQEditor,jQuery),function(e,t){e.addPlugin({id:"paste",isEnable:!0,click:function(){window.clipboardData?e.curEditor.dom.execCommand("paste"):e.errorMessage("请使用 Ctrl+v 进行粘贴")},cut:function(){e.IE?e.curEditor.dom.execCommand("cut"):e.errorMessage("请使用 Ctrl+x 进行剪切")},copy:function(){e.IE?e.curEditor.dom.execCommand("copy"):e.errorMessage("请使用 Ctrl+c 进行复制")},paste:function(){return e.utils.getBoardContent(e.curEditor,function(n){var r="";r=e.curEditor.isPastetotext?t(n).text():e.utils.filterInner(e.curEditor,n.innerHTML),e.command("insert",r)}),e.IE?!1:void 0},toggleTextpaste:function(){var t=e.curEditor.isPastetotext=!e.curEditor.isPastetotext;this.clicked(t,"pastetotext")}})}(window.jQuery.jQEditor,window.jQuery),function(e){e.addPlugin({id:"redo",isEnable:!0,click:function(){e.curEditor.baseHistory.redo()}})}(window.jQuery.jQEditor),function(e){e.addPlugin({id:"revert",isEnable:!0,click:function(){e.curEditor.baseHistory.revert()}})}(window.jQuery.jQEditor),function(e){e.addPlugin({id:"selectall",title:"清空文档",isEnable:!0,click:function(){e.curEditor.selectAll()}})}(jQuery.jQEditor,jQuery),function(e,t){function n(n,r){var i=document.createElement("div"),o=document.createElement("table");t(o).addClass("bke-plugin-table");for(var a=0;n>a;a++){t(o).append("<tr></tr>");for(var s=0;r>s;s++){var l=t(o).find("tr:eq("+a+")");l.append('<td args="'+(a+1)+"-"+(s+1)+'" cmd="inserttable" param="insert"><a></a></td>')}}return e.Menu.create([{name:"插入表格",cmd:"inserttable",param:"showDialog"}]),t(i).append('<div class="bke-info">0行 0列</div>'),t(i).append(o),i.innerHTML}e.addPlugin({id:"tablemenu",type:"panel",isEnable:!0,fill:function(){e.fillPanel("inserttablemenu",n(10,10)),t(document).delegate(".bke-plugin-table td","mouseenter",function(e){var n=t(e.target).closest("td[args]").attr("args").split("-"),r=parseInt(n[0]),i=parseInt(n[1]),o=t(e.target).closest(".bke-plugin-table");o.parent().children(".bke-info").text(n[0]+"行 "+n[1]+"列"),o.find("td").removeClass("cell-hover"),o.find("tr:lt("+r+")").find("td:lt("+i+")").addClass("cell-hover")}).delegate(".bke-plugin-table","mouseleave",function(e){var n=t(e.target).closest(".bke-plugin-table");n.parent().children(".bke-info").text("0行 0列"),n.find("td").removeClass("cell-hover")})},getTablePanel:function(){return n(10,10)}})}(jQuery.jQEditor,jQuery);