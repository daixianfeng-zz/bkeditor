/*! Bkeditor - v0.9.0 - 2013-08-03
* https://github.com/daixianfeng/bkeditor
* Copyright (c) 2013 daixianfeng;*/
(function(){})(jQuery.jQEditor,jQuery),function(e,t){function n(n){n=n.replace(/\n+/g,"");var i=t("<div></div>").append(n),r="",o=null;i.children().each(function(){try{o=t(this),r=o.html(),r.length>50&&o.html("\n"+r+"\n"),o.after("\n")}catch(e){}});var a=i.find("table");return a.size()&&a.find("tr,td,th").after("\n").before("\n"),n=i.html(),n=n.replace(/\n+/g,"\n"),n=n.replace(/<BR>/gi,"<br>\n"),n=n.replace(/<.+?>/gi,function(e){return e=e.replace(/COLOR:/g,"color:"),e=e.replace(/rgb\(\d+,(?: |&nbsp;)?\d+,(?: |&nbsp;)?\d+\)/gi,function(e){return Utils.colorToHex(e)})}),e.IE&&(n=n.replace(/<(\w+)/gi,function(e,t){return"<"+t.toLowerCase()}),n=n.replace(/(\w+)>/gi,function(e,t){return t.toLowerCase()+">"})),n}var i="";e.addUi({id:"sourcedialog",html:'<textarea name="content" style="width:700px;height:400px;resize:none;"></textarea>',submit:function(){var n=t("#sourcedialog").find("textarea").val();e.curEditor.setContent(n),i&&e.utils.setSelectionByOffset(e.curEditor.win,i),i=""}}),e.addPlugin({id:"source",title:"源代码",ui:"sourcedialog",type:"dialog",getData:function(t){i=e.utils.getSelectionOffset(t.win);var r={content:n(t.getContent())};return r}})}(jQuery.jQEditor,jQuery);